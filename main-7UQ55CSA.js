import{A as Xb,B as Dn,C as di,D as th,E as Zl,F as ay,G as e0,H as t0,I as re,J as en,K as pt,L as ly,M as n0,N as Jl,O as we,P as un,Q as nh,R as uy,S as Tn,T as hi,U as go,V as rh,W as r0,X as Bn,Y as Dt,a as $,b as fe,c as iy,d as N,e as qb,f as Yd,g as Gb,h as zb,i as L,j as As,k as Zd,l as Wb,m as Kb,n as wt,o as Jd,p as Yl,q as oy,r as Qb,s as rr,t as sy,u as Xd,v as Yb,w as Zb,x as eh,y as ut,z as Jb}from"./chunk-TFNTWWHP.js";function fy(n,e){return Object.is(n,e)}var gt=null,ih=!1,py=1,cn=Symbol("SIGNAL");function Ce(n){let e=gt;return gt=n,e}function i0(){return gt}var eu={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function sh(n){if(ih)throw new Error("");if(gt===null)return;gt.consumerOnSignalRead(n);let e=gt.nextProducerIndex++;if(uh(gt),e<gt.producerNode.length&&gt.producerNode[e]!==n&&Xl(gt)){let t=gt.producerNode[e];lh(t,gt.producerIndexOfThis[e])}gt.producerNode[e]!==n&&(gt.producerNode[e]=n,gt.producerIndexOfThis[e]=Xl(gt)?a0(n,gt,e):0),gt.producerLastReadVersion[e]=n.version}function yV(){py++}function gy(n){if(!(Xl(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===py)){if(!n.producerMustRecompute(n)&&!yy(n)){hy(n);return}n.producerRecomputeValue(n),hy(n)}}function o0(n){if(n.liveConsumerNode===void 0)return;let e=ih;ih=!0;try{for(let t of n.liveConsumerNode)t.dirty||_V(t)}finally{ih=e}}function s0(){return gt?.consumerAllowSignalWrites!==!1}function _V(n){n.dirty=!0,o0(n),n.consumerMarkedDirty?.(n)}function hy(n){n.dirty=!1,n.lastCleanEpoch=py}function ah(n){return n&&(n.nextProducerIndex=0),Ce(n)}function my(n,e){if(Ce(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Xl(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)lh(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function yy(n){uh(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(gy(t),r!==t.version))return!0}return!1}function _y(n){if(uh(n),Xl(n))for(let e=0;e<n.producerNode.length;e++)lh(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function a0(n,e,t){if(l0(n),n.liveConsumerNode.length===0&&u0(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=a0(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function lh(n,e){if(l0(n),n.liveConsumerNode.length===1&&u0(n))for(let r=0;r<n.producerNode.length;r++)lh(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];uh(i),i.producerIndexOfThis[r]=e}}function Xl(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function uh(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function l0(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function u0(n){return n.producerNode!==void 0}function c0(n){let e=Object.create(vV);e.computation=n;let t=()=>{if(gy(e),sh(e),e.value===oh)throw e.error;return e.value};return t[cn]=e,t}var cy=Symbol("UNSET"),dy=Symbol("COMPUTING"),oh=Symbol("ERRORED"),vV=fe($({},eu),{value:cy,dirty:!0,error:null,equal:fy,kind:"computed",producerMustRecompute(n){return n.value===cy||n.value===dy},producerRecomputeValue(n){if(n.value===dy)throw new Error("Detected cycle in computations.");let e=n.value;n.value=dy;let t=ah(n),r,i=!1;try{r=n.computation(),Ce(null),i=e!==cy&&e!==oh&&r!==oh&&n.equal(e,r)}catch(o){r=oh,n.error=o}finally{my(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function wV(){throw new Error}var d0=wV;function h0(){d0()}function f0(n){d0=n}var EV=null;function p0(n){let e=Object.create(vy);e.value=n;let t=()=>(sh(e),e.value);return t[cn]=e,t}function ch(n,e){s0()||h0(),n.equal(n.value,e)||(n.value=e,IV(n))}function g0(n,e){s0()||h0(),ch(n,e(n.value))}var vy=fe($({},eu),{equal:fy,value:void 0,kind:"signal"});function IV(n){n.version++,yV(),o0(n),EV?.()}function se(n){return typeof n=="function"}function Ms(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var dh=Ms(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function mo(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var tt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(se(r))try{r()}catch(o){e=o instanceof dh?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{m0(o)}catch(s){e=e??[],s instanceof dh?e=[...e,...s.errors]:e.push(s)}}if(e)throw new dh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)m0(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&mo(t,e)}remove(e){let{_finalizers:t}=this;t&&mo(t,e),e instanceof n&&e._removeParent(this)}};tt.EMPTY=(()=>{let n=new tt;return n.closed=!0,n})();var wy=tt.EMPTY;function hh(n){return n instanceof tt||n&&"closed"in n&&se(n.remove)&&se(n.add)&&se(n.unsubscribe)}function m0(n){se(n)?n():n.unsubscribe()}var Un={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Rs={setTimeout(n,e,...t){let{delegate:r}=Rs;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Rs;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function fh(n){Rs.setTimeout(()=>{let{onUnhandledError:e}=Un;if(e)e(n);else throw n})}function yo(){}var y0=Ey("C",void 0,void 0);function _0(n){return Ey("E",void 0,n)}function v0(n){return Ey("N",n,void 0)}function Ey(n,e,t){return{kind:n,value:e,error:t}}var _o=null;function Ns(n){if(Un.useDeprecatedSynchronousErrorHandling){let e=!_o;if(e&&(_o={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=_o;if(_o=null,t)throw r}}else n()}function w0(n){Un.useDeprecatedSynchronousErrorHandling&&_o&&(_o.errorThrown=!0,_o.error=n)}var vo=class extends tt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,hh(e)&&e.add(this)):this.destination=TV}static create(e,t,r){return new Nr(e,t,r)}next(e){this.isStopped?Cy(v0(e),this):this._next(e)}error(e){this.isStopped?Cy(_0(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Cy(y0,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},CV=Function.prototype.bind;function Iy(n,e){return CV.call(n,e)}var Dy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){ph(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){ph(r)}else ph(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ph(t)}}},Nr=class extends vo{constructor(e,t,r){super();let i;if(se(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&Un.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Iy(e.next,o),error:e.error&&Iy(e.error,o),complete:e.complete&&Iy(e.complete,o)}):i=e}this.destination=new Dy(i)}};function ph(n){Un.useDeprecatedSynchronousErrorHandling?w0(n):fh(n)}function DV(n){throw n}function Cy(n,e){let{onStoppedNotification:t}=Un;t&&Rs.setTimeout(()=>t(n,e))}var TV={closed:!0,next:yo,error:DV,complete:yo};var xs=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Tt(n){return n}function Ty(...n){return by(n)}function by(n){return n.length===0?Tt:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var pe=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=SV(t)?t:new Nr(t,r,i);return Ns(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=E0(r),new r((i,o)=>{let s=new Nr({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[xs](){return this}pipe(...t){return by(t)(this)}toPromise(t){return t=E0(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function E0(n){var e;return(e=n??Un.Promise)!==null&&e!==void 0?e:Promise}function bV(n){return n&&se(n.next)&&se(n.error)&&se(n.complete)}function SV(n){return n&&n instanceof vo||bV(n)&&hh(n)}function Sy(n){return se(n?.lift)}function ue(n){return e=>{if(Sy(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ae(n,e,t,r,i){return new Ay(n,e,t,r,i)}var Ay=class extends vo{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=i?function(a){try{i(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ps(){return ue((n,e)=>{let t=null;n._refCount++;let r=ae(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var ks=class extends pe{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Sy(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new tt;let t=this.getSubject();e.add(this.source.subscribe(ae(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=tt.EMPTY)}return e}refCount(){return Ps()(this)}};var I0=Ms(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ge=(()=>{class n extends pe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new gh(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new I0}next(t){Ns(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Ns(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Ns(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?wy:(this.currentObservers=null,o.push(t),new tt(()=>{this.currentObservers=null,mo(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new pe;return t.source=this,t}}return n.create=(e,t)=>new gh(e,t),n})(),gh=class extends Ge{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:wy}};var bt=class extends Ge{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var tu={now(){return(tu.delegate||Date).now()},delegate:void 0};var nu=class extends Ge{constructor(e=1/0,t=1/0,r=tu){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let l=1;l<r.length&&r[l]<=s;l+=2)a=l;a&&r.splice(0,a+1)}}};var mh=class extends tt{constructor(e,t){super()}schedule(e,t=0){return this}};var ru={setInterval(n,e,...t){let{delegate:r}=ru;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=ru;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Os=class extends mh{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return ru.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&ru.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,mo(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Fs=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Fs.now=tu.now;var Vs=class extends Fs{constructor(e,t=Fs.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var wo=new Vs(Os);var yh=class extends Os{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var _h=class extends Vs{};var My=new _h(yh);var Gt=new pe(n=>n.complete());function C0(n){return n&&se(n.schedule)}function Ry(n){return n[n.length-1]}function Ls(n){return se(Ry(n))?n.pop():void 0}function ir(n){return C0(Ry(n))?n.pop():void 0}function D0(n,e){return typeof Ry(n)=="number"?n.pop():e}var vh=n=>n&&typeof n.length=="number"&&typeof n!="function";function wh(n){return se(n?.then)}function Eh(n){return se(n[xs])}function Ih(n){return Symbol.asyncIterator&&se(n?.[Symbol.asyncIterator])}function Ch(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function AV(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Dh=AV();function Th(n){return se(n?.[Dh])}function bh(n){return Gb(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Yd(t.read());if(i)return yield Yd(void 0);yield yield Yd(r)}}finally{t.releaseLock()}})}function Sh(n){return se(n?.getReader)}function je(n){if(n instanceof pe)return n;if(n!=null){if(Eh(n))return MV(n);if(vh(n))return RV(n);if(wh(n))return NV(n);if(Ih(n))return T0(n);if(Th(n))return xV(n);if(Sh(n))return PV(n)}throw Ch(n)}function MV(n){return new pe(e=>{let t=n[xs]();if(se(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function RV(n){return new pe(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function NV(n){return new pe(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,fh)})}function xV(n){return new pe(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function T0(n){return new pe(e=>{kV(n,e).catch(t=>e.error(t))})}function PV(n){return T0(bh(n))}function kV(n,e){var t,r,i,o;return qb(this,void 0,void 0,function*(){try{for(t=zb(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function tn(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function or(n,e=0){return ue((t,r)=>{t.subscribe(ae(r,i=>tn(r,n,()=>r.next(i),e),()=>tn(r,n,()=>r.complete(),e),i=>tn(r,n,()=>r.error(i),e)))})}function xr(n,e=0){return ue((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function b0(n,e){return je(n).pipe(xr(e),or(e))}function S0(n,e){return je(n).pipe(xr(e),or(e))}function A0(n,e){return new pe(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function M0(n,e){return new pe(t=>{let r;return tn(t,e,()=>{r=n[Dh](),tn(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>se(r?.return)&&r.return()})}function Ah(n,e){if(!n)throw new Error("Iterable cannot be null");return new pe(t=>{tn(t,e,()=>{let r=n[Symbol.asyncIterator]();tn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function R0(n,e){return Ah(bh(n),e)}function N0(n,e){if(n!=null){if(Eh(n))return b0(n,e);if(vh(n))return A0(n,e);if(wh(n))return S0(n,e);if(Ih(n))return Ah(n,e);if(Th(n))return M0(n,e);if(Sh(n))return R0(n,e)}throw Ch(n)}function Pe(n,e){return e?N0(n,e):je(n)}function ne(...n){let e=ir(n);return Pe(n,e)}function js(n,e){let t=se(n)?n:()=>n,r=i=>i.error(t());return new pe(e?i=>e.schedule(r,0,i):r)}function Ny(n){return!!n&&(n instanceof pe||se(n.lift)&&se(n.subscribe))}var Pr=Ms(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Z(n,e){return ue((t,r)=>{let i=0;t.subscribe(ae(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:OV}=Array;function FV(n,e){return OV(e)?n(...e):n(e)}function Mh(n){return Z(e=>FV(n,e))}var{isArray:VV}=Array,{getPrototypeOf:LV,prototype:jV,keys:BV}=Object;function Rh(n){if(n.length===1){let e=n[0];if(VV(e))return{args:e,keys:null};if(UV(e)){let t=BV(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function UV(n){return n&&typeof n=="object"&&LV(n)===jV}function Nh(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function xh(...n){let e=ir(n),t=Ls(n),{args:r,keys:i}=Rh(n);if(r.length===0)return Pe([],e);let o=new pe($V(r,e,i?s=>Nh(i,s):Tt));return t?o.pipe(Mh(t)):o}function $V(n,e,t=Tt){return r=>{x0(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let l=0;l<i;l++)x0(e,()=>{let c=Pe(n[l],e),d=!1;c.subscribe(ae(r,f=>{o[l]=f,d||(d=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function x0(n,e,t){n?tn(t,n,e):e()}function P0(n,e,t,r,i,o,s,a){let l=[],c=0,d=0,f=!1,g=()=>{f&&!l.length&&!c&&e.complete()},m=T=>c<r?v(T):l.push(T),v=T=>{o&&e.next(T),c++;let S=!1;je(t(T,d++)).subscribe(ae(e,O=>{i?.(O),o?m(O):e.next(O)},()=>{S=!0},void 0,()=>{if(S)try{for(c--;l.length&&c<r;){let O=l.shift();s?tn(e,s,()=>v(O)):v(O)}g()}catch(O){e.error(O)}}))};return n.subscribe(ae(e,m,()=>{f=!0,g()})),()=>{a?.()}}function mt(n,e,t=1/0){return se(e)?mt((r,i)=>Z((o,s)=>e(r,o,i,s))(je(n(r,i))),t):(typeof e=="number"&&(t=e),ue((r,i)=>P0(r,i,n,t)))}function iu(n=1/0){return mt(Tt,n)}function k0(){return iu(1)}function Bs(...n){return k0()(Pe(n,ir(n)))}function Ph(n){return new pe(e=>{je(n()).subscribe(e)})}function xy(...n){let e=Ls(n),{args:t,keys:r}=Rh(n),i=new pe(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),l=s,c=s;for(let d=0;d<s;d++){let f=!1;je(t[d]).subscribe(ae(o,g=>{f||(f=!0,c--),a[d]=g},()=>l--,void 0,()=>{(!l||!f)&&(c||o.next(r?Nh(r,a):a),o.complete())}))}});return e?i.pipe(Mh(e)):i}function Us(...n){let e=ir(n),t=D0(n,1/0),r=n;return r.length?r.length===1?je(r[0]):iu(t)(Pe(r,e)):Gt}function Vt(n,e){return ue((t,r)=>{let i=0;t.subscribe(ae(r,o=>n.call(e,o,i++)&&r.next(o)))})}function fi(n){return ue((e,t)=>{let r=null,i=!1,o;r=e.subscribe(ae(t,void 0,void 0,s=>{o=je(n(s,fi(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function O0(n,e,t,r,i){return(o,s)=>{let a=t,l=e,c=0;o.subscribe(ae(s,d=>{let f=c++;l=a?n(l,d,f):(a=!0,d),r&&s.next(l)},i&&(()=>{a&&s.next(l),s.complete()})))}}function $s(n,e){return se(e)?mt(n,e,1):mt(n,1)}function pi(n){return ue((e,t)=>{let r=!1;e.subscribe(ae(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function kr(n){return n<=0?()=>Gt:ue((e,t)=>{let r=0;e.subscribe(ae(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function ou(n,e=Tt){return n=n??HV,ue((t,r)=>{let i,o=!0;t.subscribe(ae(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function HV(n,e){return n===e}function kh(n=qV){return ue((e,t)=>{let r=!1;e.subscribe(ae(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function qV(){return new Pr}function su(n){return ue((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function $n(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Vt((i,o)=>n(i,o,r)):Tt,kr(1),t?pi(e):kh(()=>new Pr))}function Hs(n){return n<=0?()=>Gt:ue((e,t)=>{let r=[];e.subscribe(ae(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Py(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Vt((i,o)=>n(i,o,r)):Tt,Hs(1),t?pi(e):kh(()=>new Pr))}function au(){return ue((n,e)=>{let t,r=!1;n.subscribe(ae(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function sr(n,e){return ue(O0(n,e,arguments.length>=2,!0))}function lu(n={}){let{connector:e=()=>new Ge,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return o=>{let s,a,l,c=0,d=!1,f=!1,g=()=>{a?.unsubscribe(),a=void 0},m=()=>{g(),s=l=void 0,d=f=!1},v=()=>{let T=s;m(),T?.unsubscribe()};return ue((T,S)=>{c++,!f&&!d&&g();let O=l=l??e();S.add(()=>{c--,c===0&&!f&&!d&&(a=ky(v,i))}),O.subscribe(S),!s&&c>0&&(s=new Nr({next:B=>O.next(B),error:B=>{f=!0,g(),a=ky(m,t,B),O.error(B)},complete:()=>{d=!0,g(),a=ky(m,r),O.complete()}}),je(T).subscribe(s))})(o)}}function ky(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new Nr({next:()=>{r.unsubscribe(),n()}});return je(e(...t)).subscribe(r)}function Oh(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,lu({connector:()=>new nu(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Oy(n){return ue((e,t)=>{let r=!1,i=0;e.subscribe(ae(t,o=>(r||(r=!n(o,i++)))&&t.next(o)))})}function Eo(...n){let e=ir(n);return ue((t,r)=>{(e?Bs(n,t,e):Bs(n,t)).subscribe(r)})}function Qe(n,e){return ue((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(ae(r,l=>{i?.unsubscribe();let c=0,d=o++;je(n(l,d)).subscribe(i=ae(r,f=>r.next(e?e(l,f,d,c++):f),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function Fh(n,e){return se(e)?Qe(()=>n,e):Qe(()=>n)}function Fy(n){return ue((e,t)=>{je(n).subscribe(ae(t,()=>t.complete(),yo)),!t.closed&&e.subscribe(t)})}function St(n,e,t){let r=se(n)||e||t?{next:n,error:e,complete:t}:n;return r?ue((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(ae(o,l=>{var c;(c=r.next)===null||c===void 0||c.call(r,l),o.next(l)},()=>{var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),o.complete()},l=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,l),o.error(l)},()=>{var l,c;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):Tt}function Vy(...n){let e=Ls(n);return ue((t,r)=>{let i=n.length,o=new Array(i),s=n.map(()=>!1),a=!1;for(let l=0;l<i;l++)je(n[l]).subscribe(ae(r,c=>{o[l]=c,!a&&!s[l]&&(s[l]=!0,(a=s.every(Tt))&&(s=null))},yo));t.subscribe(ae(r,l=>{if(a){let c=[l,...o];r.next(e?e(...c):c)}}))})}var GV="https://g.co/ng/security#xss",te=class extends Error{code;constructor(e,t){super(B_(e,t)),this.code=e}};function B_(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}var IS=Symbol("InputSignalNode#UNSET"),zV=fe($({},vy),{transformFn:void 0,applyValueToInputSignal(n,e){ch(n,e)}});function CS(n,e){let t=Object.create(zV);t.value=n,t.transformFn=e?.transform;function r(){if(sh(t),t.value===IS)throw new te(-950,!1);return t.value}return r[cn]=t,r}function vu(n){return{toString:n}.toString()}var Vh="__parameters__";function WV(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function DS(n,e,t){return vu(()=>{let r=WV(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(l,c,d){let f=l.hasOwnProperty(Vh)?l[Vh]:Object.defineProperty(l,Vh,{value:[]})[Vh];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(s),l}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}function Be(n){for(let e in n)if(n[e]===Be)return e;throw Error("Could not find renamed property on target object.")}function KV(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function nn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(nn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function F0(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var QV=Be({__forward_ref__:Be});function Di(n){return n.__forward_ref__=Di,n.toString=function(){return nn(this())},n}function zt(n){return TS(n)?n():n}function TS(n){return typeof n=="function"&&n.hasOwnProperty(QV)&&n.__forward_ref__===Di}function ee(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function fn(n){return{providers:n.providers||[],imports:n.imports||[]}}function gf(n){return V0(n,SS)||V0(n,AS)}function bS(n){return gf(n)!==null}function V0(n,e){return n.hasOwnProperty(e)?n[e]:null}function YV(n){let e=n&&(n[SS]||n[AS]);return e||null}function L0(n){return n&&(n.hasOwnProperty(j0)||n.hasOwnProperty(ZV))?n[j0]:null}var SS=Be({\u0275prov:Be}),j0=Be({\u0275inj:Be}),AS=Be({ngInjectableDef:Be}),ZV=Be({ngInjectorDef:Be}),z=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ee({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function MS(n){return n&&!!n.\u0275providers}var JV=Be({\u0275cmp:Be}),XV=Be({\u0275dir:Be}),eL=Be({\u0275pipe:Be}),tL=Be({\u0275mod:Be}),Gh=Be({\u0275fac:Be}),hu=Be({__NG_ELEMENT_ID__:Be}),B0=Be({__NG_ENV_ID__:Be});function RS(n){return typeof n=="string"?n:n==null?"":String(n)}function nL(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():RS(n)}function rL(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new te(-200,n)}function U_(n,e){throw new te(-201,!1)}var me=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(me||{}),Yy;function NS(){return Yy}function bn(n){let e=Yy;return Yy=n,e}function xS(n,e,t){let r=gf(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&me.Optional)return null;if(e!==void 0)return e;U_(n,"Injector")}var iL={},fu=iL,Zy="__NG_DI_FLAG__",zh="ngTempTokenPath",oL="ngTokenPath",sL=/\n/gm,aL="\u0275",U0="__source",Ws;function lL(){return Ws}function gi(n){let e=Ws;return Ws=n,e}function uL(n,e=me.Default){if(Ws===void 0)throw new te(-203,!1);return Ws===null?xS(n,void 0,e):Ws.get(n,e&me.Optional?null:void 0,e)}function j(n,e=me.Default){return(NS()||uL)(zt(n),e)}function V(n,e=me.Default){return j(n,mf(e))}function mf(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Jy(n){let e=[];for(let t=0;t<n.length;t++){let r=zt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new te(900,!1);let i,o=me.Default;for(let s=0;s<r.length;s++){let a=r[s],l=cL(a);typeof l=="number"?l===-1?i=a.token:o|=l:i=a}e.push(j(i,o))}else e.push(j(r))}return e}function PS(n,e){return n[Zy]=e,n.prototype[Zy]=e,n}function cL(n){return n[Zy]}function dL(n,e,t,r){let i=n[zh];throw e[U0]&&i.unshift(e[U0]),n.message=hL(`
`+n.message,i,t,r),n[oL]=i,n[zh]=null,n}function hL(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==aL?n.slice(2):n;let i=nn(e);if(Array.isArray(e))i=e.map(nn).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):nn(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(sL,`
  `)}`}var yf=PS(DS("Optional"),8);var fL=PS(DS("SkipSelf"),4);function Qs(n,e){let t=n.hasOwnProperty(Gh);return t?n[Gh]:null}function $_(n,e){n.forEach(t=>Array.isArray(t)?$_(t,e):e(t))}function kS(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Wh(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function pL(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function gL(n,e,t){let r=wu(n,e);return r>=0?n[r|1]=t:(r=~r,pL(n,r,e,t)),r}function Ly(n,e){let t=wu(n,e);if(t>=0)return n[t|1]}function wu(n,e){return mL(n,e,1)}function mL(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var Ys={},Sn=[],Zs=new z(""),OS=new z("",-1),FS=new z(""),Kh=class{get(e,t=fu){if(t===fu){let r=new Error(`NullInjectorError: No provider for ${nn(e)}!`);throw r.name="NullInjectorError",r}return t}};function VS(n,e){let t=n[tL]||null;if(!t&&e===!0)throw new Error(`Type ${nn(n)} does not have '\u0275mod' property.`);return t}function Co(n){return n[JV]||null}function LS(n){return n[XV]||null}function jS(n){return n[eL]||null}function BS(n){let e=Co(n)||LS(n)||jS(n);return e!==null&&e.standalone}function H_(n){return{\u0275providers:n}}function q_(...n){return{\u0275providers:US(!0,n),\u0275fromNgModule:!0}}function US(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return $_(e,s=>{let a=s;Xy(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&$S(i,o),t}function $S(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];G_(i,o=>{e(o,r)})}}function Xy(n,e,t,r){if(n=zt(n),!n)return!1;let i=null,o=L0(n),s=!o&&Co(n);if(!o&&!s){let l=n.ngModule;if(o=L0(l),o)i=l;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let c of l)Xy(c,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let c;try{$_(o.imports,d=>{Xy(d,e,t,r)&&(c||=[],c.push(d))})}finally{}c!==void 0&&$S(c,e)}if(!a){let c=Qs(i)||(()=>new i);e({provide:i,useFactory:c,deps:Sn},i),e({provide:FS,useValue:i,multi:!0},i),e({provide:Zs,useValue:()=>j(i),multi:!0},i)}let l=o.providers;if(l!=null&&!a){let c=n;G_(l,d=>{e(d,c)})}}else return!1;return i!==n&&n.providers!==void 0}function G_(n,e){for(let t of n)MS(t)&&(t=t.\u0275providers),Array.isArray(t)?G_(t,e):e(t)}var yL=Be({provide:String,useValue:Be});function HS(n){return n!==null&&typeof n=="object"&&yL in n}function _L(n){return!!(n&&n.useExisting)}function vL(n){return!!(n&&n.useFactory)}function Js(n){return typeof n=="function"}function wL(n){return!!n.useClass}var _f=new z(""),Bh={},EL={},jy;function z_(){return jy===void 0&&(jy=new Kh),jy}var it=class{},pu=class extends it{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,t_(e,s=>this.processProvider(s)),this.records.set(OS,qs(void 0,this)),i.has("environment")&&this.records.set(it,qs(void 0,this));let o=this.records.get(_f);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(FS,Sn,me.Self))}destroy(){cu(this),this._destroyed=!0;let e=Ce(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ce(e)}}onDestroy(e){return cu(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){cu(this);let t=gi(this),r=bn(void 0),i;try{return e()}finally{gi(t),bn(r)}}get(e,t=fu,r=me.Default){if(cu(this),e.hasOwnProperty(B0))return e[B0](this);r=mf(r);let i,o=gi(this),s=bn(void 0);try{if(!(r&me.SkipSelf)){let l=this.records.get(e);if(l===void 0){let c=bL(e)&&gf(e);c&&this.injectableDefInScope(c)?l=qs(e_(e),Bh):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l)}let a=r&me.Self?z_():this.parent;return t=r&me.Optional&&t===fu?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[zh]=a[zh]||[]).unshift(nn(e)),o)throw a;return dL(a,e,"R3InjectorError",this.source)}else throw a}finally{bn(s),gi(o)}}resolveInjectorInitializers(){let e=Ce(null),t=gi(this),r=bn(void 0),i;try{let o=this.get(Zs,Sn,me.Self);for(let s of o)s()}finally{gi(t),bn(r),Ce(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(nn(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=zt(e);let t=Js(e)?e:zt(e&&e.provide),r=CL(e);if(!Js(e)&&e.multi===!0){let i=this.records.get(t);i||(i=qs(void 0,Bh,!0),i.factory=()=>Jy(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Ce(null);try{return t.value===Bh&&(t.value=EL,t.value=t.factory()),typeof t.value=="object"&&t.value&&TL(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ce(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=zt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function e_(n){let e=gf(n),t=e!==null?e.factory:Qs(n);if(t!==null)return t;if(n instanceof z)throw new te(204,!1);if(n instanceof Function)return IL(n);throw new te(204,!1)}function IL(n){if(n.length>0)throw new te(204,!1);let t=YV(n);return t!==null?()=>t.factory(n):()=>new n}function CL(n){if(HS(n))return qs(void 0,n.useValue);{let e=qS(n);return qs(e,Bh)}}function qS(n,e,t){let r;if(Js(n)){let i=zt(n);return Qs(i)||e_(i)}else if(HS(n))r=()=>zt(n.useValue);else if(vL(n))r=()=>n.useFactory(...Jy(n.deps||[]));else if(_L(n))r=()=>j(zt(n.useExisting));else{let i=zt(n&&(n.useClass||n.provide));if(DL(n))r=()=>new i(...Jy(n.deps));else return Qs(i)||e_(i)}return r}function cu(n){if(n.destroyed)throw new te(205,!1)}function qs(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function DL(n){return!!n.deps}function TL(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function bL(n){return typeof n=="function"||typeof n=="object"&&n instanceof z}function t_(n,e){for(let t of n)Array.isArray(t)?t_(t,e):t&&MS(t)?t_(t.\u0275providers,e):e(t)}function Rn(n,e){n instanceof pu&&cu(n);let t,r=gi(n),i=bn(void 0);try{return e()}finally{gi(r),bn(i)}}function GS(){return NS()!==void 0||lL()!=null}function zS(n){if(!GS())throw new te(-203,!1)}function SL(n){return typeof n=="function"}var Lr=0,Ie=1,ce=2,Wt=3,qn=4,Gn=5,Qh=6,Yh=7,lr=8,Xs=9,_i=10,yt=11,gu=12,$0=13,la=14,ur=15,ea=16,Gs=17,ta=18,vf=19,WS=20,mi=21,By=22,Zh=23,dn=24,Or=25,KS=1;var Do=7,Jh=8,Xh=9,Mn=10;function yi(n){return Array.isArray(n)&&typeof n[KS]=="object"}function jr(n){return Array.isArray(n)&&n[KS]===!0}function QS(n){return(n.flags&4)!==0}function wf(n){return n.componentOffset>-1}function W_(n){return(n.flags&1)===1}function vi(n){return!!n.template}function n_(n){return(n[ce]&512)!==0}function Eu(n){return(n[ce]&256)===256}var r_=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function YS(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var Iu=(()=>{let n=()=>ZS;return n.ngInherit=!0,n})();function ZS(n){return n.type.prototype.ngOnChanges&&(n.setInput=ML),AL}function AL(){let n=XS(this),e=n?.current;if(e){let t=n.previous;if(t===Ys)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function ML(n,e,t,r,i){let o=this.declaredInputs[r],s=XS(n)||RL(n,{previous:Ys,current:null}),a=s.current||(s.current={}),l=s.previous,c=l[o];a[o]=new r_(c&&c.currentValue,t,l===Ys),YS(n,e,i,t)}var JS="__ngSimpleChanges__";function XS(n){return n[JS]||null}function RL(n,e){return n[JS]=e}var H0=null;var An=function(n,e,t){H0?.(n,e,t)},NL="svg",xL="math";function cr(n){for(;Array.isArray(n);)n=n[Lr];return n}function eA(n,e){return cr(e[n])}function zn(n,e){return cr(e[n.index])}function tA(n,e){return n.data[e]}function Ti(n,e){let t=e[n];return yi(t)?t:t[Lr]}function K_(n){return(n[ce]&128)===128}function PL(n){return jr(n[Wt])}function ef(n,e){return e==null?null:n[e]}function nA(n){n[Gs]=0}function Q_(n){n[ce]&1024||(n[ce]|=1024,K_(n)&&If(n))}function kL(n,e){for(;n>0;)e=e[la],n--;return e}function Ef(n){return!!(n[ce]&9216||n[dn]?.dirty)}function i_(n){n[_i].changeDetectionScheduler?.notify(9),n[ce]&64&&(n[ce]|=1024),Ef(n)&&If(n)}function If(n){n[_i].changeDetectionScheduler?.notify(0);let e=To(n);for(;e!==null&&!(e[ce]&8192||(e[ce]|=8192,!K_(e)));)e=To(e)}function rA(n,e){if(Eu(n))throw new te(911,!1);n[mi]===null&&(n[mi]=[]),n[mi].push(e)}function OL(n,e){if(n[mi]===null)return;let t=n[mi].indexOf(e);t!==-1&&n[mi].splice(t,1)}function To(n){let e=n[Wt];return jr(e)?e[Wt]:e}function FL(n){return n[Yh]??=[]}function VL(n){return n.cleanup??=[]}var Te={lFrame:dA(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var o_=!1;function LL(){return Te.lFrame.elementDepthCount}function jL(){Te.lFrame.elementDepthCount++}function BL(){Te.lFrame.elementDepthCount--}function iA(){return Te.bindingsEnabled}function UL(){return Te.skipHydrationRootTNode!==null}function $L(n){return Te.skipHydrationRootTNode===n}function HL(){Te.skipHydrationRootTNode=null}function Ye(){return Te.lFrame.lView}function pn(){return Te.lFrame.tView}function rn(){let n=oA();for(;n!==null&&n.type===64;)n=n.parent;return n}function oA(){return Te.lFrame.currentTNode}function qL(){let n=Te.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Cu(n,e){let t=Te.lFrame;t.currentTNode=n,t.isParent=e}function sA(){return Te.lFrame.isParent}function GL(){Te.lFrame.isParent=!1}function aA(){return o_}function q0(n){let e=o_;return o_=n,e}function zL(n){return Te.lFrame.bindingIndex=n}function Y_(){return Te.lFrame.bindingIndex++}function WL(n){let e=Te.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function KL(){return Te.lFrame.inI18n}function QL(n,e){let t=Te.lFrame;t.bindingIndex=t.bindingRootIndex=n,s_(e)}function YL(){return Te.lFrame.currentDirectiveIndex}function s_(n){Te.lFrame.currentDirectiveIndex=n}function ZL(n){let e=Te.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function lA(n){Te.lFrame.currentQueryIndex=n}function JL(n){let e=n[Ie];return e.type===2?e.declTNode:e.type===1?n[Gn]:null}function uA(n,e,t){if(t&me.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&me.Host);)if(i=JL(o),i===null||(o=o[la],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=Te.lFrame=cA();return r.currentTNode=e,r.lView=n,!0}function Z_(n){let e=cA(),t=n[Ie];Te.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function cA(){let n=Te.lFrame,e=n===null?null:n.child;return e===null?dA(n):e}function dA(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function hA(){let n=Te.lFrame;return Te.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var fA=hA;function J_(){let n=hA();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function XL(n){return(Te.lFrame.contextLView=kL(n,Te.lFrame.contextLView))[lr]}function ua(){return Te.lFrame.selectedIndex}function bo(n){Te.lFrame.selectedIndex=n}function X_(){let n=Te.lFrame;return tA(n.tView,n.selectedIndex)}function ej(){return Te.lFrame.currentNamespace}var pA=!0;function ev(){return pA}function tv(n){pA=n}function tj(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=ZS(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function nv(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Uh(n,e,t){gA(n,e,3,t)}function $h(n,e,t,r){(n[ce]&3)===t&&gA(n,e,t,r)}function Uy(n,e){let t=n[ce];(t&3)===e&&(t&=16383,t+=1,n[ce]=t)}function gA(n,e,t,r){let i=r!==void 0?n[Gs]&65535:0,o=r??-1,s=e.length-1,a=0;for(let l=i;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],r!=null&&a>=r)break}else e[l]<0&&(n[Gs]+=65536),(a<o||o==-1)&&(nj(n,t,e,l),n[Gs]=(n[Gs]&4294901760)+l+2),l++}function G0(n,e){An(4,n,e);let t=Ce(null);try{e.call(n)}finally{Ce(t),An(5,n,e)}}function nj(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[ce]>>14<n[Gs]>>16&&(n[ce]&3)===e&&(n[ce]+=16384,G0(a,o)):G0(a,o)}var Ks=-1,So=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=r}};function rj(n){return n instanceof So}function ij(n){return(n.flags&8)!==0}function oj(n){return(n.flags&16)!==0}function sj(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];lj(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function aj(n){return n===3||n===4||n===6}function lj(n){return n.charCodeAt(0)===64}function na(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?z0(n,t,i,null,e[++r]):z0(n,t,i,null,null))}}return n}function z0(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[o+1]=i);return}else if(r===n[o+1]){n[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r),i!==null&&n.splice(o++,0,i)}var $y={},a_=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=mf(r);let i=this.injector.get(e,$y,r);return i!==$y||t===$y?i:this.parentInjector.get(e,t,r)}};function mA(n){return n!==Ks}function tf(n){return n&32767}function uj(n){return n>>16}function nf(n,e){let t=uj(n),r=e;for(;t>0;)r=r[la],t--;return r}var l_=!0;function W0(n){let e=l_;return l_=n,e}var cj=256,yA=cj-1,_A=5,dj=0,ar={};function hj(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(hu)&&(r=t[hu]),r==null&&(r=t[hu]=dj++);let i=r&yA,o=1<<i;e.data[n+(i>>_A)]|=o}function rf(n,e){let t=vA(n,e);if(t!==-1)return t;let r=e[Ie];r.firstCreatePass&&(n.injectorIndex=e.length,Hy(r.data,n),Hy(e,null),Hy(r.blueprint,null));let i=rv(n,e),o=n.injectorIndex;if(mA(i)){let s=tf(i),a=nf(i,e),l=a[Ie].data;for(let c=0;c<8;c++)e[o+c]=a[s+c]|l[s+c]}return e[o+8]=i,o}function Hy(n,e){n.push(0,0,0,0,0,0,0,0,e)}function vA(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function rv(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=DA(i),r===null)return Ks;if(t++,i=i[la],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Ks}function u_(n,e,t){hj(n,e,t)}function wA(n,e,t){if(t&me.Optional||n!==void 0)return n;U_(e,"NodeInjector")}function EA(n,e,t,r){if(t&me.Optional&&r===void 0&&(r=null),!(t&(me.Self|me.Host))){let i=n[Xs],o=bn(void 0);try{return i?i.get(e,r,t&me.Optional):xS(e,r,t&me.Optional)}finally{bn(o)}}return wA(r,e,t)}function IA(n,e,t,r=me.Default,i){if(n!==null){if(e[ce]&2048&&!(r&me.Self)){let s=yj(n,e,t,r,ar);if(s!==ar)return s}let o=CA(n,e,t,r,ar);if(o!==ar)return o}return EA(e,t,r,i)}function CA(n,e,t,r,i){let o=gj(t);if(typeof o=="function"){if(!uA(e,n,r))return r&me.Host?wA(i,t,r):EA(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&me.Optional))U_(t);else return s}finally{fA()}}else if(typeof o=="number"){let s=null,a=vA(n,e),l=Ks,c=r&me.Host?e[ur][Gn]:null;for((a===-1||r&me.SkipSelf)&&(l=a===-1?rv(n,e):e[a+8],l===Ks||!Q0(r,!1)?a=-1:(s=e[Ie],a=tf(l),e=nf(l,e)));a!==-1;){let d=e[Ie];if(K0(o,a,d.data)){let f=fj(a,e,t,s,r,c);if(f!==ar)return f}l=e[a+8],l!==Ks&&Q0(r,e[Ie].data[a+8]===c)&&K0(o,a,e)?(s=d,a=tf(l),e=nf(l,e)):a=-1}}return i}function fj(n,e,t,r,i,o){let s=e[Ie],a=s.data[n+8],l=r==null?wf(a)&&l_:r!=s&&(a.type&3)!==0,c=i&me.Host&&o===a,d=pj(a,s,t,l,c);return d!==null?ra(e,s,d,a):ar}function pj(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,l=n.directiveStart,c=n.directiveEnd,d=o>>20,f=r?a:a+d,g=i?a+d:c;for(let m=f;m<g;m++){let v=s[m];if(m<l&&t===v||m>=l&&v.type===t)return m}if(i){let m=s[l];if(m&&vi(m)&&m.type===t)return l}return null}function ra(n,e,t,r){let i=n[t],o=e.data;if(rj(i)){let s=i;s.resolving&&rL(nL(o[t]));let a=W0(s.canSeeViewProviders);s.resolving=!0;let l,c=s.injectImpl?bn(s.injectImpl):null,d=uA(n,r,me.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&tj(t,o[t],e)}finally{c!==null&&bn(c),W0(a),s.resolving=!1,fA()}}return i}function gj(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(hu)?n[hu]:void 0;return typeof e=="number"?e>=0?e&yA:mj:e}function K0(n,e,t){let r=1<<n;return!!(t[e+(n>>_A)]&r)}function Q0(n,e){return!(n&me.Self)&&!(n&me.Host&&e)}var Io=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return IA(this._tNode,this._lView,e,mf(r),t)}};function mj(){return new Io(rn(),Ye())}function bi(n){return vu(()=>{let e=n.prototype.constructor,t=e[Gh]||c_(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[Gh]||c_(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function c_(n){return TS(n)?()=>{let e=c_(zt(n));return e&&e()}:Qs(n)}function yj(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[ce]&2048&&!(s[ce]&512);){let a=CA(o,s,t,r|me.Self,ar);if(a!==ar)return a;let l=o.parent;if(!l){let c=s[WS];if(c){let d=c.get(t,ar,r);if(d!==ar)return d}l=DA(s),s=s[la]}o=l}return i}function DA(n){let e=n[Ie],t=e.type;return t===2?e.declTNode:t===1?n[Gn]:null}function Y0(n,e=null,t=null,r){let i=TA(n,e,t,r);return i.resolveInjectorInitializers(),i}function TA(n,e=null,t=null,r,i=new Set){let o=[t||Sn,q_(n)];return r=r||(typeof n=="object"?void 0:nn(n)),new pu(o,e||z_(),r||null,i)}var hn=class n{static THROW_IF_NOT_FOUND=fu;static NULL=new Kh;static create(e,t){if(Array.isArray(e))return Y0({name:""},t,e,"");{let r=e.name??"";return Y0({name:r},e.parent,e.providers,r)}}static \u0275prov=ee({token:n,providedIn:"any",factory:()=>j(OS)});static __NG_ELEMENT_ID__=-1};var _j=new z("");_j.__NG_ELEMENT_ID__=n=>{let e=rn();if(e===null)throw new te(204,!1);if(e.type&2)return e.value;if(n&me.Optional)return null;throw new te(204,!1)};var bA=!1,iv=(()=>{class n{static __NG_ELEMENT_ID__=vj;static __NG_ENV_ID__=t=>t}return n})(),d_=class extends iv{_lView;constructor(e){super(),this._lView=e}onDestroy(e){return rA(this._lView,e),()=>OL(this._lView,e)}};function vj(){return new d_(Ye())}var ia=class{},ov=new z("",{providedIn:"root",factory:()=>!1});var SA=new z(""),AA=new z(""),No=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new bt(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=ee({token:n,providedIn:"root",factory:()=>new n})}return n})(),sv=(()=>{class n{internalPendingTasks=V(No);scheduler=V(ia);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(12),this.internalPendingTasks.remove(t))}}run(t){return N(this,null,function*(){let r=this.add();try{return yield t()}finally{r()}})}static \u0275prov=ee({token:n,providedIn:"root",factory:()=>new n})}return n})(),h_=class extends Ge{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,GS()&&(this.destroyRef=V(iv,{optional:!0})??void 0,this.pendingTasks=V(No,{optional:!0})??void 0)}emit(e){let t=Ce(null);try{super.next(e)}finally{Ce(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let l=e;i=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof tt&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},At=h_;function of(...n){}function MA(n){let e,t;function r(){n=of;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function Z0(n){return queueMicrotask(()=>n()),()=>{n=of}}var av="isAngularZone",sf=av+"_ID",wj=0,De=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new At(!1);onMicrotaskEmpty=new At(!1);onStable=new At(!1);onError=new At(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=bA}=e;if(typeof Zone>"u")throw new te(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,Cj(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(av)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new te(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new te(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,Ej,of,of);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},Ej={};function lv(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Ij(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){MA(()=>{n.callbackScheduled=!1,f_(n),n.isCheckStableRunning=!0,lv(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),f_(n)}function Cj(n){let e=()=>{Ij(n)},t=wj++;n._inner=n._inner.fork({name:"angular",properties:{[av]:!0,[sf]:t,[sf+t]:!0},onInvokeTask:(r,i,o,s,a,l)=>{if(Dj(l))return r.invokeTask(o,s,a,l);try{return J0(n),r.invokeTask(o,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),X0(n)}},onInvoke:(r,i,o,s,a,l,c)=>{try{return J0(n),r.invoke(o,s,a,l,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!Tj(l)&&e(),X0(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,f_(n),lv(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function f_(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function J0(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function X0(n){n._nesting--,lv(n)}var p_=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new At;onMicrotaskEmpty=new At;onStable=new At;onError=new At;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function Dj(n){return RA(n,"__ignore_ng_zone__")}function Tj(n){return RA(n,"__scheduler_tick__")}function RA(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var wi=class{_console=console;handleError(e){this._console.error("ERROR",e)}},bj=new z("",{providedIn:"root",factory:()=>{let n=V(De),e=V(wi);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function eS(n,e){return CS(n,e)}function Sj(n){return CS(IS,n)}var NA=(eS.required=Sj,eS);function Aj(){return Cf(rn(),Ye())}function Cf(n,e){return new hr(zn(n,e))}var hr=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=Aj}return n})();var tS=new Set;function Df(n){tS.has(n)||(tS.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function Mj(n){return typeof n=="function"&&n[cn]!==void 0}function Du(n,e){Df("NgSignals");let t=p0(n),r=t[cn];return e?.equal&&(r.equal=e.equal),t.set=i=>ch(r,i),t.update=i=>g0(r,i),t.asReadonly=Rj.bind(t),t}function Rj(){let n=this[cn];if(n.readonlyFn===void 0){let e=()=>this();e[cn]=n,n.readonlyFn=e}return n.readonlyFn}function xA(n){return Mj(n)&&typeof n.set=="function"}function PA(n){return(n.flags&128)===128}var kA=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(kA||{}),OA=new Map,Nj=0;function xj(){return Nj++}function Pj(n){OA.set(n[vf],n)}function g_(n){OA.delete(n[vf])}var nS="__ngContext__";function Ao(n,e){yi(e)?(n[nS]=e[vf],Pj(e)):n[nS]=e}function FA(n){return LA(n[gu])}function VA(n){return LA(n[qn])}function LA(n){for(;n!==null&&!jr(n);)n=n[qn];return n}var m_;function jA(n){m_=n}function kj(){if(m_!==void 0)return m_;if(typeof document<"u")return document;throw new te(210,!1)}var uv=new z("",{providedIn:"root",factory:()=>Oj}),Oj="ng",cv=new z(""),on=new z("",{providedIn:"platform",factory:()=>"unknown"});var dv=new z("",{providedIn:"root",factory:()=>kj().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Fj="h",Vj="b";var BA=!1,Lj=new z("",{providedIn:"root",factory:()=>BA});var UA=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(UA||{}),Tf=new z("");var jj=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=ee({token:n,providedIn:"root",factory:()=>new n})}return n})();var Bj=()=>null;function hv(n,e,t=!1){return Bj(n,e,t)}function $A(n,e){let t=n.contentQueries;if(t!==null){let r=Ce(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];lA(o),a.contentQueries(2,e[s],s)}}}finally{Ce(r)}}}function y_(n,e,t){lA(0);let r=Ce(null);try{e(n,t)}finally{Ce(r)}}function HA(n,e,t){if(QS(e)){let r=Ce(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let l=t[s];a.contentQueries(1,l,s)}}}finally{Ce(r)}}}var dr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(dr||{});var __=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${GV})`}};function fv(n){return n instanceof __?n.changingThisBreaksApplicationSecurity:n}function qA(n){return n instanceof Function?n():n}var Ei=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Ei||{});function Uj(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}var GA="ng-template";function $j(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&Uj(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(pv(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function pv(n){return n.type===4&&n.value!==GA}function Hj(n,e,t){let r=n.type===4&&!t?GA:n.value;return e===r}function qj(n,e,t){let r=4,i=n.attrs,o=i!==null?Wj(i):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!Hn(r)&&!Hn(l))return!1;if(s&&Hn(l))continue;s=!1,r=l|r&1;continue}if(!s)if(r&4){if(r=2|r&1,l!==""&&!Hj(n,l,t)||l===""&&e.length===1){if(Hn(r))return!1;s=!0}}else if(r&8){if(i===null||!$j(n,i,l,t)){if(Hn(r))return!1;s=!0}}else{let c=e[++a],d=Gj(l,i,pv(n),t);if(d===-1){if(Hn(r))return!1;s=!0;continue}if(c!==""){let f;if(d>o?f="":f=i[d+1].toLowerCase(),r&2&&c!==f){if(Hn(r))return!1;s=!0}}}}return Hn(r)||s}function Hn(n){return(n&1)===0}function Gj(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return Kj(e,n)}function zj(n,e,t=!1){for(let r=0;r<e.length;r++)if(qj(n,e[r],t))return!0;return!1}function Wj(n){for(let e=0;e<n.length;e++){let t=n[e];if(aj(t))return e}return n.length}function Kj(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function rS(n,e){return n?":not("+e.trim()+")":e}function Qj(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Hn(s)&&(e+=rS(o,i),i=""),r=s,o=o||!Hn(r);t++}return i!==""&&(e+=rS(o,i)),e}function Yj(n){return n.map(Qj).join(",")}function Zj(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Hn(i))break;i=o}r++}return{attrs:e,classes:t}}var xo={};function Re(n=1){zA(pn(),Ye(),ua()+n,!1)}function zA(n,e,t,r){if(!r)if((e[ce]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Uh(e,o,t)}else{let o=n.preOrderHooks;o!==null&&$h(e,o,0,t)}bo(t)}function ke(n,e=me.Default){let t=Ye();if(t===null)return j(n,e);let r=rn();return IA(r,t,zt(n),e)}function WA(n,e,t,r,i,o){let s=Ce(null);try{let a=null;i&Ei.SignalBased&&(a=e[r][cn]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&Ei.HasDecoratorInputTransform&&(o=n.inputTransforms[r].call(e,o)),n.setInput!==null?n.setInput(e,a,o,t,r):YS(e,a,r,o)}finally{Ce(s)}}function Jj(n,e){return n.createText(e)}function Xj(n,e,t){n.setValue(e,t)}function KA(n,e,t){return n.createElement(e,t)}function af(n,e,t,r,i){n.insertBefore(e,t,r,i)}function QA(n,e,t){n.appendChild(e,t)}function iS(n,e,t,r,i){r!==null?af(n,e,t,r,i):QA(n,e,t)}function e2(n,e,t){n.removeChild(null,e,t)}function t2(n,e,t){n.setAttribute(e,"style",t)}function n2(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function YA(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&sj(n,e,r),i!==null&&n2(n,e,i),o!==null&&t2(n,e,o)}function bf(n,e,t,r,i,o,s,a,l,c,d){let f=e.blueprint.slice();return f[Lr]=i,f[ce]=r|4|128|8|64|1024,(c!==null||n&&n[ce]&2048)&&(f[ce]|=2048),nA(f),f[Wt]=f[la]=n,f[lr]=t,f[_i]=s||n&&n[_i],f[yt]=a||n&&n[yt],f[Xs]=l||n&&n[Xs]||null,f[Gn]=o,f[vf]=xj(),f[Qh]=d,f[WS]=c,f[ur]=e.type==2?n[ur]:f,f}function ZA(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function JA(n,e,t,r,i){let o=ua(),s=r&2;try{bo(-1),s&&e.length>Or&&zA(n,e,Or,!1),An(s?2:0,i),t(r,i)}finally{bo(o),An(s?3:1,i)}}function XA(n,e,t){iA()&&(h2(n,e,t,zn(t,e)),(t.flags&64)===64&&iM(n,e,t))}function eM(n,e,t=zn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function tM(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=gv(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function gv(n,e,t,r,i,o,s,a,l,c,d){let f=Or+r,g=f+i,m=r2(f,g),v=typeof c=="function"?c():c;return m[Ie]={type:n,blueprint:m,template:t,queries:null,viewQuery:a,declTNode:e,data:m.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:v,incompleteFirstPass:!1,ssrId:d}}function r2(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:xo);return t}function i2(n,e,t,r){let o=r.get(Lj,BA)||t===dr.ShadowDom,s=n.selectRootElement(e,o);return o2(s),s}function o2(n){s2(n)}var s2=()=>null;function oS(n,e,t,r,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let s=e[o];if(s===void 0)continue;r??={};let a,l=Ei.None;Array.isArray(s)?(a=s[0],l=s[1]):a=s;let c=o;if(i!==null){if(!i.hasOwnProperty(o))continue;c=i[o]}n===0?sS(r,t,c,a,l):sS(r,t,c,a)}return r}function sS(n,e,t,r,i){let o;n.hasOwnProperty(t)?(o=n[t]).push(e,r):o=n[t]=[e,r],i!==void 0&&o.push(i)}function a2(n,e,t){let r=e.directiveStart,i=e.directiveEnd,o=n.data,s=e.attrs,a=[],l=null,c=null;for(let d=r;d<i;d++){let f=o[d],g=t?t.get(f):null,m=g?g.inputs:null,v=g?g.outputs:null;l=oS(0,f.inputs,d,l,m),c=oS(1,f.outputs,d,c,v);let T=l!==null&&s!==null&&!pv(e)?E2(l,d,s):null;a.push(T)}l!==null&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}function l2(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function mv(n,e,t,r,i,o,s,a){let l=zn(e,t),c=e.inputs,d;!a&&c!=null&&(d=c[r])?(yv(n,t,d,r,i),wf(e)&&u2(t,e.index)):e.type&3?(r=l2(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(l,r,i)):e.type&12}function u2(n,e){let t=Ti(e,n);t[ce]&16||(t[ce]|=64)}function nM(n,e,t,r){if(iA()){let i=r===null?null:{"":-1},o=p2(n,t),s,a;o===null?s=a=null:[s,a]=o,s!==null&&rM(n,e,t,s,i,a),i&&g2(t,r,i)}t.mergedAttrs=na(t.mergedAttrs,t.attrs)}function rM(n,e,t,r,i,o){for(let c=0;c<r.length;c++)u_(rf(t,e),n,r[c].type);y2(t,n.data.length,r.length);for(let c=0;c<r.length;c++){let d=r[c];d.providersResolver&&d.providersResolver(d)}let s=!1,a=!1,l=ZA(n,e,r.length,null);for(let c=0;c<r.length;c++){let d=r[c];t.mergedAttrs=na(t.mergedAttrs,d.hostAttrs),_2(n,t,e,l,d),m2(l,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let f=d.type.prototype;!s&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),s=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}a2(n,t,o)}function c2(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;d2(s)!=a&&s.push(a),s.push(t,r,o)}}function d2(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function h2(n,e,t,r){let i=t.directiveStart,o=t.directiveEnd;wf(t)&&v2(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||rf(t,e),Ao(r,e);let s=t.initialInputs;for(let a=i;a<o;a++){let l=n.data[a],c=ra(e,n,a,t);if(Ao(c,e),s!==null&&w2(e,a-i,c,l,t,s),vi(l)){let d=Ti(t.index,e);d[lr]=ra(e,n,a,t)}}}function iM(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=YL();try{bo(o);for(let a=r;a<i;a++){let l=n.data[a],c=e[a];s_(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&f2(l,c)}}finally{bo(-1),s_(s)}}function f2(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function p2(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let o=0;o<t.length;o++){let s=t[o];if(zj(e,s.selectors,!1))if(r||(r=[]),vi(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let l=a.length;v_(n,e,l)}else r.unshift(s),v_(n,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function v_(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function g2(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new te(-301,!1);r.push(e[i],o)}}}function m2(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;vi(e)&&(t[""]=n)}}function y2(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function _2(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=Qs(i.type,!0)),s=new So(o,vi(i),ke);n.blueprint[r]=s,t[r]=s,c2(n,e,r,ZA(n,t,i.hostVars,xo),i)}function oM(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function v2(n,e,t){let r=zn(e,n),i=tM(t),o=n[_i].rendererFactory,s=Sf(n,bf(n,i,null,oM(t),r,e,null,o.createRenderer(r,t),null,null,null));n[e.index]=s}function w2(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;){let l=s[a++],c=s[a++],d=s[a++],f=s[a++];WA(r,t,l,c,d,f)}}function E2(n,e,t){let r=null,i=0;for(;i<t.length;){let o=t[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(n.hasOwnProperty(o)){r===null&&(r=[]);let s=n[o];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}return r}function sM(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function Sf(n,e){return n[gu]?n[$0][qn]=e:n[gu]=e,n[$0]=e,e}function aM(n,e){let t=n[Xs],r=t?t.get(wi,null):null;r&&r.handleError(e)}function yv(n,e,t,r,i){for(let o=0;o<t.length;){let s=t[o++],a=t[o++],l=t[o++],c=e[s],d=n.data[s];WA(d,c,r,a,l,i)}}function I2(n,e){let t=Ti(e,n),r=t[Ie];C2(r,t);let i=t[Lr];i!==null&&t[Qh]===null&&(t[Qh]=hv(i,t[Xs])),_v(r,t,t[lr])}function C2(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function _v(n,e,t){Z_(e);try{let r=n.viewQuery;r!==null&&y_(1,r,t);let i=n.template;i!==null&&JA(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[ta]?.finishViewCreation(n),n.staticContentQueries&&$A(n,e),n.staticViewQueries&&y_(2,n.viewQuery,t);let o=n.components;o!==null&&D2(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ce]&=-5,J_()}}function D2(n,e){for(let t=0;t<e.length;t++)I2(n,e[t])}var Fr=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Fr||{}),T2;function vv(n,e){return T2(n,e)}function zs(n,e,t,r,i){if(r!=null){let o,s=!1;jr(r)?o=r:yi(r)&&(s=!0,r=r[Lr]);let a=cr(r);n===0&&t!==null?i==null?QA(e,t,a):af(e,t,a,i||null,!0):n===1&&t!==null?af(e,t,a,i||null,!0):n===2?e2(e,a,s):n===3&&e.destroyNode(a),o!=null&&L2(e,n,o,t,i)}}function b2(n,e){lM(n,e),e[Lr]=null,e[Gn]=null}function S2(n,e,t,r,i,o){r[Lr]=i,r[Gn]=e,Af(n,r,t,1,i,o)}function lM(n,e){e[_i].changeDetectionScheduler?.notify(10),Af(n,e,e[yt],2,null,null)}function A2(n){let e=n[gu];if(!e)return qy(n[Ie],n);for(;e;){let t=null;if(yi(e))t=e[gu];else{let r=e[Mn];r&&(t=r)}if(!t){for(;e&&!e[qn]&&e!==n;)yi(e)&&qy(e[Ie],e),e=e[Wt];e===null&&(e=n),yi(e)&&qy(e[Ie],e),t=e&&e[qn]}e=t}}function M2(n,e,t,r){let i=Mn+r,o=t.length;r>0&&(t[i-1][qn]=e),r<o-Mn?(e[qn]=t[i],kS(t,Mn+r,e)):(t.push(e),e[qn]=null),e[Wt]=t;let s=e[ea];s!==null&&t!==s&&uM(s,e);let a=e[ta];a!==null&&a.insertView(n),i_(e),e[ce]|=128}function uM(n,e){let t=n[Xh],r=e[Wt];if(yi(r))n[ce]|=2;else{let i=r[Wt][ur];e[ur]!==i&&(n[ce]|=2)}t===null?n[Xh]=[e]:t.push(e)}function wv(n,e){let t=n[Xh],r=t.indexOf(e);t.splice(r,1)}function w_(n,e){if(n.length<=Mn)return;let t=Mn+e,r=n[t];if(r){let i=r[ea];i!==null&&i!==n&&wv(i,r),e>0&&(n[t-1][qn]=r[qn]);let o=Wh(n,Mn+e);b2(r[Ie],r);let s=o[ta];s!==null&&s.detachView(o[Ie]),r[Wt]=null,r[qn]=null,r[ce]&=-129}return r}function cM(n,e){if(Eu(e))return;let t=e[yt];t.destroyNode&&Af(n,e,t,3,null,null),A2(e)}function qy(n,e){if(Eu(e))return;let t=Ce(null);try{e[ce]&=-129,e[ce]|=256,e[dn]&&_y(e[dn]),N2(n,e),R2(n,e),e[Ie].type===1&&e[yt].destroy();let r=e[ea];if(r!==null&&jr(e[Wt])){r!==e[Wt]&&wv(r,e);let i=e[ta];i!==null&&i.detachView(n)}g_(e)}finally{Ce(t)}}function R2(n,e){let t=n.cleanup,r=e[Yh];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[Yh]=null);let i=e[mi];if(i!==null){e[mi]=null;for(let s=0;s<i.length;s++){let a=i[s];a()}}let o=e[Zh];if(o!==null){e[Zh]=null;for(let s of o)s.destroy()}}function N2(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof So)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],l=o[s+1];An(4,a,l);try{l.call(a)}finally{An(5,a,l)}}else{An(4,i,o);try{o.call(i)}finally{An(5,i,o)}}}}}function x2(n,e,t){return P2(n,e.parent,t)}function P2(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[Lr];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=n.data[r.directiveStart+i];if(o===dr.None||o===dr.Emulated)return null}return zn(r,t)}}function k2(n,e,t){return F2(n,e,t)}function O2(n,e,t){return n.type&40?zn(n,t):null}var F2=O2,aS;function Ev(n,e,t,r){let i=x2(n,r,e),o=e[yt],s=r.parent||e[Gn],a=k2(s,r,e);if(i!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)iS(o,i,t[l],a,!1);else iS(o,i,t,a,!1);aS!==void 0&&aS(o,r,e,t,i)}function du(n,e){if(e!==null){let t=e.type;if(t&3)return zn(e,n);if(t&4)return E_(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return du(n,r);{let i=n[e.index];return jr(i)?E_(-1,i):cr(i)}}else{if(t&128)return du(n,e.next);if(t&32)return vv(e,n)()||cr(n[e.index]);{let r=dM(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=To(n[ur]);return du(i,r)}else return du(n,e.next)}}}return null}function dM(n,e){if(e!==null){let r=n[ur][Gn],i=e.projection;return r.projection[i]}return null}function E_(n,e){let t=Mn+n+1;if(t<e.length){let r=e[t],i=r[Ie].firstChild;if(i!==null)return du(r,i)}return e[Do]}function Iv(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],l=t.type;if(s&&e===0&&(a&&Ao(cr(a),r),t.flags|=2),(t.flags&32)!==32)if(l&8)Iv(n,e,t.child,r,i,o,!1),zs(e,n,i,a,o);else if(l&32){let c=vv(t,r),d;for(;d=c();)zs(e,n,i,d,o);zs(e,n,i,a,o)}else l&16?V2(n,e,r,t,i,o):zs(e,n,i,a,o);t=s?t.projectionNext:t.next}}function Af(n,e,t,r,i,o){Iv(t,r,n.firstChild,e,i,o,!1)}function V2(n,e,t,r,i,o){let s=t[ur],l=s[Gn].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let d=l[c];zs(e,n,i,d,o)}else{let c=l,d=s[Wt];PA(r)&&(c.flags|=128),Iv(n,e,c,d,i,o,!0)}}function L2(n,e,t,r,i){let o=t[Do],s=cr(t);o!==s&&zs(e,n,r,o,i);for(let a=Mn;a<t.length;a++){let l=t[a];Af(l[Ie],l,n,e,r,o)}}function j2(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:Fr.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=Fr.Important),n.setStyle(t,r,i,o))}}function B2(n,e,t,r){let i=Ce(null);try{let o=e.tView,a=n[ce]&4096?4096:16,l=bf(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),c=n[e.index];l[ea]=c;let d=n[ta];return d!==null&&(l[ta]=d.createEmbeddedView(o)),_v(o,l,t),l}finally{Ce(i)}}function lS(n,e){return!e||e.firstChild===null||PA(n)}function U2(n,e,t,r=!0){let i=e[Ie];if(M2(i,e,n,t),r){let s=E_(t,n),a=e[yt],l=a.parentNode(n[Do]);l!==null&&S2(i,n[Gn],a,e,l,s)}let o=e[Qh];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function lf(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(cr(o)),jr(o)&&$2(o,r);let s=t.type;if(s&8)lf(n,e,t.child,r);else if(s&32){let a=vv(t,e),l;for(;l=a();)r.push(l)}else if(s&16){let a=dM(e,t);if(Array.isArray(a))r.push(...a);else{let l=To(e[ur]);lf(l[Ie],l,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function $2(n,e){for(let t=Mn;t<n.length;t++){let r=n[t],i=r[Ie].firstChild;i!==null&&lf(r[Ie],r,i,e)}n[Do]!==n[Lr]&&e.push(n[Do])}var hM=[];function H2(n){return n[dn]??q2(n)}function q2(n){let e=hM.pop()??Object.create(z2);return e.lView=n,e}function G2(n){n.lView[dn]!==n&&(n.lView=null,hM.push(n))}var z2=fe($({},eu),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{If(n.lView)},consumerOnSignalRead(){this.lView[dn]=this}});function W2(n){let e=n[dn]??Object.create(K2);return e.lView=n,e}var K2=fe($({},eu),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=To(n.lView);for(;e&&!fM(e[Ie]);)e=To(e);e&&Q_(e)},consumerOnSignalRead(){this.lView[dn]=this}});function fM(n){return n.type!==2}function pM(n){if(n[Zh]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[Zh])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[ce]&8192)}}var Q2=100;function gM(n,e=!0,t=0){let i=n[_i].rendererFactory,o=!1;o||i.begin?.();try{Y2(n,t)}catch(s){throw e&&aM(n,s),s}finally{o||i.end?.()}}function Y2(n,e){let t=aA();try{q0(!0),I_(n,e);let r=0;for(;Ef(n);){if(r===Q2)throw new te(103,!1);r++,I_(n,1)}}finally{q0(t)}}function Z2(n,e,t,r){if(Eu(e))return;let i=e[ce],o=!1,s=!1;Z_(e);let a=!0,l=null,c=null;o||(fM(n)?(c=H2(e),l=ah(c)):i0()===null?(a=!1,c=W2(e),l=ah(c)):e[dn]&&(_y(e[dn]),e[dn]=null));try{nA(e),zL(n.bindingStartIndex),t!==null&&JA(n,e,t,2,r);let d=(i&3)===3;if(!o)if(d){let m=n.preOrderCheckHooks;m!==null&&Uh(e,m,null)}else{let m=n.preOrderHooks;m!==null&&$h(e,m,0,null),Uy(e,0)}if(s||J2(e),pM(e),mM(e,0),n.contentQueries!==null&&$A(n,e),!o)if(d){let m=n.contentCheckHooks;m!==null&&Uh(e,m)}else{let m=n.contentHooks;m!==null&&$h(e,m,1),Uy(e,1)}eB(n,e);let f=n.components;f!==null&&_M(e,f,0);let g=n.viewQuery;if(g!==null&&y_(2,g,r),!o)if(d){let m=n.viewCheckHooks;m!==null&&Uh(e,m)}else{let m=n.viewHooks;m!==null&&$h(e,m,2),Uy(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[By]){for(let m of e[By])m();e[By]=null}o||(e[ce]&=-73)}catch(d){throw o||If(e),d}finally{c!==null&&(my(c,l),a&&G2(c)),J_()}}function mM(n,e){for(let t=FA(n);t!==null;t=VA(t))for(let r=Mn;r<t.length;r++){let i=t[r];yM(i,e)}}function J2(n){for(let e=FA(n);e!==null;e=VA(e)){if(!(e[ce]&2))continue;let t=e[Xh];for(let r=0;r<t.length;r++){let i=t[r];Q_(i)}}}function X2(n,e,t){let r=Ti(e,n);yM(r,t)}function yM(n,e){K_(n)&&I_(n,e)}function I_(n,e){let r=n[Ie],i=n[ce],o=n[dn],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&yy(o)),s||=!1,o&&(o.dirty=!1),n[ce]&=-9217,s)Z2(r,n,r.template,n[lr]);else if(i&8192){pM(n),mM(n,1);let a=r.components;a!==null&&_M(n,a,1)}}function _M(n,e,t){for(let r=0;r<e.length;r++)X2(n,e[r],t)}function eB(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)bo(~i);else{let o=i,s=t[++r],a=t[++r];QL(s,o);let l=e[o];An(24,l),a(2,l),An(25,l)}}}finally{bo(-1)}}function Cv(n,e){let t=aA()?64:1088;for(n[_i].changeDetectionScheduler?.notify(e);n;){n[ce]|=t;let r=To(n);if(n_(n)&&!r)return n;n=r}return null}var Mo=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let e=this._lView,t=e[Ie];return lf(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r}get context(){return this._lView[lr]}get dirty(){return!!(this._lView[ce]&9280)||!!this._lView[dn]?.dirty}set context(e){this._lView[lr]=e}get destroyed(){return Eu(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Wt];if(jr(e)){let t=e[Jh],r=t?t.indexOf(this):-1;r>-1&&(w_(e,r),Wh(t,r))}this._attachedToViewContainer=!1}cM(this._lView[Ie],this._lView)}onDestroy(e){rA(this._lView,e)}markForCheck(){Cv(this._cdRefInjectingView||this._lView,4)}markForRefresh(){Q_(this._cdRefInjectingView||this._lView)}detach(){this._lView[ce]&=-129}reattach(){i_(this._lView),this._lView[ce]|=128}detectChanges(){this._lView[ce]|=1024,gM(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new te(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=n_(this._lView),t=this._lView[ea];t!==null&&!e&&wv(t,this._lView),lM(this._lView[Ie],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new te(902,!1);this._appRef=e;let t=n_(this._lView),r=this._lView[ea];r!==null&&!t&&uM(r,this._lView),i_(this._lView)}},Dv=(()=>{class n{static __NG_ELEMENT_ID__=rB}return n})(),tB=Dv,nB=class extends tB{_declarationLView;_declarationTContainer;elementRef;constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=B2(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new Mo(i)}};function rB(){return iB(rn(),Ye())}function iB(n,e){return n.type&4?new nB(e,n,Cf(n,e)):null}function Mf(n,e,t,r,i){let o=n.data[e];if(o===null)o=oB(n,e,t,r,i),KL()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=qL();o.injectorIndex=s===null?-1:s.injectorIndex}return Cu(o,!0),o}function oB(n,e,t,r,i){let o=oA(),s=sA(),a=s?o:o&&o.parent,l=n.data[e]=aB(n,a,t,e,r,i);return sB(n,l,o,s),l}function sB(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function aB(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return UL()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var BY=new RegExp(`^(\\d+)*(${Vj}|${Fj})*(.*)`);var lB=()=>null;function uS(n,e){return lB(n,e)}var C_=class{},uf=class{},D_=class{resolveComponentFactory(e){throw Error(`No component factory found for ${nn(e)}.`)}},oa=class{static NULL=new D_},sa=class{},Br=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>uB()}return n})();function uB(){let n=Ye(),e=rn(),t=Ti(e.index,n);return(yi(t)?t:n)[yt]}var cB=(()=>{class n{static \u0275prov=ee({token:n,providedIn:"root",factory:()=>null})}return n})();function T_(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=F0(i,a);else if(o==2){let l=a,c=e[++s];r=F0(r,l+": "+c+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var cf=class extends oa{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Co(e);return new mu(t,this.ngModule)}};function cS(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,a=o?i[1]:Ei.None;e?t.push({propName:s,templateName:r,isSignal:(a&Ei.SignalBased)!==0}):t.push({propName:s,templateName:r})}return t}function dB(n){let e=n.toLowerCase();return e==="svg"?NL:e==="math"?xL:null}function hB(n){let{attrs:e,classes:t}=Zj(n),r=e;return t.length&&r.push(1,...t),r}var mu=class extends uf{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;get inputs(){let e=this.componentDef,t=e.inputTransforms,r=cS(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return cS(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Yj(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let o=Ce(null);try{i=i||this.ngModule;let s=i instanceof it?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new a_(e,s):e,l=a.get(sa,null);if(l===null)throw new te(407,!1);let c=a.get(cB,null),d=a.get(ia,null),f={rendererFactory:l,sanitizer:c,changeDetectionScheduler:d},g=l.createRenderer(null,this.componentDef),m=this.componentDef.selectors[0][0]||"div",v=r?i2(g,r,this.componentDef.encapsulation,a):KA(g,m,dB(m)),T=512;this.componentDef.signals?T|=4096:this.componentDef.onPush||(T|=16);let S=null;v!==null&&(S=hv(v,a,!0));let O=gv(0,null,null,1,0,null,null,null,null,null,null),B=bf(null,O,null,T,null,null,f,g,a,null,S);B[Or]=v,Z_(B);let F,W=null;try{let X=this.componentDef,I,_=null;X.findHostDirectiveDefs?(I=[],_=new Map,X.findHostDirectiveDefs(X,I,_),I.push(X)):I=[X];let E=r?["ng-version","19.1.3"]:hB(this.componentDef.selectors[0]),C=Mf(O,Or,2,"#host",E);for(let D of I)C.mergedAttrs=na(C.mergedAttrs,D.hostAttrs);C.mergedAttrs=na(C.mergedAttrs,E),T_(C,C.mergedAttrs,!0),v&&YA(g,v,C),W=fB(C,v,X,I,B,f),t!==void 0&&gB(C,this.ngContentSelectors,t),F=pB(W,X,I,_,B,[mB]),_v(O,B,null)}catch(X){throw W!==null&&g_(W),g_(B),X}finally{J_()}let oe=tA(O,Or);return new b_(this.componentType,F,Cf(oe,B),B,oe)}finally{Ce(o)}}},b_=class extends C_{location;_rootLView;_tNode;instance;hostView;changeDetectorRef;componentType;previousInputValues=null;constructor(e,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.instance=t,this.hostView=this.changeDetectorRef=new Mo(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView;yv(o[Ie],o,i,e,t),this.previousInputValues.set(e,t);let s=Ti(this._tNode.index,o);Cv(s,1)}}get injector(){return new Io(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function fB(n,e,t,r,i,o){let s=i[Ie],a=null;e!==null&&(a=hv(e,i[Xs]));let l=o.rendererFactory.createRenderer(e,t),c=bf(i,tM(t),null,oM(t),i[n.index],n,o,l,null,null,a);return s.firstCreatePass&&v_(s,n,r.length-1),Sf(i,c),i[n.index]=c}function pB(n,e,t,r,i,o){let s=rn(),a=i[Ie],l=zn(s,i);rM(a,i,s,t,null,r);for(let d=0;d<t.length;d++){let f=s.directiveStart+d,g=ra(i,a,f,s);Ao(g,i)}iM(a,i,s),l&&Ao(l,i);let c=ra(i,a,s.directiveStart+s.componentOffset,s);if(n[lr]=i[lr]=c,o!==null)for(let d of o)d(c,e);return HA(a,s,i),c}function gB(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null&&o.length?Array.from(o):null)}}function mB(){let n=rn();nv(Ye()[Ie],n)}var Tu=(()=>{class n{static __NG_ELEMENT_ID__=yB}return n})();function yB(){let n=rn();return vB(n,Ye())}var _B=Tu,vM=class extends _B{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Cf(this._hostTNode,this._hostLView)}get injector(){return new Io(this._hostTNode,this._hostLView)}get parentInjector(){let e=rv(this._hostTNode,this._hostLView);if(mA(e)){let t=nf(e,this._hostLView),r=tf(e),i=t[Ie].data[r+8];return new Io(i,t)}else return new Io(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=dS(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Mn}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=uS(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,lS(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!SL(e),a;if(s)a=t;else{let v=t||{};a=v.index,r=v.injector,i=v.projectableNodes,o=v.environmentInjector||v.ngModuleRef}let l=s?e:new mu(Co(e)),c=r||this.parentInjector;if(!o&&l.ngModule==null){let T=(s?c:this.parentInjector).get(it,null);T&&(o=T)}let d=Co(l.componentType??{}),f=uS(this._lContainer,d?.id??null),g=f?.firstChild??null,m=l.create(c,i,g,o);return this.insertImpl(m.hostView,a,lS(this._hostTNode,f)),m}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(PL(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=i[Wt],c=new vM(l,l[Gn],l[Wt]);c.detach(c.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return U2(s,i,o,r),e.attachToViewContainerRef(),kS(Gy(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=dS(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=w_(this._lContainer,t);r&&(Wh(Gy(this._lContainer),t),cM(r[Ie],r))}detach(e){let t=this._adjustIndex(e,-1),r=w_(this._lContainer,t);return r&&Wh(Gy(this._lContainer),t)!=null?new Mo(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function dS(n){return n[Jh]}function Gy(n){return n[Jh]||(n[Jh]=[])}function vB(n,e){let t,r=e[n.index];return jr(r)?t=r:(t=sM(r,e,null,n),e[n.index]=t,Sf(e,t)),EB(t,e,n,r),new vM(t,n,e)}function wB(n,e){let t=n[yt],r=t.createComment(""),i=zn(e,n),o=t.parentNode(i);return af(t,o,r,t.nextSibling(i),!1),r}var EB=DB,IB=()=>!1;function CB(n,e,t){return IB(n,e,t)}function DB(n,e,t,r){if(n[Do])return;let i;t.type&8?i=cr(r):i=wB(e,t),n[Do]=i}var Ii=class{},yu=class{};var S_=class extends Ii{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new cf(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let o=VS(e);this._bootstrapComponents=qA(o.bootstrap),this._r3Injector=TA(e,t,[{provide:Ii,useValue:this},{provide:oa,useValue:this.componentFactoryResolver},...r],nn(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},A_=class extends yu{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new S_(this.moduleType,e,[])}};var df=class extends Ii{injector;componentFactoryResolver=new cf(this);instance=null;constructor(e){super();let t=new pu([...e.providers,{provide:Ii,useValue:this},{provide:oa,useValue:this.componentFactoryResolver}],e.parent||z_(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Tv(n,e,t=null){return new df({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var TB=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=US(!1,t.type),i=r.length>0?Tv([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=ee({token:n,providedIn:"environment",factory:()=>new n(j(it))})}return n})();function ca(n){return vu(()=>{let e=wM(n),t=fe($({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===kA.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(TB).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||dr.Emulated,styles:n.styles||Sn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Df("NgStandalone"),EM(t);let r=n.dependencies;return t.directiveDefs=fS(r,!1),t.pipeDefs=fS(r,!0),t.id=AB(t),t})}function bB(n){return Co(n)||LS(n)}function SB(n){return n!==null}function gn(n){return vu(()=>({type:n.type,bootstrap:n.bootstrap||Sn,declarations:n.declarations||Sn,imports:n.imports||Sn,exports:n.exports||Sn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function hS(n,e){if(n==null)return Ys;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a=Ei.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(t[o]=a!==Ei.None?[r,a]:r,e[o]=s):t[o]=r}return t}function Lt(n){return vu(()=>{let e=wM(n);return EM(e),e})}function wM(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Ys,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Sn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:hS(n.inputs,e),outputs:hS(n.outputs),debugInfo:null}}function EM(n){n.features?.forEach(e=>e(n))}function fS(n,e){if(!n)return null;let t=e?jS:bB;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(SB)}function AB(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function MB(n){return Object.getPrototypeOf(n.prototype).constructor}function Ur(n){let e=MB(n.type),t=!0,r=[n];for(;e;){let i;if(vi(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new te(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let s=n;s.inputs=Lh(n.inputs),s.inputTransforms=Lh(n.inputTransforms),s.declaredInputs=Lh(n.declaredInputs),s.outputs=Lh(n.outputs);let a=i.hostBindings;a&&kB(n,a);let l=i.viewQuery,c=i.contentQueries;if(l&&xB(n,l),c&&PB(n,c),RB(n,i),KV(n.outputs,i.outputs),vi(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===Ur&&(t=!1)}}e=Object.getPrototypeOf(e)}NB(r)}function RB(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function NB(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=na(i.hostAttrs,t=na(t,i.hostAttrs))}}function Lh(n){return n===Ys?{}:n===Sn?[]:n}function xB(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function PB(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,o)=>{e(r,i,o),t(r,i,o)}:n.contentQueries=e}function kB(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function IM(n){return FB(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function OB(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function FB(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Rf(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function VB(n){return(n.flags&32)===32}function LB(n,e,t,r,i,o,s,a,l){let c=e.consts,d=Mf(e,n,4,s||null,a||null);nM(e,t,d,ef(c,l)),nv(e,d);let f=d.tView=gv(2,d,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}function jB(n,e,t,r,i,o,s,a,l,c){let d=t+Or,f=e.firstCreatePass?LB(d,e,n,r,i,o,s,a,l):e.data[d];Cu(f,!1);let g=BB(e,n,f,t);ev()&&Ev(e,n,g,f),Ao(g,n);let m=sM(g,n,g,f);return n[d]=m,Sf(n,m),CB(m,f,n),W_(f)&&XA(e,n,f),l!=null&&eM(n,f,c),f}function Nf(n,e,t,r,i,o,s,a){let l=Ye(),c=pn(),d=ef(c.consts,o);return jB(l,c,n,e,t,r,i,d,s,a),Nf}var BB=UB;function UB(n,e,t,r){return tv(!0),e[yt].createComment("")}var bv=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var CM=new z("");function Po(n){return!!n&&typeof n.then=="function"}function DM(n){return!!n&&typeof n.subscribe=="function"}var TM=new z("");var bM=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=V(TM,{optional:!0})??[];injector=V(hn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=Rn(this.injector,i);if(Po(o))t.push(o);else if(DM(o)){let s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),$B=(()=>{class n{static \u0275prov=ee({token:n,providedIn:"root",factory:()=>new M_})}return n})(),M_=class{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),this.queuedEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}},Sv=new z("");function HB(){f0(()=>{throw new te(600,!1)})}function qB(n){return n.isBoundToModule}var GB=10;function zB(n,e,t){try{let r=t();return Po(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var Ci=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=V(bj);afterRenderManager=V(jj);zonelessEnabled=V(ov);rootEffectScheduler=V($B);dirtyFlags=0;deferredDirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new Ge;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=V(No).hasPendingTasks.pipe(Z(t=>!t));constructor(){V(Tf,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=V(it);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){let i=t instanceof uf;if(!this._injector.get(bM).done){let g=!i&&BS(t),m=!1;throw new te(405,m)}let s;i?s=t:s=this._injector.get(oa).resolveComponentFactory(t),this.componentTypes.push(s.componentType);let a=qB(s)?void 0:this._injector.get(Ii),l=r||s.selector,c=s.create(hn.NULL,[],l,a),d=c.location.nativeElement,f=c.injector.get(CM,null);return f?.registerApplication(d),c.onDestroy(()=>{this.detachView(c.hostView),Hh(this.components,c),f?.unregisterApplication(d)}),this._loadComponent(c),c}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick=()=>{if(this.tracingSnapshot!==null){let r=this.tracingSnapshot;this.tracingSnapshot=null,r.run(UA.CHANGE_DETECTION,this._tick),r.dispose();return}if(this._runningTick)throw new te(101,!1);let t=Ce(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,Ce(t),this.afterTick.next()}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(sa,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let t=0;for(;this.dirtyFlags!==0&&t++<GB;)this.synchronizeOnce()}synchronizeOnce(){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let t=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:i}of this.allViews)WB(r,i,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Ef(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Hh(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Sv,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Hh(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new te(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Hh(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function WB(n,e,t,r){if(!t&&!Ef(n))return;gM(n,e,t&&!r?0:1)}function SM(n,e,t,r){return Rf(n,Y_(),t)?e+RS(t)+r:xo}function jh(n,e){return n<<17|e<<2}function Ro(n){return n>>17&32767}function KB(n){return(n&2)==2}function QB(n,e){return n&131071|e<<17}function R_(n){return n|2}function aa(n){return(n&131068)>>2}function zy(n,e){return n&-131069|e<<2}function YB(n){return(n&1)===1}function N_(n){return n|1}function ZB(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,a=Ro(s),l=aa(s);n[r]=t;let c=!1,d;if(Array.isArray(t)){let f=t;d=f[1],(d===null||wu(f,d)>0)&&(c=!0)}else d=t;if(i)if(l!==0){let g=Ro(n[a+1]);n[r+1]=jh(g,a),g!==0&&(n[g+1]=zy(n[g+1],r)),n[a+1]=QB(n[a+1],r)}else n[r+1]=jh(a,0),a!==0&&(n[a+1]=zy(n[a+1],r)),a=r;else n[r+1]=jh(l,0),a===0?a=r:n[l+1]=zy(n[l+1],r),l=r;c&&(n[r+1]=R_(n[r+1])),pS(n,d,r,!0),pS(n,d,r,!1),JB(e,d,n,r,o),s=jh(a,l),o?e.classBindings=s:e.styleBindings=s}function JB(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&wu(o,e)>=0&&(t[r+1]=N_(t[r+1]))}function pS(n,e,t,r){let i=n[t+1],o=e===null,s=r?Ro(i):aa(i),a=!1;for(;s!==0&&(a===!1||o);){let l=n[s],c=n[s+1];XB(l,e)&&(a=!0,n[s+1]=r?N_(c):R_(c)),s=r?Ro(c):aa(c)}a&&(n[t+1]=r?R_(i):N_(i))}function XB(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?wu(n,e)>=0:!1}function $r(n,e,t){let r=Ye(),i=Y_();if(Rf(r,i,e)){let o=pn(),s=X_();mv(o,s,r,n,e,r[yt],t,!1)}return $r}function gS(n,e,t,r,i){let o=e.inputs,s=i?"class":"style";yv(n,t,o[s],s,r)}function Av(n,e){return eU(n,e,null,!0),Av}function eU(n,e,t,r){let i=Ye(),o=pn(),s=WL(2);if(o.firstUpdatePass&&nU(o,n,s,r),e!==xo&&Rf(i,s,e)){let a=o.data[ua()];aU(o,a,i,i[yt],n,i[s+1]=lU(e,t),r,s)}}function tU(n,e){return e>=n.expandoStartIndex}function nU(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[ua()],s=tU(n,t);uU(o,r)&&e===null&&!s&&(e=!1),e=rU(i,o,e,r),ZB(i,o,e,t,s,r)}}function rU(n,e,t,r){let i=ZL(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=Wy(null,n,e,t,r),t=_u(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=Wy(i,n,e,t,r),o===null){let l=iU(n,e,r);l!==void 0&&Array.isArray(l)&&(l=Wy(null,n,e,l[1],r),l=_u(l,e.attrs,r),oU(n,e,r,l))}else o=sU(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function iU(n,e,t){let r=t?e.classBindings:e.styleBindings;if(aa(r)!==0)return n[Ro(r)]}function oU(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[Ro(i)]=r}function sU(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=_u(r,s,t)}return _u(r,e.attrs,t)}function Wy(n,e,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],r=_u(r,o.hostAttrs,i),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function _u(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),gL(n,s,t?!0:e[++o]))}return n===void 0?null:n}function aU(n,e,t,r,i,o,s,a){if(!(e.type&3))return;let l=n.data,c=l[a+1],d=YB(c)?mS(l,e,t,i,aa(c),s):void 0;if(!hf(d)){hf(o)||KB(c)&&(o=mS(l,null,t,i,a,s));let f=eA(ua(),t);j2(r,s,f,i,o)}}function mS(n,e,t,r,i,o){let s=e===null,a;for(;i>0;){let l=n[i],c=Array.isArray(l),d=c?l[1]:l,f=d===null,g=t[i+1];g===xo&&(g=f?Sn:void 0);let m=f?Ly(g,r):d===r?g:void 0;if(c&&!hf(m)&&(m=Ly(l,r)),hf(m)&&(a=m,s))return a;let v=n[i+1];i=s?Ro(v):aa(v)}if(e!==null){let l=o?e.residualClasses:e.residualStyles;l!=null&&(a=Ly(l,r))}return a}function hf(n){return n!==void 0}function lU(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=nn(fv(n)))),n}function uU(n,e){return(n.flags&(e?8:16))!==0}function cU(n,e,t,r,i,o){let s=e.consts,a=ef(s,i),l=Mf(e,n,2,r,a);return nM(e,t,l,ef(s,o)),l.attrs!==null&&T_(l,l.attrs,!1),l.mergedAttrs!==null&&T_(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function Q(n,e,t,r){let i=Ye(),o=pn(),s=Or+n,a=i[yt],l=o.firstCreatePass?cU(s,o,i,e,t,r):o.data[s],c=dU(o,i,l,a,e,n);i[s]=c;let d=W_(l);return Cu(l,!0),YA(a,c,l),!VB(l)&&ev()&&Ev(o,i,c,l),LL()===0&&Ao(c,i),jL(),d&&(XA(o,i,l),HA(o,l,i)),r!==null&&eM(i,l),Q}function Y(){let n=rn();sA()?GL():(n=n.parent,Cu(n,!1));let e=n;$L(e)&&HL(),BL();let t=pn();return t.firstCreatePass&&(nv(t,n),QS(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&ij(e)&&gS(t,e,Ye(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&oj(e)&&gS(t,e,Ye(),e.stylesWithoutHost,!1),Y}function ko(n,e,t,r){return Q(n,e,t,r),Y(),ko}var dU=(n,e,t,r,i,o)=>(tv(!0),KA(r,i,ej()));var ff="en-US";var hU=ff;function fU(n){typeof n=="string"&&(hU=n.toLowerCase().replace(/_/g,"-"))}var pU=(n,e,t)=>{};function Mt(n,e,t,r){let i=Ye(),o=pn(),s=rn();return AM(o,i,i[yt],s,n,e,r),Mt}function gU(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[Yh],l=i[o+2];return a.length>l?a[l]:null}typeof s=="string"&&(o+=2)}return null}function AM(n,e,t,r,i,o,s){let a=W_(r),c=n.firstCreatePass&&VL(n),d=e[lr],f=FL(e),g=!0;if(r.type&3||s){let T=zn(r,e),S=s?s(T):T,O=f.length,B=s?W=>s(cr(W[r.index])):r.index,F=null;if(!s&&a&&(F=gU(n,e,i,r.index)),F!==null){let W=F.__ngLastListenerFn__||F;W.__ngNextListenerFn__=o,F.__ngLastListenerFn__=o,g=!1}else{o=_S(r,e,d,o),pU(T,i,o);let W=t.listen(S,i,o);f.push(o,W),c&&c.push(i,B,O,O+1)}}else o=_S(r,e,d,o);let m=r.outputs,v;if(g&&m!==null&&(v=m[i])){let T=v.length;if(T)for(let S=0;S<T;S+=2){let O=v[S],B=v[S+1],oe=e[O][B].subscribe(o),X=f.length;f.push(o,oe),c&&c.push(i,r.index,X,-(X+1))}}}function yS(n,e,t,r){let i=Ce(null);try{return An(6,e,t),t(r)!==!1}catch(o){return aM(n,o),!1}finally{An(7,e,t),Ce(i)}}function _S(n,e,t,r){return function i(o){if(o===Function)return r;let s=n.componentOffset>-1?Ti(n.index,e):e;Cv(s,5);let a=yS(e,t,r,o),l=i.__ngNextListenerFn__;for(;l;)a=yS(e,t,l,o)&&a,l=l.__ngNextListenerFn__;return a}}function MM(n=1){return XL(n)}function Mv(n,e,t,r,i){let o=Ye(),s=SM(o,e,t,r);if(s!==xo){let a=pn(),l=X_();mv(a,l,o,n,s,o[yt],i,!1)}return Mv}function ie(n,e=""){let t=Ye(),r=pn(),i=n+Or,o=r.firstCreatePass?Mf(r,i,1,e,null):r.data[i],s=mU(r,t,o,e,n);t[i]=s,ev()&&Ev(r,t,s,o),Cu(o,!1)}var mU=(n,e,t,r,i)=>(tv(!0),Jj(e[yt],r));function Si(n){return Kt("",n,""),Si}function Kt(n,e,t){let r=Ye(),i=SM(r,n,e,t);return i!==xo&&yU(r,ua(),i),Kt}function yU(n,e,t){let r=eA(e,n);Xj(n[yt],r,t)}function Ai(n,e,t){xA(e)&&(e=e());let r=Ye(),i=Y_();if(Rf(r,i,e)){let o=pn(),s=X_();mv(o,s,r,n,e,r[yt],t,!1)}return Ai}function Oo(n,e){let t=xA(n);return t&&n.set(e),t}function Mi(n,e){let t=Ye(),r=pn(),i=rn();return AM(r,t,t[yt],i,n,e),Mi}function _U(n,e,t){let r=pn();if(r.firstCreatePass){let i=vi(n);x_(t,r.data,r.blueprint,i,!0),x_(e,r.data,r.blueprint,i,!1)}}function x_(n,e,t,r,i){if(n=zt(n),Array.isArray(n))for(let o=0;o<n.length;o++)x_(n[o],e,t,r,i);else{let o=pn(),s=Ye(),a=rn(),l=Js(n)?n:zt(n.provide),c=qS(n),d=a.providerIndexes&1048575,f=a.directiveStart,g=a.providerIndexes>>20;if(Js(n)||!n.multi){let m=new So(c,i,ke),v=Qy(l,e,i?d:d+g,f);v===-1?(u_(rf(a,s),o,l),Ky(o,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(m),s.push(m)):(t[v]=m,s[v]=m)}else{let m=Qy(l,e,d+g,f),v=Qy(l,e,d,d+g),T=m>=0&&t[m],S=v>=0&&t[v];if(i&&!S||!i&&!T){u_(rf(a,s),o,l);let O=EU(i?wU:vU,t.length,i,r,c);!i&&S&&(t[v].providerFactory=O),Ky(o,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(O),s.push(O)}else{let O=RM(t[i?v:m],c,!i&&r);Ky(o,n,m>-1?m:v,O)}!i&&r&&S&&t[v].componentProviders++}}}function Ky(n,e,t,r){let i=Js(e),o=wL(e);if(i||o){let l=(o?zt(e.useClass):e).prototype.ngOnDestroy;if(l){let c=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=c.indexOf(t);d===-1?c.push(t,[r,l]):c[d+1].push(r,l)}else c.push(t,l)}}}function RM(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Qy(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function vU(n,e,t,r){return P_(this.multi,[])}function wU(n,e,t,r){let i=this.multi,o;if(this.providerFactory){let s=this.providerFactory.componentProviders,a=ra(t,t[Ie],this.providerFactory.index,r);o=a.slice(0,s),P_(i,o);for(let l=s;l<a.length;l++)o.push(a[l])}else o=[],P_(i,o);return o}function P_(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function EU(n,e,t,r,i){let o=new So(n,t,ke);return o.multi=[],o.index=e,o.componentProviders=0,RM(o,i,r&&!t),o}function da(n,e=[]){return t=>{t.providersResolver=(r,i)=>_U(r,i?i(n):n,e)}}var Vr=class{full;major;minor;patch;constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},NM=new Vr("19.1.3"),k_=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},Rv=(()=>{class n{compileModuleSync(t){return new A_(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=VS(t),o=qA(i.declarations).reduce((s,a)=>{let l=Co(a);return l&&s.push(new mu(l)),s},[]);return new k_(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var IU=(()=>{class n{zone=V(De);changeDetectionScheduler=V(ia);applicationRef=V(Ci);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function CU({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new De(fe($({},DU()),{scheduleInRootZone:t})),[{provide:De,useFactory:n},{provide:Zs,multi:!0,useFactory:()=>{let r=V(IU,{optional:!0});return()=>r.initialize()}},{provide:Zs,multi:!0,useFactory:()=>{let r=V(TU);return()=>{r.initialize()}}},e===!0?{provide:SA,useValue:!0}:[],{provide:AA,useValue:t??bA}]}function DU(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var TU=(()=>{class n{subscription=new tt;initialized=!1;zone=V(De);pendingTasks=V(No);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{De.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{De.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var bU=(()=>{class n{appRef=V(Ci);taskService=V(No);ngZone=V(De);zonelessEnabled=V(ov);tracing=V(Tf,{optional:!0});disableScheduling=V(SA,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new tt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(sf):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(V(AA,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof p_||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let r=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 8:{this.appRef.deferredDirtyFlags|=8;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 13:{this.appRef.dirtyFlags|=16,r=!0;break}case 14:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{r=!0;break}case 10:case 9:case 7:case 11:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?Z0:MA;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(sf+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,Z0(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function SU(){return typeof $localize<"u"&&$localize.locale||ff}var Nv=new z("",{providedIn:"root",factory:()=>V(Nv,me.Optional|me.SkipSelf)||SU()});var O_=new z(""),AU=new z("");function uu(n){return!n.moduleRef}function MU(n){let e=uu(n)?n.r3Injector:n.moduleRef.injector,t=e.get(De);return t.run(()=>{uu(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(wi,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),uu(n)){let o=()=>e.destroy(),s=n.platformInjector.get(O_);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(O_);s.add(o),n.moduleRef.onDestroy(()=>{Hh(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return zB(r,t,()=>{let o=e.get(bM);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(Nv,ff);if(fU(s||ff),!e.get(AU,!0))return uu(n)?e.get(Ci):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(uu(n)){let l=e.get(Ci);return n.rootComponent!==void 0&&l.bootstrap(n.rootComponent),l}else return RU(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function RU(n,e){let t=n.injector.get(Ci);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new te(-403,!1);e.push(n)}var qh=null;function NU(n=[],e){return hn.create({name:e,providers:[{provide:_f,useValue:"platform"},{provide:O_,useValue:new Set([()=>qh=null])},...n]})}function xU(n=[]){if(qh)return qh;let e=NU(n);return qh=e,HB(),PU(e),e}function PU(n){let e=n.get(cv,null);Rn(n,()=>{e?.forEach(t=>t())})}function bu(){return!1}var Fo=(()=>{class n{static __NG_ELEMENT_ID__=kU}return n})();function kU(n){return OU(rn(),Ye(),(n&16)===16)}function OU(n,e,t){if(wf(n)&&!t){let r=Ti(n.index,e);return new Mo(r,r)}else if(n.type&175){let r=e[ur];return new Mo(r,e)}return null}var F_=class{constructor(){}supports(e){return IM(e)}create(e){return new V_(e)}},FU=(n,e)=>e,V_=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||FU}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<vS(r,i,o)?t:r,a=vS(s,i,o),l=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let c=a-i,d=l-i;if(c!=d){for(let g=0;g<c;g++){let m=g<o.length?o[g]:o[g]=0,v=m+g;d<=v&&v<c&&(o[g]=m+1)}let f=s.previousIndex;o[f]=d-c}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!IM(e))throw new te(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,OB(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new L_(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new pf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new pf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},L_=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},j_=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},pf=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new j_,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function vS(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function wS(){return new xv([new F_])}var xv=(()=>{class n{factories;static \u0275prov=ee({token:n,providedIn:"root",factory:wS});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||wS()),deps:[[n,new fL,new yf]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new te(901,!1)}}return n})();function xM(n){try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=xU(r),o=[CU({}),{provide:ia,useExisting:bU},...t||[]],s=new df({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return MU({r3Injector:s.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}}function xf(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function Su(n,e){Df("NgSignals");let t=c0(n);return e?.equal&&(t[cn].equal=e.equal),t}function Hr(n){let e=Ce(null);try{return n()}finally{Ce(e)}}var ES=class{[cn];constructor(e){this[cn]=e}destroy(){this[cn].destroy()}};var VM=null;function qr(){return VM}function LM(n){VM??=n}var Pf=class{};var xn=new z(""),jM=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>V(jU),providedIn:"platform"})}return n})();var jU=(()=>{class n extends jM{_location;_history;_doc=V(xn);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return qr().getBaseHref(this._doc)}onPopState(t){let r=qr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=qr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function BM(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function PM(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Vo(n){return n&&n[0]!=="?"?"?"+n:n}var Of=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>V(UM),providedIn:"root"})}return n})(),BU=new z(""),UM=(()=>{class n extends Of{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??V(xn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return BM(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Vo(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+Vo(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+Vo(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(j(jM),j(BU,8))};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Au=(()=>{class n{_subject=new Ge;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=HU(PM(kM(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Vo(r))}normalize(t){return n.stripTrailingSlash($U(this._basePath,kM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Vo(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Vo(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=Vo;static joinWithSlash=BM;static stripTrailingSlash=PM;static \u0275fac=function(r){return new(r||n)(j(Of))};static \u0275prov=ee({token:n,factory:()=>UU(),providedIn:"root"})}return n})();function UU(){return new Au(j(Of))}function $U(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function kM(n){return n.replace(/\/index.html$/,"")}function HU(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function $M(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var Pv=/\s+/,OM=[],HM=(()=>{class n{_ngEl;_renderer;initialClasses=OM;rawClass;stateMap=new Map;constructor(t,r){this._ngEl=t,this._renderer=r}set klass(t){this.initialClasses=t!=null?t.trim().split(Pv):OM}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(Pv):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(Pv).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||n)(ke(hr),ke(Br))};static \u0275dir=Lt({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var kv=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},qM=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new kv(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),FM(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);FM(o,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(ke(Tu),ke(Dv),ke(xv))};static \u0275dir=Lt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function FM(n,e){n.context.$implicit=e.item}var Mu=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=gn({type:n});static \u0275inj=fn({})}return n})(),GM="browser",qU="server";function Lo(n){return n===qU}var kf=class{};var Fv=class extends Pf{supportsDOMEvents=!0},Vv=class n extends Fv{static makeCurrent(){LM(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=zU();return t==null?null:WU(t)}resetBaseElement(){Ru=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return $M(document.cookie,e)}},Ru=null;function zU(){return Ru=Ru||document.querySelector("base"),Ru?Ru.getAttribute("href"):null}function WU(n){return new URL(n,document.baseURI).pathname}var KU=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})(),Lv=new z(""),ZM=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,o){return this._findPluginFor(r).addEventListener(t,r,i,o)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new te(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(j(Lv),j(De))};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})(),Vf=class{_doc;constructor(e){this._doc=e}manager},Ff="ng-app-id";function zM(n){for(let e of n)e.remove()}function WM(n,e){let t=e.createElement("style");return t.textContent=n,t}function QU(n,e,t,r){let i=n.head?.querySelectorAll(`style[${Ff}="${e}"],link[${Ff}="${e}"]`);if(i)for(let o of i)o.removeAttribute(Ff),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function jv(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var JM=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=Lo(o),QU(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,WM);r?.forEach(i=>this.addUsage(i,this.external,jv))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let o=r.get(t);o?o.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(zM(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])zM(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,WM(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,jv(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(Ff,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(j(xn),j(uv),j(dv,8),j(on))};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})(),Ov={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Uv=/%COMP%/g,XM="%COMP%",YU=`_nghost-${XM}`,ZU=`_ngcontent-${XM}`,JU=!0,XU=new z("",{providedIn:"root",factory:()=>JU});function e$(n){return ZU.replace(Uv,n)}function t$(n){return YU.replace(Uv,n)}function eR(n,e){return e.map(t=>t.replace(Uv,n))}var KM=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,o,s,a,l,c=null,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=l,this.nonce=c,this.tracingService=d,this.platformIsServer=Lo(a),this.defaultRenderer=new Nu(t,s,l,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===dr.ShadowDom&&(r=fe($({},r),{encapsulation:dr.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof Lf?i.applyToHost(t):i instanceof xu&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,f=this.platformIsServer;switch(r.encapsulation){case dr.Emulated:o=new Lf(l,c,r,this.appId,d,s,a,f,this.tracingService);break;case dr.ShadowDom:return new Bv(l,c,t,r,s,a,this.nonce,f,this.tracingService);default:o=new xu(l,c,r,d,s,a,f,this.tracingService);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(j(ZM),j(JM),j(uv),j(XU),j(xn),j(on),j(De),j(dv),j(Tf,8))};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})(),Nu=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,o){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(Ov[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(QM(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(QM(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new te(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=Ov[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Ov[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Fr.DashCase|Fr.Important)?e.style.setProperty(t,r,i&Fr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Fr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=qr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);let o=this.decoratePreventDefault(r);return this.tracingService!==null&&this.tracingService.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function QM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Bv=class extends Nu{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,o,s,a,l,c){super(e,o,s,l,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=eR(i.id,i.styles);for(let g of d){let m=document.createElement("style");a&&m.setAttribute("nonce",a),m.textContent=g,this.shadowRoot.appendChild(m)}let f=i.getExternalStyles?.();if(f)for(let g of f){let m=jv(g,o);a&&m.setAttribute("nonce",a),this.shadowRoot.appendChild(m)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},xu=class extends Nu{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,o,s,a,l,c){super(e,o,s,a,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?eR(c,r.styles):r.styles,this.styleUrls=r.getExternalStyles?.(c)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Lf=class extends xu{contentAttr;hostAttr;constructor(e,t,r,i,o,s,a,l,c){let d=i+"-"+r.id;super(e,t,r,o,s,a,l,c,d),this.contentAttr=e$(d),this.hostAttr=t$(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},n$=(()=>{class n extends Vf{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,o){return t.addEventListener(r,i,o),()=>this.removeEventListener(t,r,i,o)}removeEventListener(t,r,i,o){return t.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||n)(j(xn))};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})(),YM=["alt","control","meta","shift"],r$={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},i$={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},o$=(()=>{class n extends Vf{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,o){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>qr().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),YM.forEach(c=>{let d=r.indexOf(c);d>-1&&(r.splice(d,1),s+=c+".")}),s+=o,r.length!=0||o.length===0)return null;let l={};return l.domEventName=i,l.fullKey=s,l}static matchEventFullKeyCode(t,r){let i=r$[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),YM.forEach(s=>{if(s!==i){let a=i$[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(j(xn))};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})();function tR(n,e){return xM($({rootComponent:n},s$(e)))}function s$(n){return{appProviders:[...d$,...n?.providers??[]],platformProviders:c$}}function a$(){Vv.makeCurrent()}function l$(){return new wi}function u$(){return jA(document),document}var c$=[{provide:on,useValue:GM},{provide:cv,useValue:a$,multi:!0},{provide:xn,useFactory:u$,deps:[]}];var d$=[{provide:_f,useValue:"root"},{provide:wi,useFactory:l$,deps:[]},{provide:Lv,useClass:n$,multi:!0,deps:[xn,De,on]},{provide:Lv,useClass:o$,multi:!0,deps:[xn]},KM,JM,ZM,{provide:sa,useExisting:KM},{provide:kf,useClass:KU,deps:[]},[]];var nR=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(j(xn))};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ge="primary",Ku=Symbol("RouteTitle"),zv=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ya(n){return new zv(n)}function p$(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function g$(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!fr(n[t],e[t]))return!1;return!0}function fr(n,e){let t=n?Wv(n):void 0,r=e?Wv(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!cR(n[i],e[i]))return!1;return!0}function Wv(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function cR(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function dR(n){return n.length>0?n[n.length-1]:null}function Ri(n){return Ny(n)?n:Po(n)?Pe(Promise.resolve(n)):ne(n)}var m$={exact:fR,subset:pR},hR={exact:y$,subset:_$,ignored:()=>!0};function rR(n,e,t){return m$[t.paths](n.root,e.root,t.matrixParams)&&hR[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function y$(n,e){return fr(n,e)}function fR(n,e,t){if(!Bo(n.segments,e.segments)||!Uf(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!fR(n.children[r],e.children[r],t))return!1;return!0}function _$(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>cR(n[t],e[t]))}function pR(n,e,t){return gR(n,e,e.segments,t)}function gR(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Bo(i,t)||e.hasChildren()||!Uf(i,t,r))}else if(n.segments.length===t.length){if(!Bo(n.segments,t)||!Uf(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!pR(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!Bo(n.segments,i)||!Uf(n.segments,i,r)||!n.children[ge]?!1:gR(n.children[ge],e,o,r)}}function Uf(n,e,t){return e.every((r,i)=>hR[t](n[i].parameters,r.parameters))}var zr=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Oe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ya(this.queryParams),this._queryParamMap}toString(){return E$.serialize(this)}},Oe=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return $f(this)}},jo=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ya(this.parameters),this._parameterMap}toString(){return yR(this)}};function v$(n,e){return Bo(n,e)&&n.every((t,r)=>fr(t.parameters,e[r].parameters))}function Bo(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function w$(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===ge&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==ge&&(t=t.concat(e(i,r)))}),t}var vw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>new Lu,providedIn:"root"})}return n})(),Lu=class{parse(e){let t=new Qv(e);return new zr(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Pu(e.root,!0)}`,r=D$(e.queryParams),i=typeof e.fragment=="string"?`#${I$(e.fragment)}`:"";return`${t}${r}${i}`}},E$=new Lu;function $f(n){return n.segments.map(e=>yR(e)).join("/")}function Pu(n,e){if(!n.hasChildren())return $f(n);if(e){let t=n.children[ge]?Pu(n.children[ge],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==ge&&r.push(`${i}:${Pu(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=w$(n,(r,i)=>i===ge?[Pu(n.children[ge],!1)]:[`${i}:${Pu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[ge]!=null?`${$f(n)}/${t[0]}`:`${$f(n)}/(${t.join("//")})`}}function mR(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function jf(n){return mR(n).replace(/%3B/gi,";")}function I$(n){return encodeURI(n)}function Kv(n){return mR(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Hf(n){return decodeURIComponent(n)}function iR(n){return Hf(n.replace(/\+/g,"%20"))}function yR(n){return`${Kv(n.path)}${C$(n.parameters)}`}function C$(n){return Object.entries(n).map(([e,t])=>`;${Kv(e)}=${Kv(t)}`).join("")}function D$(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${jf(t)}=${jf(i)}`).join("&"):`${jf(t)}=${jf(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var T$=/^[^\/()?;#]+/;function $v(n){let e=n.match(T$);return e?e[0]:""}var b$=/^[^\/()?;=#]+/;function S$(n){let e=n.match(b$);return e?e[0]:""}var A$=/^[^=?&#]+/;function M$(n){let e=n.match(A$);return e?e[0]:""}var R$=/^[^&#]+/;function N$(n){let e=n.match(R$);return e?e[0]:""}var Qv=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Oe([],{}):new Oe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[ge]=new Oe(e,t)),r}parseSegment(){let e=$v(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new te(4009,!1);return this.capture(e),new jo(Hf(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=S$(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=$v(this.remaining);i&&(r=i,this.capture(r))}e[Hf(t)]=Hf(r)}parseQueryParam(e){let t=M$(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=N$(this.remaining);s&&(r=s,this.capture(r))}let i=iR(t),o=iR(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=$v(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new te(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=ge);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[ge]:new Oe([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new te(4011,!1)}};function _R(n){return n.segments.length>0?new Oe([],{[ge]:n}):n}function vR(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=vR(i);if(r===ge&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new Oe(n.segments,e);return x$(t)}function x$(n){if(n.numberOfChildren===1&&n.children[ge]){let e=n.children[ge];return new Oe(n.segments.concat(e.segments),e.children)}return n}function ju(n){return n instanceof zr}function P$(n,e,t=null,r=null){let i=wR(n);return ER(i,e,t,r)}function wR(n){let e;function t(o){let s={};for(let l of o.children){let c=t(l);s[l.outlet]=c}let a=new Oe(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=_R(r);return e??i}function ER(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Hv(i,i,i,t,r);let o=k$(e);if(o.toRoot())return Hv(i,i,new Oe([],{}),t,r);let s=O$(o,i,n),a=s.processChildren?Ou(s.segmentGroup,s.index,o.commands):CR(s.segmentGroup,s.index,o.commands);return Hv(i,s.segmentGroup,a,t,r)}function qf(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Bu(n){return typeof n=="object"&&n!=null&&n.outlets}function Hv(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([l,c])=>{o[l]=Array.isArray(c)?c.map(d=>`${d}`):`${c}`});let s;n===e?s=t:s=IR(n,e,t);let a=_R(vR(s));return new zr(a,o,i)}function IR(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=IR(o,e,t)}),new Oe(n.segments,r)}var Gf=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&qf(r[0]))throw new te(4003,!1);let i=r.find(Bu);if(i&&i!==dR(r))throw new te(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function k$(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Gf(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new Gf(t,e,r)}var pa=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function O$(n,e,t){if(n.isAbsolute)return new pa(e,!0,0);if(!t)return new pa(e,!1,NaN);if(t.parent===null)return new pa(t,!0,0);let r=qf(n.commands[0])?0:1,i=t.segments.length-1+r;return F$(t,i,n.numberOfDoubleDots)}function F$(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new te(4005,!1);i=r.segments.length}return new pa(r,!1,i-o)}function V$(n){return Bu(n[0])?n[0].outlets:{[ge]:n}}function CR(n,e,t){if(n??=new Oe([],{}),n.segments.length===0&&n.hasChildren())return Ou(n,e,t);let r=L$(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new Oe(n.segments.slice(0,r.pathIndex),{});return o.children[ge]=new Oe(n.segments.slice(r.pathIndex),n.children),Ou(o,0,i)}else return r.match&&i.length===0?new Oe(n.segments,{}):r.match&&!n.hasChildren()?Yv(n,e,t):r.match?Ou(n,0,i):Yv(n,e,t)}function Ou(n,e,t){if(t.length===0)return new Oe(n.segments,{});{let r=V$(t),i={};if(Object.keys(r).some(o=>o!==ge)&&n.children[ge]&&n.numberOfChildren===1&&n.children[ge].segments.length===0){let o=Ou(n.children[ge],e,t);return new Oe(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=CR(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new Oe(n.segments,i)}}function L$(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(Bu(a))break;let l=`${a}`,c=r<t.length-1?t[r+1]:null;if(i>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!sR(l,c,s))return o;r+=2}else{if(!sR(l,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Yv(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Bu(o)){let l=j$(o.outlets);return new Oe(r,l)}if(i===0&&qf(t[0])){let l=n.segments[e];r.push(new jo(l.path,oR(t[0]))),i++;continue}let s=Bu(o)?o.outlets[ge]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&qf(a)?(r.push(new jo(s,oR(a))),i+=2):(r.push(new jo(s,{})),i++)}return new Oe(r,{})}function j$(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Yv(new Oe([],{}),0,r))}),e}function oR(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function sR(n,e,t){return n==t.path&&fr(e,t.parameters)}var Fu="imperative",Rt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Rt||{}),Pn=class{id;url;constructor(e,t){this.id=e,this.url=t}},Uu=class extends Pn{type=Rt.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Uo=class extends Pn{urlAfterRedirects;type=Rt.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},yn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(yn||{}),Zv=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Zv||{}),Gr=class extends Pn{reason;code;type=Rt.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},$o=class extends Pn{reason;code;type=Rt.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},$u=class extends Pn{error;target;type=Rt.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},zf=class extends Pn{urlAfterRedirects;state;type=Rt.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Jv=class extends Pn{urlAfterRedirects;state;type=Rt.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Xv=class extends Pn{urlAfterRedirects;state;shouldActivate;type=Rt.GuardsCheckEnd;constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},ew=class extends Pn{urlAfterRedirects;state;type=Rt.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},tw=class extends Pn{urlAfterRedirects;state;type=Rt.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},nw=class{route;type=Rt.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},rw=class{route;type=Rt.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},iw=class{snapshot;type=Rt.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ow=class{snapshot;type=Rt.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},sw=class{snapshot;type=Rt.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},aw=class{snapshot;type=Rt.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Hu=class{},_a=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function B$(n,e){return n.providers&&!n._injector&&(n._injector=Tv(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Wn(n){return n.outlet||ge}function U$(n,e){let t=n.filter(r=>Wn(r)===e);return t.push(...n.filter(r=>Wn(r)!==e)),t}function Qu(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var lw=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Qu(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Xf(this.rootInjector)}},Xf=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new lw(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(j(it))};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Wf=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=uw(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=uw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=cw(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return cw(e,this._root).map(t=>t.value)}};function uw(n,e){if(n===e.value)return e;for(let t of e.children){let r=uw(n,t);if(r)return r}return null}function cw(n,e){if(n===e.value)return[e];for(let t of e.children){let r=cw(n,t);if(r.length)return r.unshift(e),r}return[]}var mn=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function fa(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Kf=class extends Wf{snapshot;constructor(e,t){super(e),this.snapshot=t,ww(this,e)}toString(){return this.snapshot.toString()}};function DR(n){let e=$$(n),t=new bt([new jo("",{})]),r=new bt({}),i=new bt({}),o=new bt({}),s=new bt(""),a=new va(t,r,o,s,i,ge,n,e.root);return a.snapshot=e.root,new Kf(new mn(a,[]),e)}function $$(n){let e={},t={},r={},i="",o=new ga([],e,r,i,t,ge,n,null,{});return new Yf("",new mn(o,[]))}var va=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,o,s,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Z(c=>c[Ku]))??ne(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Z(e=>ya(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Z(e=>ya(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Qf(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:$($({},e.params),n.params),data:$($({},e.data),n.data),resolve:$($($($({},n.data),e.data),i?.data),n._resolvedData)}:r={params:$({},n.params),data:$({},n.data),resolve:$($({},n.data),n._resolvedData??{})},i&&bR(i)&&(r.resolve[Ku]=i.title),r}var ga=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Ku]}constructor(e,t,r,i,o,s,a,l,c){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ya(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ya(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Yf=class extends Wf{url;constructor(e,t){super(t),this.url=e,ww(this,t)}toString(){return TR(this._root)}};function ww(n,e){e.value._routerState=n,e.children.forEach(t=>ww(n,t))}function TR(n){let e=n.children.length>0?` { ${n.children.map(TR).join(", ")} } `:"";return`${n.value}${e}`}function qv(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,fr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),fr(e.params,t.params)||n.paramsSubject.next(t.params),g$(e.url,t.url)||n.urlSubject.next(t.url),fr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function dw(n,e){let t=fr(n.params,e.params)&&v$(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||dw(n.parent,e.parent))}function bR(n){return typeof n.title=="string"||n.title===null}var H$=new z(""),Ew=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=ge;activateEvents=new At;deactivateEvents=new At;attachEvents=new At;detachEvents=new At;routerOutletData=NA(void 0);parentContexts=V(Xf);location=V(Tu);changeDetector=V(Fo);inputBinder=V(Iw,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new te(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new te(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new te(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new te(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new hw(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(s,{index:i.length,injector:l,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Lt({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Iu]})}return n})(),hw=class n{route;childContexts;parent;outletData;__ngOutletInjector(e){return new n(this.route,this.childContexts,e,this.outletData)}constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===va?this.route:e===Xf?this.childContexts:e===H$?this.outletData:this.parent.get(e,t)}},Iw=new z("");function q$(n,e,t){let r=qu(n,e._root,t?t._root:void 0);return new Kf(r,e)}function qu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=G$(n,e,t);return new mn(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>qu(n,a)),s}}let r=z$(e.value),i=e.children.map(o=>qu(n,o));return new mn(r,i)}}function G$(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return qu(n,r,i);return qu(n,r)})}function z$(n){return new va(new bt(n.url),new bt(n.params),new bt(n.queryParams),new bt(n.fragment),new bt(n.data),n.outlet,n.component,n)}var Gu=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},SR="ngNavigationCancelingError";function Zf(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=ju(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=AR(!1,yn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function AR(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[SR]=!0,t.cancellationCode=e,t}function W$(n){return MR(n)&&ju(n.url)}function MR(n){return!!n&&n[SR]}var K$=(n,e,t,r)=>Z(i=>(new fw(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),fw=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),qv(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=fa(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=fa(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=fa(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=fa(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new aw(o.value.snapshot))}),e.children.length&&this.forwardEvent(new ow(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(qv(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),qv(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},Jf=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ma=class{component;route;constructor(e,t){this.component=e,this.route=t}};function Q$(n,e,t){let r=n._root,i=e?e._root:null;return ku(r,i,t,[r.value])}function Y$(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Ea(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!bS(n)?n:e.get(n):r}function ku(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=fa(e);return n.children.forEach(s=>{Z$(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Vu(a,t.getContext(s),i)),i}function Z$(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=J$(s,o,o.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new Jf(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?ku(n,e,a?a.children:null,r,i):ku(n,e,t,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new ma(a.outlet.component,s))}else s&&Vu(e,a,i),i.canActivateChecks.push(new Jf(r)),o.component?ku(n,null,a?a.children:null,r,i):ku(n,null,t,r,i);return i}function J$(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Bo(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Bo(n.url,e.url)||!fr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!dw(n,e)||!fr(n.queryParams,e.queryParams);case"paramsChange":default:return!dw(n,e)}}function Vu(n,e,t){let r=fa(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?Vu(s,e.children.getContext(o),t):Vu(s,null,t):Vu(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new ma(e.outlet.component,i)):t.canDeactivateChecks.push(new ma(null,i)):t.canDeactivateChecks.push(new ma(null,i))}function Yu(n){return typeof n=="function"}function X$(n){return typeof n=="boolean"}function eH(n){return n&&Yu(n.canLoad)}function tH(n){return n&&Yu(n.canActivate)}function nH(n){return n&&Yu(n.canActivateChild)}function rH(n){return n&&Yu(n.canDeactivate)}function iH(n){return n&&Yu(n.canMatch)}function RR(n){return n instanceof Pr||n?.name==="EmptyError"}var Bf=Symbol("INITIAL_VALUE");function wa(){return Qe(n=>xh(n.map(e=>e.pipe(kr(1),Eo(Bf)))).pipe(Z(e=>{for(let t of e)if(t!==!0){if(t===Bf)return Bf;if(t===!1||oH(t))return t}return!0}),Vt(e=>e!==Bf),kr(1)))}function oH(n){return ju(n)||n instanceof Gu}function sH(n,e){return mt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?ne(fe($({},t),{guardsResult:!0})):aH(s,r,i,n).pipe(mt(a=>a&&X$(a)?lH(r,o,n,e):ne(a)),Z(a=>fe($({},t),{guardsResult:a})))})}function aH(n,e,t,r){return Pe(n).pipe(mt(i=>fH(i.component,i.route,t,e,r)),$n(i=>i!==!0,!0))}function lH(n,e,t,r){return Pe(e).pipe($s(i=>Bs(cH(i.route.parent,r),uH(i.route,r),hH(n,i.path,t),dH(n,i.route,t))),$n(i=>i!==!0,!0))}function uH(n,e){return n!==null&&e&&e(new sw(n)),ne(!0)}function cH(n,e){return n!==null&&e&&e(new iw(n)),ne(!0)}function dH(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return ne(!0);let i=r.map(o=>Ph(()=>{let s=Qu(e)??t,a=Ea(o,s),l=tH(a)?a.canActivate(e,n):Rn(s,()=>a(e,n));return Ri(l).pipe($n())}));return ne(i).pipe(wa())}function hH(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>Y$(s)).filter(s=>s!==null).map(s=>Ph(()=>{let a=s.guards.map(l=>{let c=Qu(s.node)??t,d=Ea(l,c),f=nH(d)?d.canActivateChild(r,n):Rn(c,()=>d(r,n));return Ri(f).pipe($n())});return ne(a).pipe(wa())}));return ne(o).pipe(wa())}function fH(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return ne(!0);let s=o.map(a=>{let l=Qu(e)??i,c=Ea(a,l),d=rH(c)?c.canDeactivate(n,e,t,r):Rn(l,()=>c(n,e,t,r));return Ri(d).pipe($n())});return ne(s).pipe(wa())}function pH(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return ne(!0);let o=i.map(s=>{let a=Ea(s,n),l=eH(a)?a.canLoad(e,t):Rn(n,()=>a(e,t));return Ri(l)});return ne(o).pipe(wa(),NR(r))}function NR(n){return Ty(St(e=>{if(typeof e!="boolean")throw Zf(n,e)}),Z(e=>e===!0))}function gH(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return ne(!0);let o=i.map(s=>{let a=Ea(s,n),l=iH(a)?a.canMatch(e,t):Rn(n,()=>a(e,t));return Ri(l)});return ne(o).pipe(wa(),NR(r))}var zu=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},Wu=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function ha(n){return js(new zu(n))}function mH(n){return js(new te(4e3,!1))}function yH(n){return js(AR(!1,yn.GuardRejected))}var pw=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return ne(r);if(i.numberOfChildren>1||!i.children[ge])return mH(`${e.redirectTo}`);i=i.children[ge]}}applyRedirectCommands(e,t,r,i,o){if(typeof t!="string"){let a=t,{queryParams:l,fragment:c,routeConfig:d,url:f,outlet:g,params:m,data:v,title:T}=i,S=Rn(o,()=>a({params:m,data:v,queryParams:l,fragment:c,routeConfig:d,url:f,outlet:g,title:T}));if(S instanceof zr)throw new Wu(S);t=S}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new Wu(s);return s}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new zr(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,r,i)}),new Oe(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new te(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},gw={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function _H(n,e,t,r,i){let o=xR(n,e,t);return o.matched?(r=B$(e,r),gH(r,e,t,i).pipe(Z(s=>s===!0?o:$({},gw)))):ne(o)}function xR(n,e,t){if(e.path==="**")return vH(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?$({},gw):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||p$)(t,n,e);if(!i)return $({},gw);let o={};Object.entries(i.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=i.consumed.length>0?$($({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function vH(n){return{matched:!0,parameters:n.length>0?dR(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function aR(n,e,t,r){return t.length>0&&IH(n,t,r)?{segmentGroup:new Oe(e,EH(r,new Oe(t,n.children))),slicedSegments:[]}:t.length===0&&CH(n,t,r)?{segmentGroup:new Oe(n.segments,wH(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Oe(n.segments,n.children),slicedSegments:t}}function wH(n,e,t,r){let i={};for(let o of t)if(ep(n,e,o)&&!r[Wn(o)]){let s=new Oe([],{});i[Wn(o)]=s}return $($({},r),i)}function EH(n,e){let t={};t[ge]=e;for(let r of n)if(r.path===""&&Wn(r)!==ge){let i=new Oe([],{});t[Wn(r)]=i}return t}function IH(n,e,t){return t.some(r=>ep(n,e,r)&&Wn(r)!==ge)}function CH(n,e,t){return t.some(r=>ep(n,e,r))}function ep(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function DH(n,e,t){return e.length===0&&!n.children[t]}var mw=class{};function TH(n,e,t,r,i,o,s="emptyOnly"){return new yw(n,e,t,r,i,s,o).recognize()}var bH=31,yw=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new pw(this.urlSerializer,this.urlTree)}noMatchError(e){return new te(4002,`'${e.segmentGroup}'`)}recognize(){let e=aR(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Z(({children:t,rootSnapshot:r})=>{let i=new mn(r,t),o=new Yf("",i),s=P$(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new ga([],Object.freeze({}),Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ge,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,ge,t).pipe(Z(r=>({children:r,rootSnapshot:t})),fi(r=>{if(r instanceof Wu)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof zu?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(Z(s=>s instanceof mn?[s]:[]))}processChildren(e,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return Pe(o).pipe($s(s=>{let a=r.children[s],l=U$(t,s);return this.processSegmentGroup(e,l,a,s,i)}),sr((s,a)=>(s.push(...a),s)),pi(null),Py(),mt(s=>{if(s===null)return ha(r);let a=PR(s);return SH(a),ne(a)}))}processSegment(e,t,r,i,o,s,a){return Pe(t).pipe($s(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,r,i,o,s,a).pipe(fi(c=>{if(c instanceof zu)return ne(null);throw c}))),$n(l=>!!l),fi(l=>{if(RR(l))return DH(r,i,o)?ne(new mw):ha(r);throw l}))}processSegmentAgainstRoute(e,t,r,i,o,s,a,l){return Wn(r)!==s&&(s===ge||!ep(i,o,r))?ha(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s,l):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,l):ha(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:l,parameters:c,consumedSegments:d,positionalParamSegments:f,remainingSegments:g}=xR(t,i,o);if(!l)return ha(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>bH&&(this.allowRedirects=!1));let m=new ga(o,c,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,lR(i),Wn(i),i.component??i._loadedComponent??null,i,uR(i)),v=Qf(m,a,this.paramsInheritanceStrategy);m.params=Object.freeze(v.params),m.data=Object.freeze(v.data);let T=this.applyRedirects.applyRedirectCommands(d,i.redirectTo,f,m,e);return this.applyRedirects.lineralizeSegments(i,T).pipe(mt(S=>this.processSegment(e,r,t,S.concat(g),s,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,o,s){let a=_H(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(Qe(l=>l.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Qe(({routes:c})=>{let d=r._loadedInjector??e,{parameters:f,consumedSegments:g,remainingSegments:m}=l,v=new ga(g,f,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,lR(r),Wn(r),r.component??r._loadedComponent??null,r,uR(r)),T=Qf(v,s,this.paramsInheritanceStrategy);v.params=Object.freeze(T.params),v.data=Object.freeze(T.data);let{segmentGroup:S,slicedSegments:O}=aR(t,g,m,c);if(O.length===0&&S.hasChildren())return this.processChildren(d,c,S,v).pipe(Z(F=>new mn(v,F)));if(c.length===0&&O.length===0)return ne(new mn(v,[]));let B=Wn(r)===o;return this.processSegment(d,c,S,O,B?ge:o,!0,v).pipe(Z(F=>new mn(v,F instanceof mn?[F]:[])))}))):ha(t)))}getChildConfig(e,t,r){return t.children?ne({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?ne({routes:t._loadedRoutes,injector:t._loadedInjector}):pH(e,t,r,this.urlSerializer).pipe(mt(i=>i?this.configLoader.loadChildren(e,t).pipe(St(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):yH(t))):ne({routes:[],injector:e})}};function SH(n){n.sort((e,t)=>e.value.outlet===ge?-1:t.value.outlet===ge?1:e.value.outlet.localeCompare(t.value.outlet))}function AH(n){let e=n.value.routeConfig;return e&&e.path===""}function PR(n){let e=[],t=new Set;for(let r of n){if(!AH(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=PR(r.children);e.push(new mn(r.value,i))}return e.filter(r=>!t.has(r))}function lR(n){return n.data||{}}function uR(n){return n.resolve||{}}function MH(n,e,t,r,i,o){return mt(s=>TH(n,e,t,r,s.extractedUrl,i,o).pipe(Z(({state:a,tree:l})=>fe($({},s),{targetSnapshot:a,urlAfterRedirects:l}))))}function RH(n,e){return mt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return ne(t);let o=new Set(i.map(l=>l.route)),s=new Set;for(let l of o)if(!s.has(l))for(let c of kR(l))s.add(c);let a=0;return Pe(s).pipe($s(l=>o.has(l)?NH(l,r,n,e):(l.data=Qf(l,l.parent,n).resolve,ne(void 0))),St(()=>a++),Hs(1),mt(l=>a===s.size?ne(t):Gt))})}function kR(n){let e=n.children.map(t=>kR(t)).flat();return[n,...e]}function NH(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!bR(i)&&(o[Ku]=i.title),xH(o,n,e,r).pipe(Z(s=>(n._resolvedData=s,n.data=Qf(n,n.parent,t).resolve,null)))}function xH(n,e,t,r){let i=Wv(n);if(i.length===0)return ne({});let o={};return Pe(i).pipe(mt(s=>PH(n[s],e,t,r).pipe($n(),St(a=>{if(a instanceof Gu)throw Zf(new Lu,a);o[s]=a}))),Hs(1),Z(()=>o),fi(s=>RR(s)?Gt:js(s)))}function PH(n,e,t,r){let i=Qu(e)??r,o=Ea(n,i),s=o.resolve?o.resolve(e,t):Rn(i,()=>o(e,t));return Ri(s)}function Gv(n){return Qe(e=>{let t=n(e);return t?Pe(t).pipe(Z(()=>e)):ne(e)})}var OR=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===ge);return r}getResolvedTitleForRoute(t){return t.data[Ku]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>V(kH),providedIn:"root"})}return n})(),kH=(()=>{class n extends OR{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(j(nR))};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Cw=new z("",{providedIn:"root",factory:()=>({})}),OH=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=ca({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&ko(0,"router-outlet")},dependencies:[Ew],encapsulation:2})}return n})();function Dw(n){let e=n.children&&n.children.map(Dw),t=e?fe($({},n),{children:e}):$({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ge&&(t.component=OH),t}var Tw=new z(""),FH=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=V(Rv);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return ne(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=Ri(t.loadComponent()).pipe(Z(FR),St(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),su(()=>{this.componentLoaders.delete(t)})),i=new ks(r,()=>new Ge).pipe(Ps());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return ne({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=VH(r,this.compiler,t,this.onLoadEndListener).pipe(su(()=>{this.childrenLoaders.delete(r)})),s=new ks(o,()=>new Ge).pipe(Ps());return this.childrenLoaders.set(r,s),s}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function VH(n,e,t,r){return Ri(n.loadChildren()).pipe(Z(FR),mt(i=>i instanceof yu||Array.isArray(i)?ne(i):Pe(e.compileModuleAsync(i))),Z(i=>{r&&r(n);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(Tw,[],{optional:!0,self:!0}).flat()),{routes:s.map(Dw),injector:o}}))}function LH(n){return n&&typeof n=="object"&&"default"in n}function FR(n){return LH(n)?n.default:n}var bw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>V(jH),providedIn:"root"})}return n})(),jH=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),BH=new z("");var UH=new z(""),$H=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new Ge;transitionAbortSubject=new Ge;configLoader=V(FH);environmentInjector=V(it);urlSerializer=V(vw);rootContexts=V(Xf);location=V(Au);inputBindingEnabled=V(Iw,{optional:!0})!==null;titleStrategy=V(OR);options=V(Cw,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=V(bw);createViewTransition=V(BH,{optional:!0});navigationErrorHandler=V(UH,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>ne(void 0);rootComponentType=null;constructor(){let t=i=>this.events.next(new nw(i)),r=i=>this.events.next(new rw(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(fe($($({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new bt({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Fu,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Vt(o=>o.id!==0),Z(o=>fe($({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Qe(o=>{let s=!1,a=!1;return ne(o).pipe(Qe(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",yn.SupersededByNewNavigation),Gt;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?fe($({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=l.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&d!=="reload"){let f="";return this.events.next(new $o(l.id,this.urlSerializer.serialize(l.rawUrl),f,Zv.IgnoredSameUrlNavigation)),l.resolve(!1),Gt}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return ne(l).pipe(Qe(f=>{let g=this.transitions?.getValue();return this.events.next(new Uu(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),g!==this.transitions?.getValue()?Gt:Promise.resolve(f)}),MH(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),St(f=>{o.targetSnapshot=f.targetSnapshot,o.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation=fe($({},this.currentNavigation),{finalUrl:f.urlAfterRedirects});let g=new zf(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(g)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:f,extractedUrl:g,source:m,restoredState:v,extras:T}=l,S=new Uu(f,this.urlSerializer.serialize(g),m,v);this.events.next(S);let O=DR(this.rootComponentType).snapshot;return this.currentTransition=o=fe($({},l),{targetSnapshot:O,urlAfterRedirects:g,extras:fe($({},T),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=g,ne(o)}else{let f="";return this.events.next(new $o(l.id,this.urlSerializer.serialize(l.extractedUrl),f,Zv.IgnoredByUrlHandlingStrategy)),l.resolve(!1),Gt}}),St(l=>{let c=new Jv(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),Z(l=>(this.currentTransition=o=fe($({},l),{guards:Q$(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),sH(this.environmentInjector,l=>this.events.next(l)),St(l=>{if(o.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw Zf(this.urlSerializer,l.guardsResult);let c=new Xv(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),Vt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",yn.GuardRejected),!1)),Gv(l=>{if(l.guards.canActivateChecks.length)return ne(l).pipe(St(c=>{let d=new ew(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}),Qe(c=>{let d=!1;return ne(c).pipe(RH(this.paramsInheritanceStrategy,this.environmentInjector),St({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(c,"",yn.NoDataFromResolver)}}))}),St(c=>{let d=new tw(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}))}),Gv(l=>{let c=d=>{let f=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(d.routeConfig).pipe(St(g=>{d.component=g}),Z(()=>{})));for(let g of d.children)f.push(...c(g));return f};return xh(c(l.targetSnapshot.root)).pipe(pi(null),kr(1))}),Gv(()=>this.afterPreactivation()),Qe(()=>{let{currentSnapshot:l,targetSnapshot:c}=o,d=this.createViewTransition?.(this.environmentInjector,l.root,c.root);return d?Pe(d).pipe(Z(()=>o)):ne(o)}),Z(l=>{let c=q$(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=fe($({},l),{targetRouterState:c}),this.currentNavigation.targetRouterState=c,o}),St(()=>{this.events.next(new Hu)}),K$(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),kr(1),St({next:l=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Uo(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{s=!0}}),Fy(this.transitionAbortSubject.pipe(St(l=>{throw l}))),su(()=>{!s&&!a&&this.cancelNavigationTransition(o,"",yn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),fi(l=>{if(a=!0,MR(l))this.events.next(new Gr(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),W$(l)?this.events.next(new _a(l.url,l.navigationBehaviorOptions)):o.resolve(!1);else{let c=new $u(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0);try{let d=Rn(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(d instanceof Gu){let{message:f,cancellationCode:g}=Zf(this.urlSerializer,d);this.events.next(new Gr(o.id,this.urlSerializer.serialize(o.extractedUrl),f,g)),this.events.next(new _a(d.redirectTo,d.navigationBehaviorOptions))}else throw this.events.next(c),l}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return Gt}))}))}cancelNavigationTransition(t,r,i){let o=new Gr(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function HH(n){return n!==Fu}var qH=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>V(GH),providedIn:"root"})}return n})(),_w=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},GH=(()=>{class n extends _w{static \u0275fac=(()=>{let t;return function(i){return(t||(t=bi(n)))(i||n)}})();static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),VR=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>V(zH),providedIn:"root"})}return n})(),zH=(()=>{class n extends VR{location=V(Au);urlSerializer=V(vw);options=V(Cw,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=V(bw);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new zr;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=DR(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof Uu)this.stateMemento=this.createStateMemento();else if(t instanceof $o)this.rawUrlTree=r.initialUrl;else if(t instanceof zf){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof Hu?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof Gr&&(t.code===yn.GuardRejected||t.code===yn.NoDataFromResolver)?this.restoreHistory(r):t instanceof $u?this.restoreHistory(r,!0):t instanceof Uo&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof zr?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let o=this.browserPageId,s=$($({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(i,"",s)}else{let o=$($({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===t.finalUrl&&o===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=bi(n)))(i||n)}})();static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function WH(n,e){n.events.pipe(Vt(t=>t instanceof Uo||t instanceof Gr||t instanceof $u||t instanceof $o),Z(t=>t instanceof Uo||t instanceof $o?0:(t instanceof Gr?t.code===yn.Redirect||t.code===yn.SupersededByNewNavigation:!1)?2:1),Vt(t=>t!==2),kr(1)).subscribe(()=>{e()})}var KH={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},QH={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},LR=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=V(bv);stateManager=V(VR);options=V(Cw,{optional:!0})||{};pendingTasks=V(No);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=V($H);urlSerializer=V(vw);location=V(Au);urlHandlingStrategy=V(bw);_events=new Ge;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=V(qH);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=V(Tw,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!V(Iw,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new tt;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof Gr&&r.code!==yn.Redirect&&r.code!==yn.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Uo)this.navigated=!0;else if(r instanceof _a){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),l=$({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||HH(i.source)},s);this.scheduleNavigation(a,Fu,null,l,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}ZH(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Fu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let l=$({},i);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Dw),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=r,c=l?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=$($({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let f;try{let g=i?i.snapshot:this.routerState.snapshot.root;f=wR(g)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),f=this.currentUrlTree.root}return ER(f,t,d,c??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=ju(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,Fu,null,r)}navigate(t,r={skipLocationChange:!1}){return YH(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=$({},KH):r===!1?i=$({},QH):i=r,ju(t))return rR(this.currentUrlTree,t,i);let o=this.parseUrl(t);return rR(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,c;s?(a=s.resolve,l=s.reject,c=s.promise):c=new Promise((f,g)=>{a=f,l=g});let d=this.pendingTasks.add();return WH(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(f=>Promise.reject(f))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function YH(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new te(4008,!1)}function ZH(n){return!(n instanceof Hu)&&!(n instanceof _a)}var JH=new z("");function jR(n,...e){return H_([{provide:Tw,multi:!0,useValue:n},[],{provide:va,useFactory:XH,deps:[LR]},{provide:Sv,multi:!0,useFactory:eq},e.map(t=>t.\u0275providers)])}function XH(n){return n.routerState.root}function eq(){let n=V(hn);return e=>{let t=n.get(Ci);if(e!==t.components[0])return;let r=n.get(LR),i=n.get(tq);n.get(nq)===1&&r.initialNavigation(),n.get(rq,null,me.Optional)?.setUpPreloading(),n.get(JH,null,me.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var tq=new z("",{factory:()=>new Ge}),nq=new z("",{providedIn:"root",factory:()=>1});var rq=new z("");var KR=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(ke(Br),ke(hr))};static \u0275dir=Lt({type:n})}return n})(),op=(()=>{class n extends KR{static \u0275fac=(()=>{let t;return function(i){return(t||(t=bi(n)))(i||n)}})();static \u0275dir=Lt({type:n,features:[Ur]})}return n})(),nc=new z("");var iq={provide:nc,useExisting:Di(()=>sp),multi:!0};function oq(){let n=qr()?qr().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var sq=new z(""),sp=(()=>{class n extends KR{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!oq())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(ke(Br),ke(hr),ke(sq,8))};static \u0275dir=Lt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&Mt("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},standalone:!1,features:[da([iq]),Ur]})}return n})();var aq=new z(""),lq=new z("");function QR(n){return n!=null}function YR(n){return Po(n)?Pe(n):n}function ZR(n){let e={};return n.forEach(t=>{e=t!=null?$($({},e),t):e}),Object.keys(e).length===0?null:e}function JR(n,e){return e.map(t=>t(n))}function uq(n){return!n.validate}function XR(n){return n.map(e=>uq(e)?e:t=>e.validate(t))}function cq(n){if(!n)return null;let e=n.filter(QR);return e.length==0?null:function(t){return ZR(JR(t,e))}}function eN(n){return n!=null?cq(XR(n)):null}function dq(n){if(!n)return null;let e=n.filter(QR);return e.length==0?null:function(t){let r=JR(t,e).map(YR);return xy(r).pipe(Z(ZR))}}function tN(n){return n!=null?dq(XR(n)):null}function BR(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function hq(n){return n._rawValidators}function fq(n){return n._rawAsyncValidators}function Sw(n){return n?Array.isArray(n)?n:[n]:[]}function np(n,e){return Array.isArray(n)?n.includes(e):n===e}function UR(n,e){let t=Sw(e);return Sw(n).forEach(i=>{np(t,i)||t.push(i)}),t}function $R(n,e){return Sw(e).filter(t=>!np(n,t))}var rp=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=eN(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=tN(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Aw=class extends rp{name;get formDirective(){return null}get path(){return null}},tc=class extends rp{_parent=null;name=null;valueAccessor=null},Mw=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},pq={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},FJ=fe($({},pq),{"[class.ng-submitted]":"isSubmitted"}),nN=(()=>{class n extends Mw{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(ke(tc,2))};static \u0275dir=Lt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Av("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Ur]})}return n})();var Zu="VALID",tp="INVALID",Ia="PENDING",Ju="DISABLED",Da=class{},ip=class extends Da{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Xu=class extends Da{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},ec=class extends Da{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Ca=class extends Da{status;source;constructor(e,t){super(),this.status=e,this.source=t}};function gq(n){return(ap(n)?n.validators:n)||null}function mq(n){return Array.isArray(n)?eN(n):n||null}function yq(n,e){return(ap(e)?e.asyncValidators:n)||null}function _q(n){return Array.isArray(n)?tN(n):n||null}function ap(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var Rw=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Hr(this.statusReactive)}set status(e){Hr(()=>this.statusReactive.set(e))}_status=Su(()=>this.statusReactive());statusReactive=Du(void 0);get valid(){return this.status===Zu}get invalid(){return this.status===tp}get pending(){return this.status==Ia}get disabled(){return this.status===Ju}get enabled(){return this.status!==Ju}errors;get pristine(){return Hr(this.pristineReactive)}set pristine(e){Hr(()=>this.pristineReactive.set(e))}_pristine=Su(()=>this.pristineReactive());pristineReactive=Du(!0);get dirty(){return!this.pristine}get touched(){return Hr(this.touchedReactive)}set touched(e){Hr(()=>this.touchedReactive.set(e))}_touched=Su(()=>this.touchedReactive());touchedReactive=Du(!1);get untouched(){return!this.touched}_events=new Ge;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(UR(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(UR(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators($R(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators($R(e,this._rawAsyncValidators))}hasValidator(e){return np(this._rawValidators,e)}hasAsyncValidator(e){return np(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(fe($({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new ec(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new ec(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(fe($({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Xu(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Xu(!0,r))}markAsPending(e={}){this.status=Ia;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ca(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(fe($({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Ju,this.errors=null,this._forEachChild(i=>{i.disable(fe($({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ip(this.value,r)),this._events.next(new Ca(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(fe($({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Zu,this._forEachChild(r=>{r.enable(fe($({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(fe($({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Zu||this.status===Ia)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ip(this.value,t)),this._events.next(new Ca(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(fe($({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ju:Zu}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Ia,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=YR(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Ca(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new At,this.statusChanges=new At}_calculateStatus(){return this._allControlsDisabled()?Ju:this.errors?tp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ia)?Ia:this._anyControlsHaveStatus(tp)?tp:Zu}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Xu(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new ec(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){ap(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=mq(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=_q(this._rawAsyncValidators)}};var rN=new z("",{providedIn:"root",factory:()=>Nw}),Nw="always";function vq(n,e){return[...e.path,n]}function wq(n,e,t=Nw){Iq(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),Cq(n,e),Tq(n,e),Dq(n,e),Eq(n,e)}function HR(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function Eq(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Iq(n,e){let t=hq(n);e.validator!==null?n.setValidators(BR(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=fq(n);e.asyncValidator!==null?n.setAsyncValidators(BR(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();HR(e._rawValidators,i),HR(e._rawAsyncValidators,i)}function Cq(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&iN(n,e)})}function Dq(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&iN(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function iN(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function Tq(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function bq(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function Sq(n){return Object.getPrototypeOf(n.constructor)===op}function Aq(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===sp?t=o:Sq(o)?r=o:i=o}),i||r||t||null}function qR(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function GR(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Mq=class extends Rw{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(gq(t),yq(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ap(t)&&(t.nonNullable||t.initialValueIsDefault)&&(GR(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){qR(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){qR(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){GR(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Rq={provide:tc,useExisting:Di(()=>xw)},zR=Promise.resolve(),xw=(()=>{class n extends tc{_changeDetectorRef;callSetDisabledState;control=new Mq;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new At;constructor(t,r,i,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=Aq(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),bq(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){wq(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){zR.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&xf(r);zR.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?vq(t,this._parent):[t]}static \u0275fac=function(r){return new(r||n)(ke(Aw,9),ke(aq,10),ke(lq,10),ke(nc,10),ke(Fo,8),ke(rN,8))};static \u0275dir=Lt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[da([Rq]),Ur,Iu]})}return n})();var Nq={provide:nc,useExisting:Di(()=>Pw),multi:!0},Pw=(()=>{class n extends op{writeValue(t){let r=t??"";this.setProperty("value",r)}registerOnChange(t){this.onChange=r=>{t(r==""?null:parseFloat(r))}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=bi(n)))(i||n)}})();static \u0275dir=Lt({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,i){r&1&&Mt("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},standalone:!1,features:[da([Nq]),Ur]})}return n})();var xq={provide:nc,useExisting:Di(()=>lp),multi:!0};function oN(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function Pq(n){return n.split(":")[0]}var lp=(()=>{class n extends op{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r=this._getOptionId(t),i=oN(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=Pq(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=bi(n)))(i||n)}})();static \u0275dir=Lt({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&Mt("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[da([xq]),Ur]})}return n})(),sN=(()=>{class n{_element;_renderer;_select;id;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(oN(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(ke(hr),ke(Br),ke(lp,9))};static \u0275dir=Lt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),kq={provide:nc,useExisting:Di(()=>aN),multi:!0};function WR(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function Oq(n){return n.split(":")[0]}var aN=(()=>{class n extends op{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(o=>this._getOptionId(o));r=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],o=r.selectedOptions;if(o!==void 0){let s=o;for(let a=0;a<s.length;a++){let l=s[a],c=this._getOptionValue(l.value);i.push(c)}}else{let s=r.options;for(let a=0;a<s.length;a++){let l=s[a];if(l.selected){let c=this._getOptionValue(l.value);i.push(c)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=Oq(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=bi(n)))(i||n)}})();static \u0275dir=Lt({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&Mt("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[da([kq]),Ur]})}return n})(),lN=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(WR(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(WR(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(ke(hr),ke(Br),ke(aN,9))};static \u0275dir=Lt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();var Fq=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=gn({type:n});static \u0275inj=fn({})}return n})();var uN=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:rN,useValue:t.callSetDisabledState??Nw}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=gn({type:n});static \u0275inj=fn({imports:[Fq]})}return n})();var Lq="firebase",jq="11.2.0";Bn(Lq,jq,"app");function nt(n){n===void 0&&(zS(nt),n=V(hn));let e=n.get(sv);return t=>new pe(r=>{let i=e.add(),o=!1;function s(){o||(i(),o=!0)}let a=t.subscribe({next:l=>{r.next(l),s()},complete:()=>{r.complete(),s()},error:l=>{r.error(l),s()}});return a.add(()=>{r.unsubscribe(),s()}),a})}var Ta=new Vr("ANGULARFIRE2_VERSION");var cN=(n,e)=>{let t=e?[e]:r0(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},kw=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(kw||{}),tX=bu()&&typeof Zone<"u"?kw.WARN:kw.SILENT;var up=class{zone;delegate;constructor(e,t=My){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i?i.runGuarded(()=>{e.apply(this,[s])}):e.apply(this,[s])};return this.delegate.schedule(o,t,r)}},Ho=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=V(De);this.outsideAngular=t.runOutsideAngular(()=>new up(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new up(typeof Zone>"u"?void 0:Zone.current,wo))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Bq=new Map,Uq={activated:!1,tokenObservers:[]},$q={initialized:!1,enabled:!1};function Kn(n){return Bq.get(n)||Object.assign({},Uq)}function yN(){return $q}var Hq="https://content-firebaseappcheck.googleapis.com/v1";var qq="exchangeDebugToken",dN={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},uX=24*60*60*1e3;var Vw=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return N(this,null,function*(){this.stop();try{this.pending=new wt,this.pending.promise.catch(t=>{}),yield Gq(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new wt,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function Gq(n){return new Promise(e=>{setTimeout(e,n)})}var zq={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Ni=new Zb("appCheck","AppCheck",zq);function _N(n){if(!Kn(n).activated)throw Ni.create("use-before-activation",{appName:n.name})}function vN(r,i){return N(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let m=yield s.getHeartbeatsHeader();m&&(o["X-Firebase-Client"]=m)}let a={method:"POST",body:JSON.stringify(e),headers:o},l;try{l=yield fetch(n,a)}catch(m){throw Ni.create("fetch-network-error",{originalErrorMessage:m?.message})}if(l.status!==200)throw Ni.create("fetch-status-error",{httpStatus:l.status});let c;try{c=yield l.json()}catch(m){throw Ni.create("fetch-parse-error",{originalErrorMessage:m?.message})}let d=c.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw Ni.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let f=Number(d[1])*1e3,g=Date.now();return{token:c.token,expireTimeMillis:g+f,issuedAtTimeMillis:g}})}function wN(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${Hq}/projects/${t}/apps/${r}:${qq}?key=${i}`,body:{debug_token:e}}}var Wq="firebase-app-check-database",Kq=1,Lw="firebase-app-check-store";var cp=null;function Qq(){return cp||(cp=new Promise((n,e)=>{try{let t=indexedDB.open(Wq,Kq);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Ni.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Lw,{keyPath:"compositeKey"})}}}catch(t){e(Ni.create("storage-open",{originalErrorMessage:t?.message}))}}),cp)}function Yq(n,e){return Zq(Jq(n),e)}function Zq(n,e){return N(this,null,function*(){let r=(yield Qq()).transaction(Lw,"readwrite"),o=r.objectStore(Lw).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=l=>{s()},r.onerror=l=>{var c;a(Ni.create("storage-set",{originalErrorMessage:(c=l.target.error)===null||c===void 0?void 0:c.message}))}})})}function Jq(n){return`${n.options.appId}-${n.name}`}var jw=new hi("@firebase/app-check");function Fw(n,e){return Xd()?Yq(n,e).catch(t=>{jw.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function EN(){return yN().enabled}function IN(){return N(this,null,function*(){let n=yN();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Xq={error:"UNKNOWN_ERROR"};function eG(n){return Zd.encodeString(JSON.stringify(n),!1)}function Bw(n,e=!1){return N(this,null,function*(){let t=n.app;_N(t);let r=Kn(t),i=r.token,o;if(i&&!rc(i)&&(r.token=void 0,i=void 0),!i){let l=yield r.cachedTokenPromise;l&&(rc(l)?i=l:yield Fw(t,void 0))}if(!e&&i&&rc(i))return{token:i.token};let s=!1;if(EN()){r.exchangeTokenPromise||(r.exchangeTokenPromise=vN(wN(t,yield IN()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),s=!0);let l=yield r.exchangeTokenPromise;return yield Fw(t,l),r.token=l,{token:l.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),s=!0),i=yield Kn(t).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"?jw.warn(l.message):jw.error(l),o=l}let a;return i?o?rc(i)?a={token:i.token,internalError:o}:a=fN(o):(a={token:i.token},r.token=i,yield Fw(t,i)):a=fN(o),s&&iG(t,a),a})}function tG(n){return N(this,null,function*(){let e=n.app;_N(e);let{provider:t}=Kn(e);if(EN()){let r=yield IN(),{token:i}=yield vN(wN(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function nG(n,e,t,r){let{app:i}=n,o=Kn(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&rc(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),hN(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>hN(n))}function CN(n,e){let t=Kn(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function hN(n){let{app:e}=n,t=Kn(e),r=t.tokenRefresher;r||(r=rG(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function rG(n){let{app:e}=n;return new Vw(()=>N(this,null,function*(){let t=Kn(e),r;if(t.token?r=yield Bw(n,!0):r=yield Bw(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Kn(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},dN.RETRIAL_MIN_WAIT,dN.RETRIAL_MAX_WAIT)}function iG(n,e){let t=Kn(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function rc(n){return n.expireTimeMillis-Date.now()>0}function fN(n){return{token:eG(Xq),error:n}}var Uw=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Kn(this.app);for(let t of e)CN(this.app,t.next);return Promise.resolve()}};function oG(n,e){return new Uw(n,e)}function sG(n){return{getToken:e=>Bw(n,e),getLimitedUseToken:()=>tG(n),addTokenListener:e=>nG(n,"INTERNAL",e),removeTokenListener:e=>CN(n.app,e)}}var aG="@firebase/app-check",lG="0.8.11";var uG="app-check",pN="app-check-internal";function cG(){go(new un(uG,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return oG(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(pN).initialize()})),go(new un(pN,n=>{let e=n.getProvider("app-check").getImmediate();return sG(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Bn(aG,lG)}cG();var dG="app-check";var xi=class{constructor(){return cN(dG)}};var hG=["localhost","0.0.0.0","127.0.0.1"],DX=typeof window<"u"&&hG.includes(window.location.hostname);var fG="firebase",pG="11.2.0";Dt.registerVersion(fG,pG,"app-compat");var gG=["ngOnDestroy"],TN=(n,e,t,r={})=>new Proxy(n,{get:(i,o)=>t.runOutsideAngular(()=>{if(n[o])return r?.spy?.get&&r.spy.get(o,n[o]),n[o];if(gG.indexOf(o)>-1)return()=>{};let s=e.toPromise().then(a=>{let l=a?.[o];return typeof l=="function"?l.bind(a):l?.then?l.then(c=>t.run(()=>c)):t.run(()=>l)});return new Proxy(()=>{},{get:(a,l)=>s[l],apply:(a,l,c)=>s.then(d=>{let f=d?.(...c);return r?.spy?.apply&&r.spy.apply(o,c,f),f})})})});var dp=class{constructor(e){return e}},Pi=new z("angularfire2.app.options"),ki=new z("angularfire2.app.name");function qo(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let s=Dt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Dt.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(s.options)){let a=!!module.hot;mG("error",`${s.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new dp(s)}var mG=(n,...e)=>{bu()&&typeof console<"u"&&console[n](...e)},yG={provide:dp,useFactory:qo,deps:[Pi,De,[new yf,ki]]},bN=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:Pi,useValue:t},{provide:ki,useValue:r}]}}constructor(t){Dt.registerVersion("angularfire",Ta.full,"core"),Dt.registerVersion("angularfire",Ta.full,"app-compat"),Dt.registerVersion("angular",NM.full,t.toString())}static \u0275fac=function(r){return new(r||n)(j(on))};static \u0275mod=gn({type:n});static \u0275inj=fn({providers:[yG]})}return n})();function ba(n,e,t,r,i){let[,o,s]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(o)return _G(i,s)||(DN("error",`${e} was already initialized on the ${t} Firebase App with different settings.${vG?" You may need to reload as Firebase is not HMR aware.":""}`),DN("warn",{is:i,was:s})),o;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function _G(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var vG=typeof module<"u"&&!!module.hot,DN=(n,...e)=>{bu()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var ic=new z("angularfire2.auth.use-emulator"),oc=new z("angularfire2.auth.settings"),sc=new z("angularfire2.auth.tenant-id"),ac=new z("angularfire2.auth.langugage-code"),lc=new z("angularfire2.auth.use-device-language"),uc=new z("angularfire.auth.persistence"),cc=(n,e,t,r,i,o,s,a)=>ba(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let l=e.runOutsideAngular(()=>n.auth());if(t&&l.useEmulator(...t),r&&(l.tenantId=r),l.languageCode=i,o&&l.useDeviceLanguage(),s)for(let[c,d]of Object.entries(s))l.settings[c]=d;return a&&l.setPersistence(a),l},[t,r,i,o,s,a]),dc=(()=>{class n{injector=V(it);authState;idToken;user;idTokenResult;credential;constructor(t,r,i,o,s,a,l,c,d,f,g,m){let v=new Ge,T=ne(void 0).pipe(or(s.outsideAngular),Qe(()=>o.runOutsideAngular(()=>import("./chunk-VTHNAWUC.js"))),Z(()=>qo(t,o,r)),Z(S=>cc(S,o,a,c,d,f,l,g)),Oh({bufferSize:1,refCount:!1}));if(Lo(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=ne(null);else{T.pipe($n()).subscribe();let S=T.pipe(Qe(F=>F.getRedirectResult().then(W=>W,()=>null)),nt(this.injector),Oh({bufferSize:1,refCount:!1})),O=T.pipe(Qe(F=>new pe(W=>({unsubscribe:o.runOutsideAngular(()=>F.onAuthStateChanged(oe=>W.next(oe),oe=>W.error(oe),()=>W.complete()))})))),B=T.pipe(Qe(F=>new pe(W=>({unsubscribe:o.runOutsideAngular(()=>F.onIdTokenChanged(oe=>W.next(oe),oe=>W.error(oe),()=>W.complete()))}))));this.authState=S.pipe(Fh(O),xr(s.outsideAngular),or(s.insideAngular)),this.user=S.pipe(Fh(B),xr(s.outsideAngular),or(s.insideAngular)),this.idToken=this.user.pipe(Qe(F=>F?Pe(F.getIdToken()):ne(null))),this.idTokenResult=this.user.pipe(Qe(F=>F?Pe(F.getIdTokenResult()):ne(null))),this.credential=Us(S,v,this.authState.pipe(Vt(F=>!F))).pipe(Z(F=>F?.user?F:null),xr(s.outsideAngular),or(s.insideAngular))}return TN(this,T,o,{spy:{apply:(S,O,B)=>{(S.startsWith("signIn")||S.startsWith("createUser"))&&B.then(F=>v.next(F))}}})}static \u0275fac=function(r){return new(r||n)(j(Pi),j(ki,8),j(on),j(De),j(Ho),j(ic,8),j(oc,8),j(sc,8),j(ac,8),j(lc,8),j(uc,8),j(xi,8))};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),SN=(()=>{class n{constructor(){Dt.registerVersion("angularfire",Ta.full,"auth-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=gn({type:n});static \u0275inj=fn({providers:[dc]})}return n})();var MN="@firebase/database",RN="1.0.11";var eI="";function tI(n){eI=n}var Yw=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ut(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:eh(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var Zw=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Dn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var ax=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Yw(e)}}catch{}return new Zw},zo=ax("localStorage"),Jw=ax("sessionStorage");var Ra=new hi("@firebase/database"),lx=function(){let n=1;return function(){return n++}}(),ux=function(n){let e=n0(n),t=new t0;t.update(e);let r=t.digest();return Zd.encodeByteArray(r)},Oc=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Oc.apply(null,r):typeof r=="object"?e+=ut(r):e+=r,e+=" "}return e},Wo=null,NN=!0,cx=function(n,e){L(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Ra.logLevel=Tn.VERBOSE,Wo=Ra.log.bind(Ra),e&&Jw.set("logging_enabled",!0)):typeof n=="function"?Wo=n:(Wo=null,Jw.remove("logging_enabled"))},Et=function(...n){if(NN===!0&&(NN=!1,Wo===null&&Jw.get("logging_enabled")===!0&&cx(!0)),Wo){let e=Oc.apply(null,n);Wo(e)}},Fc=function(n){return function(...e){Et(n,...e)}},Xw=function(...n){let e="FIREBASE INTERNAL ERROR: "+Oc(...n);Ra.error(e)},mr=function(...n){let e=`FIREBASE FATAL ERROR: ${Oc(...n)}`;throw Ra.error(e),new Error(e)},jt=function(...n){let e="FIREBASE WARNING: "+Oc(...n);Ra.warn(e)},EG=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&jt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},jp=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},IG=function(n){if(rr()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Li="[MIN_NAME]",Wr="[MAX_NAME]",Qo=function(n,e){if(n===e)return 0;if(n===Li||e===Wr)return-1;if(e===Li||n===Wr)return 1;{let t=xN(n),r=xN(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},CG=function(n,e){return n===e?0:n<e?-1:1},hc=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+ut(e))},nI=function(n){if(typeof n!="object"||n===null)return ut(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=ut(e[r]),t+=":",t+=nI(n[e[r]]);return t+="}",t},dx=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function It(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var hx=function(n){L(!jp(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,o,s,a,l;n===0?(o=0,s=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),o=a+r,s=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(o=0,s=Math.round(n/Math.pow(2,1-r-t))));let c=[];for(l=t;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);for(l=e;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);c.push(i?1:0),c.reverse();let d=c.join(""),f="";for(l=0;l<64;l+=8){let g=parseInt(d.substr(l,8),2).toString(16);g.length===1&&(g="0"+g),f=f+g}return f.toLowerCase()},DG=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},TG=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function bG(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var SG=new RegExp("^-?(0*)\\d{1,10}$"),AG=-2147483648,MG=2147483647,xN=function(n){if(SG.test(n)){let e=Number(n);if(e>=AG&&e<=MG)return e}return null},ja=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw jt("Exception was thrown by user callback.",t),e},Math.floor(0))}},RG=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},mc=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var eE=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){jt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var tE=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Et("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',jt(e)}},yc=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),fp="5",fx="v",px="s",gx="r",mx="f",yx=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,_x="ls",vx="p",nE="ac",wx="websocket",Ex="long_polling";var pp=class{constructor(e,t,r,i,o=!1,s="",a=!1,l=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=s,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=zo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&zo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function NG(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Ix(n,e,t){L(typeof e=="string","typeof type must == string"),L(typeof t=="object","typeof params must == object");let r;if(e===wx)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Ex)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);NG(n)&&(t.ns=n.namespace);let i=[];return It(t,(o,s)=>{i.push(o+"="+s)}),r+i.join("&")}var rE=class{constructor(){this.counters_={}}incrementCounter(e,t=1){Dn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Kb(this.counters_)}};var Hw={},qw={};function rI(n){let e=n.toString();return Hw[e]||(Hw[e]=new rE),Hw[e]}function xG(n,e){let t=n.toString();return qw[t]||(qw[t]=e()),qw[t]}var iE=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&ja(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var PN="start",PG="close",kG="pLPCommand",OG="pRTLPCB",Cx="id",Dx="pw",Tx="ser",FG="cb",VG="seg",LG="ts",jG="d",BG="dframe",bx=1870,Sx=30,UG=bx-Sx,$G=25e3,HG=3e4,Ec=class n{constructor(e,t,r,i,o,s,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.transportSessionId=s,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Fc(e),this.stats_=rI(t),this.urlFn=l=>(this.appCheckToken&&(l[nE]=this.appCheckToken),Ix(t,Ex,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new iE(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(HG)),IG(()=>{if(this.isClosed_)return;this.scriptTagHolder=new oE((...o)=>{let[s,a,l,c,d]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,s===PN)this.id=a,this.password=l;else if(s===PG)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+s)},(...o)=>{let[s,a]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(s,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[PN]="t",r[Tx]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[FG]=this.scriptTagHolder.uniqueCallbackIdentifier),r[fx]=fp,this.transportSessionId&&(r[px]=this.transportSessionId),this.lastSessionId&&(r[_x]=this.lastSessionId),this.applicationId&&(r[vx]=this.applicationId),this.appCheckToken&&(r[nE]=this.appCheckToken),typeof location<"u"&&location.hostname&&yx.test(location.hostname)&&(r[gx]=mx);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return rr()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!DG()&&!TG()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=ut(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=Wb(t),i=dx(r,UG);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(rr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[BG]="t",r[Cx]=e,r[Dx]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=ut(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},oE=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,rr())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=lx(),window[kG+this.uniqueCallbackIdentifier]=e,window[OG+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');let s="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(a){Et("frame writing exception"),a.stack&&Et(a.stack),Et(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Et("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[Cx]=this.myID,e[Dx]=this.myPW,e[Tx]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Sx+r.length<=bx;){let s=this.pendingSegs.shift();r=r+"&"+VG+i+"="+s.seg+"&"+LG+i+"="+s.ts+"&"+jG+i+"="+s.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor($G)),o=()=>{clearTimeout(i),r()};this.addTag(e,o)}addTag(e,t){rr()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Et("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var qG=16384,GG=45e3,gp=null;typeof MozWebSocket<"u"?gp=MozWebSocket:typeof WebSocket<"u"&&(gp=WebSocket);var Aa=(()=>{class n{constructor(t,r,i,o,s,a,l){this.connId=t,this.applicationId=i,this.appCheckToken=o,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Fc(this.connId),this.stats_=rI(r),this.connURL=n.connectionURL_(r,a,l,o,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,o,s){let a={};return a[fx]=fp,!rr()&&typeof location<"u"&&location.hostname&&yx.test(location.hostname)&&(a[gx]=mx),r&&(a[px]=r),i&&(a[_x]=i),o&&(a[nE]=o),s&&(a[vx]=s),Ix(t,wx,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,zo.set("previous_websocket_failure",!0);try{let i;if(rr()){let o=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${fp}/${eI}/${process.platform}/${o}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let s=process.env,a=this.connURL.indexOf("wss://")===0?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new gp(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let o=i.message||i.data;o&&this.log_(o),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let o=i.message||i.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&gp!==null&&!n.forceDisallow_}static previouslyFailed(){return zo.isInMemoryStorage||zo.get("previous_websocket_failure")===!0}markConnectionHealthy(){zo.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=eh(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(L(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=ut(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=dx(r,qG);i.length>1&&this.sendString_(String(i.length));for(let o=0;o<i.length;o++)this.sendString_(i[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(GG))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),Ax=(()=>{class n{static get ALL_TRANSPORTS(){return[Ec,Aa]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){let r=Aa&&Aa.isAvailable(),i=r&&!Aa.previouslyFailed();if(t.webSocketOnly&&(r||jt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Aa];else{let o=this.transports_=[];for(let s of n.ALL_TRANSPORTS)s&&s.isAvailable()&&o.push(s);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),zG=6e4,WG=5e3,KG=10*1024,QG=100*1024,Gw="t",kN="d",YG="s",ON="r",ZG="e",FN="o",VN="a",LN="n",jN="p",JG="h",sE=class{constructor(e,t,r,i,o,s,a,l,c,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=s,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Fc("c:"+this.id+":"),this.transportManager_=new Ax(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=mc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>QG?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>KG?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Gw in e){let t=e[Gw];t===VN?this.upgradeIfSecondaryHealthy_():t===ON?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===FN&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=hc("t",e),r=hc("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:jN,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:VN,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:LN,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=hc("t",e),r=hc("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=hc(Gw,e);if(kN in e){let r=e[kN];if(t===JG){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===LN){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===YG?this.onConnectionShutdown_(r):t===ON?this.onReset_(r):t===ZG?Xw("Server Error: "+r):t===FN?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Xw("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),fp!==r&&jt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),mc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(zG))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):mc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(WG))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:jN,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(zo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var mp=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var yp=class{constructor(e){this.allowedEvents_=e,this.listeners_={},L(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let o=0;o<i.length;o++)if(i[o].callback===t&&(!r||r===i[o].context)){i.splice(o,1);return}}validateEventType_(e){L(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var _p=class n extends yp{static getInstance(){return new n}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!oy()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return L(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var BN=32,UN=768,xe=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Ne(){return new xe("")}function ye(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ji(n){return n.pieces_.length-n.pieceNum_}function Ue(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new xe(n.pieces_,e)}function iI(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function XG(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Ic(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Mx(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new xe(e,0)}function We(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof xe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new xe(t,0)}function _e(n){return n.pieceNum_>=n.pieces_.length}function Qt(n,e){let t=ye(n),r=ye(e);if(t===null)return e;if(t===r)return Qt(Ue(n),Ue(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function ez(n,e){let t=Ic(n,0),r=Ic(e,0);for(let i=0;i<t.length&&i<r.length;i++){let o=Qo(t[i],r[i]);if(o!==0)return o}return t.length===r.length?0:t.length<r.length?-1:1}function oI(n,e){if(ji(n)!==ji(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function kn(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(ji(n)>ji(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var aE=class{constructor(e,t){this.errorPrefix_=t,this.parts_=Ic(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Jl(this.parts_[r]);Rx(this)}};function tz(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Jl(e),Rx(n)}function nz(n){let e=n.parts_.pop();n.byteLength_-=Jl(e),n.parts_.length>0&&(n.byteLength_-=1)}function Rx(n){if(n.byteLength_>UN)throw new Error(n.errorPrefix_+"has a key path longer than "+UN+" bytes ("+n.byteLength_+").");if(n.parts_.length>BN)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+BN+") or object contains a cycle "+Go(n))}function Go(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var lE=class n extends yp{static getInstance(){return new n}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return L(e==="visible","Unknown event type: "+e),[this.visible_]}};var fc=1e3,rz=60*5*1e3,$N=30*1e3,iz=1.3,oz=3e4,sz="server_kill",HN=3,sI=(()=>{class n extends mp{constructor(t,r,i,o,s,a,l,c){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=o,this.onServerInfoUpdate_=s,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=n.nextPersistentConnectionId_++,this.log_=Fc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=fc,this.maxReconnectDelay_=rz,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!rr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");lE.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&_p.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let o=++this.requestNumber_,s={r:o,a:t,b:r};this.log_(ut(s)),L(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),i&&(this.requestCBHash_[o]=i)}get(t){this.initConnection_();let r=new wt,o={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let l=a.d;a.s==="ok"?r.resolve(l):r.reject(l)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;let s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),r.promise}listen(t,r,i,o){this.initConnection_();let s=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+s),this.listens.has(a)||this.listens.set(a,new Map),L(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),L(!this.listens.get(a).has(s),"listen() called twice for same path/queryId.");let l={onComplete:o,hashFn:r,query:t,tag:i};this.listens.get(a).set(s,l),this.connected_&&this.sendListen_(l)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);let s={p:i},a="q";t.tag&&(s.q=r._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest(a,s,l=>{let c=l.d,d=l.s;n.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(o))===t&&(this.log_("listen response",l),d!=="ok"&&this.removeListen_(i,o),t.onComplete&&t.onComplete(d,c))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Dn(t,"w")){let i=di(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let o='".indexOn": "'+r._queryParams.getIndex().toString()+'"',s=r._path.toString();jt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||Xb(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=$N)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=Jb(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,o=>{let s=o.s,a=o.d||"error";this.authToken_===t&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),o=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+o),L(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,o)&&this.connected_&&this.sendUnlisten_(i,o,t._queryObject,r)}sendUnlisten_(t,r,i,o){this.log_("Unlisten on "+t+" for "+r);let s={p:t},a="n";o&&(s.q=i,s.t=o),this.sendRequest(a,s)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,o){let s={p:r,d:i};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,a=>{o&&setTimeout(()=>{o(a.s,a.d)},Math.floor(0))})}put(t,r,i,o){this.putInternal("p",t,r,i,o)}merge(t,r,i,o){this.putInternal("m",t,r,i,o)}putInternal(t,r,i,o,s){this.initConnection_();let a={p:r,d:i};s!==void 0&&(a.h=s),this.outstandingPuts_.push({action:t,request:a,onComplete:o}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,o=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,s=>{this.log_(r+" response",s),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),o&&o(s.s,s.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let s=i.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+ut(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):Xw("Unrecognized action received from server: "+ut(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){L(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=fc,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=fc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>oz&&(this.reconnectDelay_=fc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*iz)}this.onConnectStatus_(!1)}establishConnection_(){return N(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+n.nextConnectionId_++,s=this.lastSessionId,a=!1,l=null,c=function(){l?l.close():(a=!0,i())},d=function(g){L(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(g)};this.realtime_={close:c,sendRequest:d};let f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,m]=yield Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);a?Et("getToken() completed but was canceled"):(Et("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=m&&m.token,l=new sE(o,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,v=>{jt(v+" ("+this.repoInfo_.toString()+")"),this.interrupt(sz)},s))}catch(g){this.log_("Failed to get token: "+g),a||(this.repoInfo_.nodeAdmin&&jt(g),c())}}})}interrupt(t){Et("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Et("Resuming connection for reason: "+t),delete this.interruptReasons_[t],th(this.interruptReasons_)&&(this.reconnectDelay_=fc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(s=>nI(s)).join("$"):i="default";let o=this.removeListen_(t,i);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(t,r){let i=new xe(t).toString(),o;if(this.listens.has(i)){let s=this.listens.get(i);o=s.get(r),s.delete(r),s.size===0&&this.listens.delete(i)}else o=void 0;return o}onAuthRevoked_(t,r){Et("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=HN&&(this.reconnectDelay_=$N,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Et("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=HN&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";rr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+eI.replace(/\./g,"-")]=1,oy()?t["framework.cordova"]=1:Qb()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=_p.getInstance().currentlyOnline();return th(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),ve=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Na=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new ve(Li,e),i=new ve(Li,t);return this.compare(r,i)!==0}minPost(){return ve.MIN}};var hp,vp=class extends Na{static get __EMPTY_NODE(){return hp}static set __EMPTY_NODE(e){hp=e}compare(e,t){return Qo(e.name,t.name)}isDefinedOn(e){throw As("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ve.MIN}maxPost(){return new ve(Wr,hp)}makePost(e,t){return L(typeof e=="string","KeyIndex indexValue must always be a string."),new ve(e,hp)}toString(){return".key"}},gr=new vp;var Ma=class{constructor(e,t,r,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=t?r(e.key,t):1,i&&(s*=-1),s<0)this.isReverse_?e=e.left:e=e.right;else if(s===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Qn=(()=>{class n{constructor(t,r,i,o,s){this.key=t,this.value=r,this.color=i??n.RED,this.left=o??On.EMPTY_NODE,this.right=s??On.EMPTY_NODE}copy(t,r,i,o,s){return new n(t??this.key,r??this.value,i??this.color,o??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let o=this,s=i(t,o.key);return s<0?o=o.copy(null,null,null,o.left.insert(t,r,i),null):s===0?o=o.copy(null,r,null,null,null):o=o.copy(null,null,null,null,o.right.insert(t,r,i)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return On.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,o;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return On.EMPTY_NODE;o=i.right.min_(),i=i.copy(o.key,o.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),uE=class{copy(e,t,r,i,o){return this}insert(e,t,r){return new Qn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},On=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Qn.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Qn.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ma(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ma(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ma(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ma(this.root_,null,this.comparator_,!0,e)}};On.EMPTY_NODE=new uE;function az(n,e){return Qo(n.name,e.name)}function aI(n,e){return Qo(n,e)}var cE;function lz(n){cE=n}var Nx=function(n){return typeof n=="number"?"number:"+hx(n):"string:"+n},xx=function(n){if(n.isLeafNode()){let e=n.val();L(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Dn(e,".sv"),"Priority must be a string or number.")}else L(n===cE||n.isEmpty(),"priority of unexpected type.");L(n===cE||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var qN,xa=(()=>{class n{static set __childrenNodeConstructor(t){qN=t}static get __childrenNodeConstructor(){return qN}constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,L(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),xx(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return _e(t)?this:ye(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=ye(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(L(i!==".priority"||ji(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ue(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Nx(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=hx(this.value_):t+=this.value_,this.lazyHash_=ux(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(L(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,o=n.VALUE_TYPE_ORDER.indexOf(r),s=n.VALUE_TYPE_ORDER.indexOf(i);return L(o>=0,"Unknown leaf type: "+r),L(s>=0,"Unknown leaf type: "+i),o===s?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-o}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),Px,kx;function uz(n){Px=n}function cz(n){kx=n}var dE=class extends Na{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),o=r.compareTo(i);return o===0?Qo(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ve.MIN}maxPost(){return new ve(Wr,new xa("[PRIORITY-POST]",kx))}makePost(e,t){let r=Px(e);return new ve(t,new xa("[PRIORITY-POST]",r))}toString(){return".priority"}},$e=new dE;var dz=Math.log(2),hE=class{constructor(e){let t=o=>parseInt(Math.log(o)/dz,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},wp=function(n,e,t,r){n.sort(e);let i=function(l,c){let d=c-l,f,g;if(d===0)return null;if(d===1)return f=n[l],g=t?t(f):f,new Qn(g,f.node,Qn.BLACK,null,null);{let m=parseInt(d/2,10)+l,v=i(l,m),T=i(m+1,c);return f=n[m],g=t?t(f):f,new Qn(g,f.node,Qn.BLACK,v,T)}},o=function(l){let c=null,d=null,f=n.length,g=function(v,T){let S=f-v,O=f;f-=v;let B=i(S+1,O),F=n[S],W=t?t(F):F;m(new Qn(W,F.node,T,null,B))},m=function(v){c?(c.left=v,c=v):(d=v,c=v)};for(let v=0;v<l.count;++v){let T=l.nextBitIsOne(),S=Math.pow(2,l.count-(v+1));T?g(S,Qn.BLACK):(g(S,Qn.BLACK),g(S,Qn.RED))}return d},s=new hE(n.length),a=o(s);return new On(r||e,a)};var zw,Sa={},Pa=class n{static get Default(){return L(Sa&&$e,"ChildrenNode.ts has not been loaded"),zw=zw||new n({".priority":Sa},{".priority":$e}),zw}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){let t=di(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof On?t:null}hasIndex(e){return Dn(this.indexSet_,e.toString())}addIndex(e,t){L(e!==gr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,o=t.getIterator(ve.Wrap),s=o.getNext();for(;s;)i=i||e.isDefinedOn(s.node),r.push(s),s=o.getNext();let a;i?a=wp(r,e.getCompare()):a=Sa;let l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;let d=Object.assign({},this.indexes_);return d[l]=a,new n(d,c)}addToIndexes(e,t){let r=Zl(this.indexes_,(i,o)=>{let s=di(this.indexSet_,o);if(L(s,"Missing index implementation for "+o),i===Sa)if(s.isDefinedOn(e.node)){let a=[],l=t.getIterator(ve.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),wp(a,s.getCompare())}else return Sa;else{let a=t.get(e.name),l=i;return a&&(l=l.remove(new ve(e.name,a))),l.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Zl(this.indexes_,i=>{if(i===Sa)return i;{let o=t.get(e.name);return o?i.remove(new ve(e.name,o)):i}});return new n(r,this.indexSet_)}};var pc,de=(()=>{class n{static get EMPTY_NODE(){return pc||(pc=new n(new On(aI),null,Pa.Default))}constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&xx(this.priorityNode_),this.children_.isEmpty()&&L(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||pc}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?pc:r}}getChild(t){let r=ye(t);return r===null?this:this.getImmediateChild(r).getChild(Ue(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(L(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new ve(t,r),o,s;r.isEmpty()?(o=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(i,this.children_)):(o=this.children_.insert(t,r),s=this.indexMap_.addToIndexes(i,this.children_));let a=o.isEmpty()?pc:this.priorityNode_;return new n(o,a,s)}}updateChild(t,r){let i=ye(t);if(i===null)return r;{L(ye(t)!==".priority"||ji(t)===1,".priority must be the last token in a path");let o=this.getImmediateChild(i).updateChild(Ue(t),r);return this.updateImmediateChild(i,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,o=0,s=!0;if(this.forEachChild($e,(a,l)=>{r[a]=l.val(t),i++,s&&n.INTEGER_REGEXP_.test(a)?o=Math.max(o,Number(a)):s=!1}),!t&&s&&o<2*i){let a=[];for(let l in r)a[l]=r[l];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+Nx(this.getPriority().val())+":"),this.forEachChild($e,(r,i)=>{let o=i.hash();o!==""&&(t+=":"+r+":"+o)}),this.lazyHash_=t===""?"":ux(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let o=this.resolveIndex_(i);if(o){let s=o.getPredecessorKey(new ve(t,r));return s?s.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new ve(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new ve(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(o=>r(o.name,o.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,o=>o);{let o=this.children_.getIteratorFrom(t.name,ve.Wrap),s=o.peek();for(;s!=null&&r.compare(s,t)<0;)o.getNext(),s=o.peek();return o}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,o=>o);{let o=this.children_.getReverseIteratorFrom(t.name,ve.Wrap),s=o.peek();for(;s!=null&&r.compare(s,t)>0;)o.getNext(),s=o.peek();return o}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Vc?-1:0}withIndex(t){if(t===gr||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===gr||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator($e),o=r.getIterator($e),s=i.getNext(),a=o.getNext();for(;s&&a;){if(s.name!==a.name||!s.node.equals(a.node))return!1;s=i.getNext(),a=o.getNext()}return s===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===gr?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),fE=class extends de{constructor(){super(new On(aI),de.EMPTY_NODE,Pa.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return de.EMPTY_NODE}isEmpty(){return!1}},Vc=new fE;Object.defineProperties(ve,{MIN:{value:new ve(Li,de.EMPTY_NODE)},MAX:{value:new ve(Wr,Vc)}});vp.__EMPTY_NODE=de.EMPTY_NODE;xa.__childrenNodeConstructor=de;lz(Vc);cz(Vc);var hz=!0;function Ze(n,e=null){if(n===null)return de.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),L(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new xa(t,Ze(e))}if(!(n instanceof Array)&&hz){let t=[],r=!1;if(It(n,(s,a)=>{if(s.substring(0,1)!=="."){let l=Ze(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),t.push(new ve(s,l)))}}),t.length===0)return de.EMPTY_NODE;let o=wp(t,az,s=>s.name,aI);if(r){let s=wp(t,$e.getCompare());return new de(o,Ze(e),new Pa({".priority":s},{".priority":$e}))}else return new de(o,Ze(e),Pa.Default)}else{let t=de.EMPTY_NODE;return It(n,(r,i)=>{if(Dn(n,r)&&r.substring(0,1)!=="."){let o=Ze(i);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(r,o))}}),t.updatePriority(Ze(e))}}uz(Ze);var Cc=class extends Na{constructor(e){super(),this.indexPath_=e,L(!_e(e)&&ye(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),o=r.compareTo(i);return o===0?Qo(e.name,t.name):o}makePost(e,t){let r=Ze(e),i=de.EMPTY_NODE.updateChild(this.indexPath_,r);return new ve(t,i)}maxPost(){let e=de.EMPTY_NODE.updateChild(this.indexPath_,Vc);return new ve(Wr,e)}toString(){return Ic(this.indexPath_,0).join("/")}};var pE=class extends Na{compare(e,t){let r=e.node.compareTo(t.node);return r===0?Qo(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ve.MIN}maxPost(){return ve.MAX}makePost(e,t){let r=Ze(e);return new ve(t,r)}toString(){return".value"}},lI=new pE;function Ox(n){return{type:"value",snapshotNode:n}}function ka(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Dc(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Tc(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function fz(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var bc=class{constructor(e){this.index_=e}updateChild(e,t,r,i,o,s){L(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(s!=null&&(r.isEmpty()?e.hasChild(t)?s.trackChildChange(Dc(t,a)):L(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(ka(t,r)):s.trackChildChange(Tc(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild($e,(i,o)=>{t.hasChild(i)||r.trackChildChange(Dc(i,o))}),t.isLeafNode()||t.forEachChild($e,(i,o)=>{if(e.hasChild(i)){let s=e.getImmediateChild(i);s.equals(o)||r.trackChildChange(Tc(i,o,s))}else r.trackChildChange(ka(i,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?de.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Ep=class n{constructor(e){this.indexedFilter_=new bc(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,o,s){return this.matches(new ve(t,r))||(r=de.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,o,s)}updateFullNode(e,t,r){t.isLeafNode()&&(t=de.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(de.EMPTY_NODE);let o=this;return t.forEachChild($e,(s,a)=>{o.matches(new ve(s,a))||(i=i.updateImmediateChild(s,de.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var gE=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Ep(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,o,s){return this.rangedFilter_.matches(new ve(t,r))||(r=de.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,o,s):this.fullLimitUpdateChild_(e,t,r,o,s)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=de.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=de.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let s=0;for(;o.hasNext()&&s<this.limit_;){let a=o.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),s++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(de.EMPTY_NODE);let o;this.reverse_?o=i.getReverseIterator(this.index_):o=i.getIterator(this.index_);let s=0;for(;o.hasNext();){let a=o.getNext();s<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?s++:i=i.updateImmediateChild(a.name,de.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,o){let s;if(this.reverse_){let f=this.index_.getCompare();s=(g,m)=>f(m,g)}else s=this.index_.getCompare();let a=e;L(a.numChildren()===this.limit_,"");let l=new ve(t,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(l);if(a.hasChild(t)){let f=a.getImmediateChild(t),g=i.getChildAfterChild(this.index_,c,this.reverse_);for(;g!=null&&(g.name===t||a.hasChild(g.name));)g=i.getChildAfterChild(this.index_,g,this.reverse_);let m=g==null?1:s(g,l);if(d&&!r.isEmpty()&&m>=0)return o?.trackChildChange(Tc(t,r,f)),a.updateImmediateChild(t,r);{o?.trackChildChange(Dc(t,f));let T=a.updateImmediateChild(t,de.EMPTY_NODE);return g!=null&&this.rangedFilter_.matches(g)?(o?.trackChildChange(ka(g.name,g.node)),T.updateImmediateChild(g.name,g.node)):T}}else return r.isEmpty()?e:d&&s(c,l)>=0?(o!=null&&(o.trackChildChange(Dc(c.name,c.node)),o.trackChildChange(ka(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(c.name,de.EMPTY_NODE)):e}};var Sc=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=$e}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return L(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return L(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Li}hasEnd(){return this.endSet_}getIndexEndValue(){return L(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return L(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Wr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return L(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===$e}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function pz(n){return n.loadsAllData()?new bc(n.getIndex()):n.hasLimit()?new gE(n):new Ep(n)}function gz(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function mz(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function mE(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function yz(n,e,t){let r;return n.index_===gr||t?r=mE(n,e,t):r=mE(n,e,Wr),r.startAfterSet_=!0,r}function yE(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function _z(n,e,t){let r;return n.index_===gr||t?r=yE(n,e,t):r=yE(n,e,Li),r.endBeforeSet_=!0,r}function Bp(n,e){let t=n.copy();return t.index_=e,t}function GN(n){let e={};if(n.isDefault())return e;let t;if(n.index_===$e?t="$priority":n.index_===lI?t="$value":n.index_===gr?t="$key":(L(n.index_ instanceof Cc,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=ut(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=ut(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+ut(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=ut(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+ut(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function zN(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==$e&&(e.i=n.index_.toString()),e}var _E=class n extends mp{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(L(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Fc("p:rest:"),this.listens_={}}listen(e,t,r,i){let o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);let s=n.getListenId_(e,r),a={};this.listens_[s]=a;let l=GN(e._queryParams);this.restRequest_(o+".json",l,(c,d)=>{let f=d;if(c===404&&(f=null,c=null),c===null&&this.onDataUpdate_(o,f,!1,r),di(this.listens_,s)===a){let g;c?c===401?g="permission_denied":g="rest_error:"+c:g="ok",i(g,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=GN(e._queryParams),r=e._path.toString(),i=new wt;return this.restRequest_(r+".json",t,(o,s)=>{let a=s;o===404&&(a=null,o=null),o===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(t.auth=i.accessToken),o&&o.token&&(t.ac=o.token);let s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+e0(t);this.log_("Sending REST request for "+s);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=eh(a.responseText)}catch{jt("Failed to parse JSON response for "+s+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&jt("Got unsuccessful REST response for "+s+" Status: "+a.status),r(a.status);r=null}},a.open("GET",s,!0),a.send()})}};var vE=class{constructor(){this.rootNode_=de.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function Ip(){return{value:null,children:new Map}}function Ba(n,e,t){if(_e(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=ye(e);n.children.has(r)||n.children.set(r,Ip());let i=n.children.get(r);e=Ue(e),Ba(i,e,t)}}function wE(n,e){if(_e(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild($e,(r,i)=>{Ba(n,new xe(r),i)}),wE(n,e)}}else if(n.children.size>0){let t=ye(e);return e=Ue(e),n.children.has(t)&&wE(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function EE(n,e,t){n.value!==null?t(e,n.value):vz(n,(r,i)=>{let o=new xe(e.toString()+"/"+r);EE(i,o,t)})}function vz(n,e){n.children.forEach((t,r)=>{e(r,t)})}var IE=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&It(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var WN=10*1e3,wz=30*1e3,Ez=5*60*1e3,CE=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new IE(e);let r=WN+(wz-WN)*Math.random();mc(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;It(e,(i,o)=>{o>0&&Dn(this.statsToReport_,i)&&(t[i]=o,r=!0)}),r&&this.server_.reportStats(t),mc(this.reportStats_.bind(this),Math.floor(Math.random()*2*Ez))}};var pr=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(pr||{});function uI(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function cI(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function dI(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var DE=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=pr.ACK_USER_WRITE,this.source=uI()}operationForChild(e){if(_e(this.path)){if(this.affectedTree.value!=null)return L(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new xe(e));return new n(Ne(),t,this.revert)}}else return L(ye(this.path)===e,"operationForChild called for unrelated child."),new n(Ue(this.path),this.affectedTree,this.revert)}};var Cp=class n{constructor(e,t){this.source=e,this.path=t,this.type=pr.LISTEN_COMPLETE}operationForChild(e){return _e(this.path)?new n(this.source,Ne()):new n(this.source,Ue(this.path))}};var Oa=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=pr.OVERWRITE}operationForChild(e){return _e(this.path)?new n(this.source,Ne(),this.snap.getImmediateChild(e)):new n(this.source,Ue(this.path),this.snap)}};var Ac=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=pr.MERGE}operationForChild(e){if(_e(this.path)){let t=this.children.subtree(new xe(e));return t.isEmpty()?null:t.value?new Oa(this.source,Ne(),t.value):new n(this.source,Ne(),t)}else return L(ye(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,Ue(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var yr=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(_e(e))return this.isFullyInitialized()&&!this.filtered_;let t=ye(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var TE=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function Iz(n,e,t,r){let i=[],o=[];return e.forEach(s=>{s.type==="child_changed"&&n.index_.indexedValueChanged(s.oldSnap,s.snapshotNode)&&o.push(fz(s.childName,s.snapshotNode))}),gc(n,i,"child_removed",e,r,t),gc(n,i,"child_added",e,r,t),gc(n,i,"child_moved",o,r,t),gc(n,i,"child_changed",e,r,t),gc(n,i,"value",e,r,t),i}function gc(n,e,t,r,i,o){let s=r.filter(a=>a.type===t);s.sort((a,l)=>Dz(n,a,l)),s.forEach(a=>{let l=Cz(n,a,o);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,n.query_))})})}function Cz(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Dz(n,e,t){if(e.childName==null||t.childName==null)throw As("Should only compare child_ events.");let r=new ve(e.childName,e.snapshotNode),i=new ve(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function Up(n,e){return{eventCache:n,serverCache:e}}function _c(n,e,t,r){return Up(new yr(e,t,r),n.serverCache)}function Fx(n,e,t,r){return Up(n.eventCache,new yr(e,t,r))}function Dp(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Ko(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var Ww,Tz=()=>(Ww||(Ww=new On(CG)),Ww),Yt=class n{static fromObject(e){let t=new n(null);return It(e,(r,i)=>{t=t.set(new xe(r),i)}),t}constructor(e,t=Tz()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Ne(),value:this.value};if(_e(e))return null;{let r=ye(e),i=this.children.get(r);if(i!==null){let o=i.findRootMostMatchingPathAndValue(Ue(e),t);return o!=null?{path:We(new xe(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(_e(e))return this;{let t=ye(e),r=this.children.get(t);return r!==null?r.subtree(Ue(e)):new n(null)}}set(e,t){if(_e(e))return new n(t,this.children);{let r=ye(e),o=(this.children.get(r)||new n(null)).set(Ue(e),t),s=this.children.insert(r,o);return new n(this.value,s)}}remove(e){if(_e(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=ye(e),r=this.children.get(t);if(r){let i=r.remove(Ue(e)),o;return i.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,i),this.value===null&&o.isEmpty()?new n(null):new n(this.value,o)}else return this}}get(e){if(_e(e))return this.value;{let t=ye(e),r=this.children.get(t);return r?r.get(Ue(e)):null}}setTree(e,t){if(_e(e))return t;{let r=ye(e),o=(this.children.get(r)||new n(null)).setTree(Ue(e),t),s;return o.isEmpty()?s=this.children.remove(r):s=this.children.insert(r,o),new n(this.value,s)}}fold(e){return this.fold_(Ne(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,o)=>{r[i]=o.fold_(We(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Ne(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(_e(e))return null;{let o=ye(e),s=this.children.get(o);return s?s.findOnPath_(Ue(e),We(t,o),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ne(),t)}foreachOnPath_(e,t,r){if(_e(e))return this;{this.value&&r(t,this.value);let i=ye(e),o=this.children.get(i);return o?o.foreachOnPath_(Ue(e),We(t,i),r):new n(null)}}foreach(e){this.foreach_(Ne(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(We(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Yn=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new Yt(null))}};function vc(n,e,t){if(_e(e))return new Yn(new Yt(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,o=r.value,s=Qt(i,e);return o=o.updateChild(s,t),new Yn(n.writeTree_.set(i,o))}else{let i=new Yt(t),o=n.writeTree_.setTree(e,i);return new Yn(o)}}}function bE(n,e,t){let r=n;return It(t,(i,o)=>{r=vc(r,We(e,i),o)}),r}function KN(n,e){if(_e(e))return Yn.empty();{let t=n.writeTree_.setTree(e,new Yt(null));return new Yn(t)}}function SE(n,e){return Yo(n,e)!=null}function Yo(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Qt(t.path,e)):null}function QN(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild($e,(r,i)=>{e.push(new ve(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ve(r,i.value))}),e}function Fi(n,e){if(_e(e))return n;{let t=Yo(n,e);return t!=null?new Yn(new Yt(t)):new Yn(n.writeTree_.subtree(e))}}function AE(n){return n.writeTree_.isEmpty()}function Fa(n,e){return Vx(Ne(),n.writeTree_,e)}function Vx(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,o)=>{i===".priority"?(L(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):t=Vx(We(n,i),o,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(We(n,".priority"),r)),t}}function $p(n,e){return Ux(e,n)}function bz(n,e,t,r,i){L(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=vc(n.visibleWrites,e,t)),n.lastWriteId=r}function Sz(n,e,t,r){L(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=bE(n.visibleWrites,e,t),n.lastWriteId=r}function Az(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function Mz(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);L(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,o=!1,s=n.allWrites.length-1;for(;i&&s>=0;){let a=n.allWrites[s];a.visible&&(s>=t&&Rz(a,r.path)?i=!1:kn(r.path,a.path)&&(o=!0)),s--}if(i){if(o)return Nz(n),!0;if(r.snap)n.visibleWrites=KN(n.visibleWrites,r.path);else{let a=r.children;It(a,l=>{n.visibleWrites=KN(n.visibleWrites,We(r.path,l))})}return!0}else return!1}function Rz(n,e){if(n.snap)return kn(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&kn(We(n.path,t),e))return!0;return!1}function Nz(n){n.visibleWrites=Lx(n.allWrites,xz,Ne()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function xz(n){return n.visible}function Lx(n,e,t){let r=Yn.empty();for(let i=0;i<n.length;++i){let o=n[i];if(e(o)){let s=o.path,a;if(o.snap)kn(t,s)?(a=Qt(t,s),r=vc(r,a,o.snap)):kn(s,t)&&(a=Qt(s,t),r=vc(r,Ne(),o.snap.getChild(a)));else if(o.children){if(kn(t,s))a=Qt(t,s),r=bE(r,a,o.children);else if(kn(s,t))if(a=Qt(s,t),_e(a))r=bE(r,Ne(),o.children);else{let l=di(o.children,ye(a));if(l){let c=l.getChild(Ue(a));r=vc(r,Ne(),c)}}}else throw As("WriteRecord should have .snap or .children")}}return r}function jx(n,e,t,r,i){if(!r&&!i){let o=Yo(n.visibleWrites,e);if(o!=null)return o;{let s=Fi(n.visibleWrites,e);if(AE(s))return t;if(t==null&&!SE(s,Ne()))return null;{let a=t||de.EMPTY_NODE;return Fa(s,a)}}}else{let o=Fi(n.visibleWrites,e);if(!i&&AE(o))return t;if(!i&&t==null&&!SE(o,Ne()))return null;{let s=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(kn(c.path,e)||kn(e,c.path))},a=Lx(n.allWrites,s,e),l=t||de.EMPTY_NODE;return Fa(a,l)}}}function Pz(n,e,t){let r=de.EMPTY_NODE,i=Yo(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild($e,(o,s)=>{r=r.updateImmediateChild(o,s)}),r;if(t){let o=Fi(n.visibleWrites,e);return t.forEachChild($e,(s,a)=>{let l=Fa(Fi(o,new xe(s)),a);r=r.updateImmediateChild(s,l)}),QN(o).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}else{let o=Fi(n.visibleWrites,e);return QN(o).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}}function kz(n,e,t,r,i){L(r||i,"Either existingEventSnap or existingServerSnap must exist");let o=We(e,t);if(SE(n.visibleWrites,o))return null;{let s=Fi(n.visibleWrites,o);return AE(s)?i.getChild(t):Fa(s,i.getChild(t))}}function Oz(n,e,t,r){let i=We(e,t),o=Yo(n.visibleWrites,i);if(o!=null)return o;if(r.isCompleteForChild(t)){let s=Fi(n.visibleWrites,i);return Fa(s,r.getNode().getImmediateChild(t))}else return null}function Fz(n,e){return Yo(n.visibleWrites,e)}function Vz(n,e,t,r,i,o,s){let a,l=Fi(n.visibleWrites,e),c=Yo(l,Ne());if(c!=null)a=c;else if(t!=null)a=Fa(l,t);else return[];if(a=a.withIndex(s),!a.isEmpty()&&!a.isLeafNode()){let d=[],f=s.getCompare(),g=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s),m=g.getNext();for(;m&&d.length<i;)f(m,r)!==0&&d.push(m),m=g.getNext();return d}else return[]}function Lz(){return{visibleWrites:Yn.empty(),allWrites:[],lastWriteId:-1}}function Tp(n,e,t,r){return jx(n.writeTree,n.treePath,e,t,r)}function hI(n,e){return Pz(n.writeTree,n.treePath,e)}function YN(n,e,t,r){return kz(n.writeTree,n.treePath,e,t,r)}function bp(n,e){return Fz(n.writeTree,We(n.treePath,e))}function jz(n,e,t,r,i,o){return Vz(n.writeTree,n.treePath,e,t,r,i,o)}function fI(n,e,t){return Oz(n.writeTree,n.treePath,e,t)}function Bx(n,e){return Ux(We(n.treePath,e),n.writeTree)}function Ux(n,e){return{treePath:n,writeTree:e}}var ME=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;L(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),L(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let o=i.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(r,Tc(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(r,Dc(r,i.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(r,ka(r,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(r,Tc(r,e.snapshotNode,i.oldSnap));else throw As("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var RE=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},$x=new RE,Mc=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new yr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return fI(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ko(this.viewCache_),o=jz(this.writes_,i,t,1,r,e);return o.length===0?null:o[0]}};function Bz(n){return{filter:n}}function Uz(n,e){L(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),L(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function $z(n,e,t,r,i){let o=new ME,s,a;if(t.type===pr.OVERWRITE){let c=t;c.source.fromUser?s=NE(n,e,c.path,c.snap,r,i,o):(L(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!_e(c.path),s=Sp(n,e,c.path,c.snap,r,i,a,o))}else if(t.type===pr.MERGE){let c=t;c.source.fromUser?s=qz(n,e,c.path,c.children,r,i,o):(L(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),s=xE(n,e,c.path,c.children,r,i,a,o))}else if(t.type===pr.ACK_USER_WRITE){let c=t;c.revert?s=Wz(n,e,c.path,r,i,o):s=Gz(n,e,c.path,c.affectedTree,r,i,o)}else if(t.type===pr.LISTEN_COMPLETE)s=zz(n,e,t.path,r,o);else throw As("Unknown operation type: "+t.type);let l=o.getChanges();return Hz(e,s,l),{viewCache:s,changes:l}}function Hz(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Dp(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&t.push(Ox(Dp(e)))}}function Hx(n,e,t,r,i,o){let s=e.eventCache;if(bp(r,t)!=null)return e;{let a,l;if(_e(t))if(L(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=Ko(e),d=c instanceof de?c:de.EMPTY_NODE,f=hI(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),f,o)}else{let c=Tp(r,Ko(e));a=n.filter.updateFullNode(e.eventCache.getNode(),c,o)}else{let c=ye(t);if(c===".priority"){L(ji(t)===1,"Can't have a priority with additional path components");let d=s.getNode();l=e.serverCache.getNode();let f=YN(r,t,d,l);f!=null?a=n.filter.updatePriority(d,f):a=s.getNode()}else{let d=Ue(t),f;if(s.isCompleteForChild(c)){l=e.serverCache.getNode();let g=YN(r,t,s.getNode(),l);g!=null?f=s.getNode().getImmediateChild(c).updateChild(d,g):f=s.getNode().getImmediateChild(c)}else f=fI(r,c,e.serverCache);f!=null?a=n.filter.updateChild(s.getNode(),c,f,d,i,o):a=s.getNode()}}return _c(e,a,s.isFullyInitialized()||_e(t),n.filter.filtersNodes())}}function Sp(n,e,t,r,i,o,s,a){let l=e.serverCache,c,d=s?n.filter:n.filter.getIndexedFilter();if(_e(t))c=d.updateFullNode(l.getNode(),r,null);else if(d.filtersNodes()&&!l.isFiltered()){let m=l.getNode().updateChild(t,r);c=d.updateFullNode(l.getNode(),m,null)}else{let m=ye(t);if(!l.isCompleteForPath(t)&&ji(t)>1)return e;let v=Ue(t),S=l.getNode().getImmediateChild(m).updateChild(v,r);m===".priority"?c=d.updatePriority(l.getNode(),S):c=d.updateChild(l.getNode(),m,S,v,$x,null)}let f=Fx(e,c,l.isFullyInitialized()||_e(t),d.filtersNodes()),g=new Mc(i,f,o);return Hx(n,f,t,i,g,a)}function NE(n,e,t,r,i,o,s){let a=e.eventCache,l,c,d=new Mc(i,e,o);if(_e(t))c=n.filter.updateFullNode(e.eventCache.getNode(),r,s),l=_c(e,c,!0,n.filter.filtersNodes());else{let f=ye(t);if(f===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),r),l=_c(e,c,a.isFullyInitialized(),a.isFiltered());else{let g=Ue(t),m=a.getNode().getImmediateChild(f),v;if(_e(g))v=r;else{let T=d.getCompleteChild(f);T!=null?iI(g)===".priority"&&T.getChild(Mx(g)).isEmpty()?v=T:v=T.updateChild(g,r):v=de.EMPTY_NODE}if(m.equals(v))l=e;else{let T=n.filter.updateChild(a.getNode(),f,v,g,d,s);l=_c(e,T,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function ZN(n,e){return n.eventCache.isCompleteForChild(e)}function qz(n,e,t,r,i,o,s){let a=e;return r.foreach((l,c)=>{let d=We(t,l);ZN(e,ye(d))&&(a=NE(n,a,d,c,i,o,s))}),r.foreach((l,c)=>{let d=We(t,l);ZN(e,ye(d))||(a=NE(n,a,d,c,i,o,s))}),a}function JN(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function xE(n,e,t,r,i,o,s,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;_e(t)?c=r:c=new Yt(null).setTree(t,r);let d=e.serverCache.getNode();return c.children.inorderTraversal((f,g)=>{if(d.hasChild(f)){let m=e.serverCache.getNode().getImmediateChild(f),v=JN(n,m,g);l=Sp(n,l,new xe(f),v,i,o,s,a)}}),c.children.inorderTraversal((f,g)=>{let m=!e.serverCache.isCompleteForChild(f)&&g.value===null;if(!d.hasChild(f)&&!m){let v=e.serverCache.getNode().getImmediateChild(f),T=JN(n,v,g);l=Sp(n,l,new xe(f),T,i,o,s,a)}}),l}function Gz(n,e,t,r,i,o,s){if(bp(i,t)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(_e(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return Sp(n,e,t,l.getNode().getChild(t),i,o,a,s);if(_e(t)){let c=new Yt(null);return l.getNode().forEachChild(gr,(d,f)=>{c=c.set(new xe(d),f)}),xE(n,e,t,c,i,o,a,s)}else return e}else{let c=new Yt(null);return r.foreach((d,f)=>{let g=We(t,d);l.isCompleteForPath(g)&&(c=c.set(d,l.getNode().getChild(g)))}),xE(n,e,t,c,i,o,a,s)}}function zz(n,e,t,r,i){let o=e.serverCache,s=Fx(e,o.getNode(),o.isFullyInitialized()||_e(t),o.isFiltered());return Hx(n,s,t,r,$x,i)}function Wz(n,e,t,r,i,o){let s;if(bp(r,t)!=null)return e;{let a=new Mc(r,e,i),l=e.eventCache.getNode(),c;if(_e(t)||ye(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=Tp(r,Ko(e));else{let f=e.serverCache.getNode();L(f instanceof de,"serverChildren would be complete if leaf node"),d=hI(r,f)}d=d,c=n.filter.updateFullNode(l,d,o)}else{let d=ye(t),f=fI(r,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=l.getImmediateChild(d)),f!=null?c=n.filter.updateChild(l,d,f,Ue(t),a,o):e.eventCache.getNode().hasChild(d)?c=n.filter.updateChild(l,d,de.EMPTY_NODE,Ue(t),a,o):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(s=Tp(r,Ko(e)),s.isLeafNode()&&(c=n.filter.updateFullNode(c,s,o)))}return s=e.serverCache.isFullyInitialized()||bp(r,Ne())!=null,_c(e,c,s,n.filter.filtersNodes())}}var PE=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new bc(r.getIndex()),o=pz(r);this.processor_=Bz(o);let s=t.serverCache,a=t.eventCache,l=i.updateFullNode(de.EMPTY_NODE,s.getNode(),null),c=o.updateFullNode(de.EMPTY_NODE,a.getNode(),null),d=new yr(l,s.isFullyInitialized(),i.filtersNodes()),f=new yr(c,a.isFullyInitialized(),o.filtersNodes());this.viewCache_=Up(f,d),this.eventGenerator_=new TE(this.query_)}get query(){return this.query_}};function Kz(n){return n.viewCache_.serverCache.getNode()}function Qz(n){return Dp(n.viewCache_)}function Yz(n,e){let t=Ko(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!_e(e)&&!t.getImmediateChild(ye(e)).isEmpty())?t.getChild(e):null}function XN(n){return n.eventRegistrations_.length===0}function Zz(n,e){n.eventRegistrations_.push(e)}function ex(n,e,t){let r=[];if(t){L(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(o=>{let s=o.createCancelEvent(t,i);s&&r.push(s)})}if(e){let i=[];for(let o=0;o<n.eventRegistrations_.length;++o){let s=n.eventRegistrations_[o];if(!s.matches(e))i.push(s);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function tx(n,e,t,r){e.type===pr.MERGE&&e.source.queryId!==null&&(L(Ko(n.viewCache_),"We should always have a full cache before handling merges"),L(Dp(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,o=$z(n.processor_,i,e,t,r);return Uz(n.processor_,o.viewCache),L(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,qx(n,o.changes,o.viewCache.eventCache.getNode(),null)}function Jz(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild($e,(o,s)=>{r.push(ka(o,s))}),t.isFullyInitialized()&&r.push(Ox(t.getNode())),qx(n,r,t.getNode(),e)}function qx(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return Iz(n.eventGenerator_,e,t,i)}var Ap,Mp=class{constructor(){this.views=new Map}};function Xz(n){L(!Ap,"__referenceConstructor has already been defined"),Ap=n}function e4(){return L(Ap,"Reference.ts has not been loaded"),Ap}function t4(n){return n.views.size===0}function pI(n,e,t,r){let i=e.source.queryId;if(i!==null){let o=n.views.get(i);return L(o!=null,"SyncTree gave us an op for an invalid query."),tx(o,e,t,r)}else{let o=[];for(let s of n.views.values())o=o.concat(tx(s,e,t,r));return o}}function Gx(n,e,t,r,i){let o=e._queryIdentifier,s=n.views.get(o);if(!s){let a=Tp(t,i?r:null),l=!1;a?l=!0:r instanceof de?(a=hI(t,r),l=!1):(a=de.EMPTY_NODE,l=!1);let c=Up(new yr(a,l,!1),new yr(r,i,!1));return new PE(e,c)}return s}function n4(n,e,t,r,i,o){let s=Gx(n,e,r,i,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,s),Zz(s,t),Jz(s,t)}function r4(n,e,t,r){let i=e._queryIdentifier,o=[],s=[],a=Bi(n);if(i==="default")for(let[l,c]of n.views.entries())s=s.concat(ex(c,t,r)),XN(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||o.push(c.query));else{let l=n.views.get(i);l&&(s=s.concat(ex(l,t,r)),XN(l)&&(n.views.delete(i),l.query._queryParams.loadsAllData()||o.push(l.query)))}return a&&!Bi(n)&&o.push(new(e4())(e._repo,e._path)),{removed:o,events:s}}function zx(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Vi(n,e){let t=null;for(let r of n.views.values())t=t||Yz(r,e);return t}function Wx(n,e){if(e._queryParams.loadsAllData())return Hp(n);{let r=e._queryIdentifier;return n.views.get(r)}}function Kx(n,e){return Wx(n,e)!=null}function Bi(n){return Hp(n)!=null}function Hp(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Rp;function i4(n){L(!Rp,"__referenceConstructor has already been defined"),Rp=n}function o4(){return L(Rp,"Reference.ts has not been loaded"),Rp}var s4=1,Np=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Yt(null),this.pendingWriteTree_=Lz(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function gI(n,e,t,r,i){return bz(n.pendingWriteTree_,e,t,r,i),i?Ua(n,new Oa(uI(),e,t)):[]}function a4(n,e,t,r){Sz(n.pendingWriteTree_,e,t,r);let i=Yt.fromObject(t);return Ua(n,new Ac(uI(),e,i))}function Oi(n,e,t=!1){let r=Az(n.pendingWriteTree_,e);if(Mz(n.pendingWriteTree_,e)){let o=new Yt(null);return r.snap!=null?o=o.set(Ne(),!0):It(r.children,s=>{o=o.set(new xe(s),!0)}),Ua(n,new DE(r.path,o,t))}else return[]}function Lc(n,e,t){return Ua(n,new Oa(cI(),e,t))}function l4(n,e,t){let r=Yt.fromObject(t);return Ua(n,new Ac(cI(),e,r))}function u4(n,e){return Ua(n,new Cp(cI(),e))}function c4(n,e,t){let r=mI(n,t);if(r){let i=yI(r),o=i.path,s=i.queryId,a=Qt(o,e),l=new Cp(dI(s),a);return _I(n,o,l)}else return[]}function xp(n,e,t,r,i=!1){let o=e._path,s=n.syncPointTree_.get(o),a=[];if(s&&(e._queryIdentifier==="default"||Kx(s,e))){let l=r4(s,e,t,r);t4(s)&&(n.syncPointTree_=n.syncPointTree_.remove(o));let c=l.removed;if(a=l.events,!i){let d=c.findIndex(g=>g._queryParams.loadsAllData())!==-1,f=n.syncPointTree_.findOnPath(o,(g,m)=>Bi(m));if(d&&!f){let g=n.syncPointTree_.subtree(o);if(!g.isEmpty()){let m=f4(g);for(let v=0;v<m.length;++v){let T=m[v],S=T.query,O=Jx(n,T);n.listenProvider_.startListening(wc(S),Rc(n,S),O.hashFn,O.onComplete)}}}!f&&c.length>0&&!r&&(d?n.listenProvider_.stopListening(wc(e),null):c.forEach(g=>{let m=n.queryToTagMap.get(Gp(g));n.listenProvider_.stopListening(wc(g),m)}))}p4(n,c)}return a}function Qx(n,e,t,r){let i=mI(n,r);if(i!=null){let o=yI(i),s=o.path,a=o.queryId,l=Qt(s,e),c=new Oa(dI(a),l,t);return _I(n,s,c)}else return[]}function d4(n,e,t,r){let i=mI(n,r);if(i){let o=yI(i),s=o.path,a=o.queryId,l=Qt(s,e),c=Yt.fromObject(t),d=new Ac(dI(a),l,c);return _I(n,s,d)}else return[]}function kE(n,e,t,r=!1){let i=e._path,o=null,s=!1;n.syncPointTree_.foreachOnPath(i,(g,m)=>{let v=Qt(g,i);o=o||Vi(m,v),s=s||Bi(m)});let a=n.syncPointTree_.get(i);a?(s=s||Bi(a),o=o||Vi(a,Ne())):(a=new Mp,n.syncPointTree_=n.syncPointTree_.set(i,a));let l;o!=null?l=!0:(l=!1,o=de.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((m,v)=>{let T=Vi(v,Ne());T&&(o=o.updateImmediateChild(m,T))}));let c=Kx(a,e);if(!c&&!e._queryParams.loadsAllData()){let g=Gp(e);L(!n.queryToTagMap.has(g),"View does not exist, but we have a tag");let m=g4();n.queryToTagMap.set(g,m),n.tagToQueryMap.set(m,g)}let d=$p(n.pendingWriteTree_,i),f=n4(a,e,t,d,o,l);if(!c&&!s&&!r){let g=Wx(a,e);f=f.concat(m4(n,e,g))}return f}function qp(n,e,t){let i=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(s,a)=>{let l=Qt(s,e),c=Vi(a,l);if(c)return c});return jx(i,e,o,t,!0)}function h4(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(c,d)=>{let f=Qt(c,t);r=r||Vi(d,f)});let i=n.syncPointTree_.get(t);i?r=r||Vi(i,Ne()):(i=new Mp,n.syncPointTree_=n.syncPointTree_.set(t,i));let o=r!=null,s=o?new yr(r,!0,!1):null,a=$p(n.pendingWriteTree_,e._path),l=Gx(i,e,a,o?s.getNode():de.EMPTY_NODE,o);return Qz(l)}function Ua(n,e){return Yx(e,n.syncPointTree_,null,$p(n.pendingWriteTree_,Ne()))}function Yx(n,e,t,r){if(_e(n.path))return Zx(n,e,t,r);{let i=e.get(Ne());t==null&&i!=null&&(t=Vi(i,Ne()));let o=[],s=ye(n.path),a=n.operationForChild(s),l=e.children.get(s);if(l&&a){let c=t?t.getImmediateChild(s):null,d=Bx(r,s);o=o.concat(Yx(a,l,c,d))}return i&&(o=o.concat(pI(i,n,r,t))),o}}function Zx(n,e,t,r){let i=e.get(Ne());t==null&&i!=null&&(t=Vi(i,Ne()));let o=[];return e.children.inorderTraversal((s,a)=>{let l=t?t.getImmediateChild(s):null,c=Bx(r,s),d=n.operationForChild(s);d&&(o=o.concat(Zx(d,a,l,c)))}),i&&(o=o.concat(pI(i,n,r,t))),o}function Jx(n,e){let t=e.query,r=Rc(n,t);return{hashFn:()=>(Kz(e)||de.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?c4(n,t._path,r):u4(n,t._path);{let o=bG(i,t);return xp(n,t,null,o)}}}}function Rc(n,e){let t=Gp(e);return n.queryToTagMap.get(t)}function Gp(n){return n._path.toString()+"$"+n._queryIdentifier}function mI(n,e){return n.tagToQueryMap.get(e)}function yI(n){let e=n.indexOf("$");return L(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new xe(n.substr(0,e))}}function _I(n,e,t){let r=n.syncPointTree_.get(e);L(r,"Missing sync point for query tag that we're tracking");let i=$p(n.pendingWriteTree_,e);return pI(r,t,i,null)}function f4(n){return n.fold((e,t,r)=>{if(t&&Bi(t))return[Hp(t)];{let i=[];return t&&(i=zx(t)),It(r,(o,s)=>{i=i.concat(s)}),i}})}function wc(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(o4())(n._repo,n._path):n}function p4(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=Gp(r),o=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(o)}}}function g4(){return s4++}function m4(n,e,t){let r=e._path,i=Rc(n,e),o=Jx(n,t),s=n.listenProvider_.startListening(wc(e),i,o.hashFn,o.onComplete),a=n.syncPointTree_.subtree(r);if(i)L(!Bi(a.value),"If we're adding a query, it shouldn't be shadowed");else{let l=a.fold((c,d,f)=>{if(!_e(c)&&d&&Bi(d))return[Hp(d).query];{let g=[];return d&&(g=g.concat(zx(d).map(m=>m.query))),It(f,(m,v)=>{g=g.concat(v)}),g}});for(let c=0;c<l.length;++c){let d=l[c];n.listenProvider_.stopListening(wc(d),Rc(n,d))}}return s}var OE=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},FE=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=We(this.path_,e);return new n(this.syncTree_,t)}node(){return qp(this.syncTree_,this.path_)}},y4=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},nx=function(n,e,t){if(!n||typeof n!="object")return n;if(L(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return _4(n[".sv"],e,t);if(typeof n[".sv"]=="object")return v4(n[".sv"],e);L(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},_4=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:L(!1,"Unexpected server value: "+n)}},v4=function(n,e,t){n.hasOwnProperty("increment")||L(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&L(!1,"Unexpected increment value: "+r);let i=e.node();if(L(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let s=i.getValue();return typeof s!="number"?r:s+r},Xx=function(n,e,t,r){return wI(e,new FE(t,n),r)},vI=function(n,e,t){return wI(n,new OE(e),t)};function wI(n,e,t){let r=n.getPriority().val(),i=nx(r,e.getImmediateChild(".priority"),t),o;if(n.isLeafNode()){let s=n,a=nx(s.getValue(),e,t);return a!==s.getValue()||i!==s.getPriority().val()?new xa(a,Ze(i)):n}else{let s=n;return o=s,i!==s.getPriority().val()&&(o=o.updatePriority(new xa(i))),s.forEachChild($e,(a,l)=>{let c=wI(l,e.getImmediateChild(a),t);c!==l&&(o=o.updateImmediateChild(a,c))}),o}}var Nc=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function zp(n,e){let t=e instanceof xe?e:new xe(e),r=n,i=ye(t);for(;i!==null;){let o=di(r.node.children,i)||{children:{},childCount:0};r=new Nc(i,r,o),t=Ue(t),i=ye(t)}return r}function Zo(n){return n.node.value}function EI(n,e){n.node.value=e,VE(n)}function eP(n){return n.node.childCount>0}function w4(n){return Zo(n)===void 0&&!eP(n)}function Wp(n,e){It(n.node.children,(t,r)=>{e(new Nc(t,n,r))})}function tP(n,e,t,r){t&&!r&&e(n),Wp(n,i=>{tP(i,e,!0,r)}),t&&r&&e(n)}function E4(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function jc(n){return new xe(n.parent===null?n.name:jc(n.parent)+"/"+n.name)}function VE(n){n.parent!==null&&I4(n.parent,n.name,n)}function I4(n,e,t){let r=w4(t),i=Dn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,VE(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,VE(n))}var C4=/[\[\].#$\/\u0000-\u001F\u007F]/,D4=/[\[\].#$\u0000-\u001F\u007F]/,Kw=10*1024*1024,Kp=function(n){return typeof n=="string"&&n.length!==0&&!C4.test(n)},nP=function(n){return typeof n=="string"&&n.length!==0&&!D4.test(n)},T4=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),nP(n)},xc=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!jp(n)||n&&typeof n=="object"&&Dn(n,".sv")},_r=function(n,e,t,r){r&&e===void 0||Bc(en(n,"value"),e,t)},Bc=function(n,e,t){let r=t instanceof xe?new aE(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Go(r));if(typeof e=="function")throw new Error(n+"contains a function "+Go(r)+" with contents = "+e.toString());if(jp(e))throw new Error(n+"contains "+e.toString()+" "+Go(r));if(typeof e=="string"&&e.length>Kw/3&&Jl(e)>Kw)throw new Error(n+"contains a string greater than "+Kw+" utf8 bytes "+Go(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,o=!1;if(It(e,(s,a)=>{if(s===".value")i=!0;else if(s!==".priority"&&s!==".sv"&&(o=!0,!Kp(s)))throw new Error(n+" contains an invalid key ("+s+") "+Go(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);tz(r,s),Bc(n,a,r),nz(r)}),i&&o)throw new Error(n+' contains ".value" child '+Go(r)+" in addition to actual children.")}},b4=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let o=Ic(r);for(let s=0;s<o.length;s++)if(!(o[s]===".priority"&&s===o.length-1)){if(!Kp(o[s]))throw new Error(n+"contains an invalid key ("+o[s]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(ez);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&kn(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},rP=function(n,e,t,r){if(r&&e===void 0)return;let i=en(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let o=[];It(e,(s,a)=>{let l=new xe(s);if(Bc(i,a,We(t,l)),iI(l)===".priority"&&!xc(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(l)}),b4(i,o)},II=function(n,e,t){if(!(t&&e===void 0)){if(jp(e))throw new Error(en(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!xc(e))throw new Error(en(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Uc=function(n,e,t,r){if(!(r&&t===void 0)&&!Kp(t))throw new Error(en(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},$a=function(n,e,t,r){if(!(r&&t===void 0)&&!nP(t))throw new Error(en(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},S4=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),$a(n,e,t,r)},_n=function(n,e){if(ye(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},iP=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Kp(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!T4(t))throw new Error(en(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var LE=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Qp(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],o=i.getPath();t!==null&&!oI(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(i)}t&&n.eventLists_.push(t)}function oP(n,e,t){Qp(n,t),sP(n,r=>oI(r,e))}function vn(n,e,t){Qp(n,t),sP(n,r=>kn(r,e)||kn(e,r))}function sP(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let o=i.path;e(o)?(A4(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function A4(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Wo&&Et("event: "+t.toString()),ja(r)}}}var aP="repo_interrupt",M4=25,jE=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new LE,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ip(),this.transactionQueueTree_=new Nc,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function R4(n,e,t){if(n.stats_=rI(n.repoInfo_),n.forceRestClient_||RG())n.server_=new _E(n.repoInfo_,(r,i,o,s)=>{rx(n,r,i,o,s)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>ix(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ut(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new sI(n.repoInfo_,e,(r,i,o,s)=>{rx(n,r,i,o,s)},r=>{ix(n,r)},r=>{N4(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=xG(n.repoInfo_,()=>new CE(n.stats_,n.server_)),n.infoData_=new vE,n.infoSyncTree_=new Np({startListening:(r,i,o,s)=>{let a=[],l=n.infoData_.getNode(r._path);return l.isEmpty()||(a=Lc(n.infoSyncTree_,r._path,l),setTimeout(()=>{s("ok")},0)),a},stopListening:()=>{}}),CI(n,"connected",!1),n.serverSyncTree_=new Np({startListening:(r,i,o,s)=>(n.server_.listen(r,o,i,(a,l)=>{let c=s(a,l);vn(n.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function lP(n){let t=n.infoData_.getNode(new xe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function $c(n){return y4({timestamp:lP(n)})}function rx(n,e,t,r,i){n.dataUpdateCount++;let o=new xe(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let s=[];if(i)if(r){let l=Zl(t,c=>Ze(c));s=d4(n.serverSyncTree_,o,l,i)}else{let l=Ze(t);s=Qx(n.serverSyncTree_,o,l,i)}else if(r){let l=Zl(t,c=>Ze(c));s=l4(n.serverSyncTree_,o,l)}else{let l=Ze(t);s=Lc(n.serverSyncTree_,o,l)}let a=o;s.length>0&&(a=Va(n,o)),vn(n.eventQueue_,a,s)}function ix(n,e){CI(n,"connected",e),e===!1&&k4(n)}function N4(n,e){It(e,(t,r)=>{CI(n,t,r)})}function CI(n,e,t){let r=new xe("/.info/"+e),i=Ze(t);n.infoData_.updateSnapshot(r,i);let o=Lc(n.infoSyncTree_,r,i);vn(n.eventQueue_,r,o)}function Yp(n){return n.nextWriteId_++}function x4(n,e,t){let r=h4(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let o=Ze(i).withIndex(e._queryParams.getIndex());kE(n.serverSyncTree_,e,t,!0);let s;if(e._queryParams.loadsAllData())s=Lc(n.serverSyncTree_,e._path,o);else{let a=Rc(n.serverSyncTree_,e);s=Qx(n.serverSyncTree_,e._path,o,a)}return vn(n.eventQueue_,e._path,s),xp(n.serverSyncTree_,e,t,null,!0),o},i=>(Ha(n,"get for query "+ut(e)+" failed: "+i),Promise.reject(new Error(i))))}function DI(n,e,t,r,i){Ha(n,"set",{path:e.toString(),value:t,priority:r});let o=$c(n),s=Ze(t,r),a=qp(n.serverSyncTree_,e),l=vI(s,a,o),c=Yp(n),d=gI(n.serverSyncTree_,e,l,c,!0);Qp(n.eventQueue_,d),n.server_.put(e.toString(),s.val(!0),(g,m)=>{let v=g==="ok";v||jt("set at "+e+" failed: "+g);let T=Oi(n.serverSyncTree_,c,!v);vn(n.eventQueue_,e,T),Ui(n,i,g,m)});let f=bI(n,e);Va(n,f),vn(n.eventQueue_,f,[])}function P4(n,e,t,r){Ha(n,"update",{path:e.toString(),value:t});let i=!0,o=$c(n),s={};if(It(t,(a,l)=>{i=!1,s[a]=Xx(We(e,a),Ze(l),n.serverSyncTree_,o)}),i)Et("update() called with empty data.  Don't do anything."),Ui(n,r,"ok",void 0);else{let a=Yp(n),l=a4(n.serverSyncTree_,e,s,a);Qp(n.eventQueue_,l),n.server_.merge(e.toString(),t,(c,d)=>{let f=c==="ok";f||jt("update at "+e+" failed: "+c);let g=Oi(n.serverSyncTree_,a,!f),m=g.length>0?Va(n,e):e;vn(n.eventQueue_,m,g),Ui(n,r,c,d)}),It(t,c=>{let d=bI(n,We(e,c));Va(n,d)}),vn(n.eventQueue_,e,[])}}function k4(n){Ha(n,"onDisconnectEvents");let e=$c(n),t=Ip();EE(n.onDisconnect_,Ne(),(i,o)=>{let s=Xx(i,o,n.serverSyncTree_,e);Ba(t,i,s)});let r=[];EE(t,Ne(),(i,o)=>{r=r.concat(Lc(n.serverSyncTree_,i,o));let s=bI(n,i);Va(n,s)}),n.onDisconnect_=Ip(),vn(n.eventQueue_,Ne(),r)}function O4(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&wE(n.onDisconnect_,e),Ui(n,t,r,i)})}function ox(n,e,t,r){let i=Ze(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(o,s)=>{o==="ok"&&Ba(n.onDisconnect_,e,i),Ui(n,r,o,s)})}function F4(n,e,t,r,i){let o=Ze(t,r);n.server_.onDisconnectPut(e.toString(),o.val(!0),(s,a)=>{s==="ok"&&Ba(n.onDisconnect_,e,o),Ui(n,i,s,a)})}function V4(n,e,t,r){if(th(t)){Et("onDisconnect().update() called with empty data.  Don't do anything."),Ui(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,o)=>{i==="ok"&&It(t,(s,a)=>{let l=Ze(a);Ba(n.onDisconnect_,We(e,s),l)}),Ui(n,r,i,o)})}function L4(n,e,t){let r;ye(e._path)===".info"?r=kE(n.infoSyncTree_,e,t):r=kE(n.serverSyncTree_,e,t),oP(n.eventQueue_,e._path,r)}function BE(n,e,t){let r;ye(e._path)===".info"?r=xp(n.infoSyncTree_,e,t):r=xp(n.serverSyncTree_,e,t),oP(n.eventQueue_,e._path,r)}function uP(n){n.persistentConnection_&&n.persistentConnection_.interrupt(aP)}function j4(n){n.persistentConnection_&&n.persistentConnection_.resume(aP)}function Ha(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Et(t,...e)}function Ui(n,e,t,r){e&&ja(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),o=i;r&&(o+=": "+r);let s=new Error(o);s.code=i,e(s)}})}function B4(n,e,t,r,i,o){Ha(n,"transaction on "+e);let s={path:e,update:t,onComplete:r,status:null,order:lx(),applyLocally:o,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=TI(n,e,void 0);s.currentInputSnapshot=a;let l=s.update(a.val());if(l===void 0)s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete&&s.onComplete(null,!1,s.currentInputSnapshot);else{Bc("transaction failed: Data returned ",l,s.path),s.status=0;let c=zp(n.transactionQueueTree_,e),d=Zo(c)||[];d.push(s),EI(c,d);let f;typeof l=="object"&&l!==null&&Dn(l,".priority")?(f=di(l,".priority"),L(xc(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(qp(n.serverSyncTree_,e)||de.EMPTY_NODE).getPriority().val();let g=$c(n),m=Ze(l,f),v=vI(m,a,g);s.currentOutputSnapshotRaw=m,s.currentOutputSnapshotResolved=v,s.currentWriteId=Yp(n);let T=gI(n.serverSyncTree_,e,v,s.currentWriteId,s.applyLocally);vn(n.eventQueue_,e,T),Zp(n,n.transactionQueueTree_)}}function TI(n,e,t){return qp(n.serverSyncTree_,e,t)||de.EMPTY_NODE}function Zp(n,e=n.transactionQueueTree_){if(e||Jp(n,e),Zo(e)){let t=dP(n,e);L(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&U4(n,jc(e),t)}else eP(e)&&Wp(e,t=>{Zp(n,t)})}function U4(n,e,t){let r=t.map(c=>c.currentWriteId),i=TI(n,e,r),o=i,s=i.hash();for(let c=0;c<t.length;c++){let d=t[c];L(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let f=Qt(e,d.path);o=o.updateChild(f,d.currentOutputSnapshotRaw)}let a=o.val(!0),l=e;n.server_.put(l.toString(),a,c=>{Ha(n,"transaction put response",{path:l.toString(),status:c});let d=[];if(c==="ok"){let f=[];for(let g=0;g<t.length;g++)t[g].status=2,d=d.concat(Oi(n.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&f.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();Jp(n,zp(n.transactionQueueTree_,e)),Zp(n,n.transactionQueueTree_),vn(n.eventQueue_,e,d);for(let g=0;g<f.length;g++)ja(f[g])}else{if(c==="datastale")for(let f=0;f<t.length;f++)t[f].status===3?t[f].status=4:t[f].status=0;else{jt("transaction at "+l.toString()+" failed: "+c);for(let f=0;f<t.length;f++)t[f].status=4,t[f].abortReason=c}Va(n,e)}},s)}function Va(n,e){let t=cP(n,e),r=jc(t),i=dP(n,t);return $4(n,i,r),r}function $4(n,e,t){if(e.length===0)return;let r=[],i=[],s=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=Qt(t,l.path),d=!1,f;if(L(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)d=!0,f=l.abortReason,i=i.concat(Oi(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=M4)d=!0,f="maxretry",i=i.concat(Oi(n.serverSyncTree_,l.currentWriteId,!0));else{let g=TI(n,l.path,s);l.currentInputSnapshot=g;let m=e[a].update(g.val());if(m!==void 0){Bc("transaction failed: Data returned ",m,l.path);let v=Ze(m);typeof m=="object"&&m!=null&&Dn(m,".priority")||(v=v.updatePriority(g.getPriority()));let S=l.currentWriteId,O=$c(n),B=vI(v,g,O);l.currentOutputSnapshotRaw=v,l.currentOutputSnapshotResolved=B,l.currentWriteId=Yp(n),s.splice(s.indexOf(S),1),i=i.concat(gI(n.serverSyncTree_,l.path,B,l.currentWriteId,l.applyLocally)),i=i.concat(Oi(n.serverSyncTree_,S,!0))}else d=!0,f="nodata",i=i.concat(Oi(n.serverSyncTree_,l.currentWriteId,!0))}vn(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(g){setTimeout(g,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(f),!1,null))))}Jp(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)ja(r[a]);Zp(n,n.transactionQueueTree_)}function cP(n,e){let t,r=n.transactionQueueTree_;for(t=ye(e);t!==null&&Zo(r)===void 0;)r=zp(r,t),e=Ue(e),t=ye(e);return r}function dP(n,e){let t=[];return hP(n,e,t),t.sort((r,i)=>r.order-i.order),t}function hP(n,e,t){let r=Zo(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Wp(e,i=>{hP(n,i,t)})}function Jp(n,e){let t=Zo(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,EI(e,t.length>0?t:void 0)}Wp(e,r=>{Jp(n,r)})}function bI(n,e){let t=jc(cP(n,e)),r=zp(n.transactionQueueTree_,e);return E4(r,i=>{Qw(n,i)}),Qw(n,r),tP(r,i=>{Qw(n,i)}),t}function Qw(n,e){let t=Zo(e);if(t){let r=[],i=[],o=-1;for(let s=0;s<t.length;s++)t[s].status===3||(t[s].status===1?(L(o===s-1,"All SENT items should be at beginning of queue."),o=s,t[s].status=3,t[s].abortReason="set"):(L(t[s].status===0,"Unexpected transaction status in abort"),t[s].unwatcher(),i=i.concat(Oi(n.serverSyncTree_,t[s].currentWriteId,!0)),t[s].onComplete&&r.push(t[s].onComplete.bind(null,new Error("set"),!1,null))));o===-1?EI(e,void 0):t.length=o+1,vn(n.eventQueue_,jc(e),i);for(let s=0;s<r.length;s++)ja(r[s])}}function H4(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function q4(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):jt(`Invalid query segment '${t}' in query '${n}'`)}return e}var UE=function(n,e){let t=G4(n),r=t.namespace;t.domain==="firebase.com"&&mr(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&mr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||EG();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new pp(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new xe(t.pathString)}},G4=function(n){let e="",t="",r="",i="",o="",s=!0,a="https",l=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let d=n.indexOf("/");d===-1&&(d=n.length);let f=n.indexOf("?");f===-1&&(f=n.length),e=n.substring(0,Math.min(d,f)),d<f&&(i=H4(n.substring(d,f)));let g=q4(n.substring(Math.min(n.length,f)));c=e.indexOf(":"),c>=0?(s=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let m=e.slice(0,c);if(m.toLowerCase()==="localhost")t="localhost";else if(m.split(".").length<=2)t=m;else{let v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),t=e.substring(v+1),o=r}"ns"in g&&(o=g.ns)}return{host:e,port:l,domain:t,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}};var sx="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",z4=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,o=new Array(8);for(i=7;i>=0;i--)o[i]=sx.charAt(t%64),t=Math.floor(t/64);L(t===0,"Cannot push at time == 0");let s=o.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)s+=sx.charAt(e[i]);return L(s.length===20,"nextPushId: Length should be 20."),s}}();var Pp=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ut(this.snapshot.exportVal())}},kp=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Pc=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return L(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Op=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new wt;return O4(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){_n("OnDisconnect.remove",this._path);let e=new wt;return ox(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){_n("OnDisconnect.set",this._path),_r("OnDisconnect.set",e,this._path,!1);let t=new wt;return ox(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){_n("OnDisconnect.setWithPriority",this._path),_r("OnDisconnect.setWithPriority",e,this._path,!1),II("OnDisconnect.setWithPriority",t,!1);let r=new wt;return F4(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){_n("OnDisconnect.update",this._path),rP("OnDisconnect.update",e,this._path,!1);let t=new wt;return V4(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var Zt=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return _e(this._path)?null:iI(this._path)}get ref(){return new wn(this._repo,this._path)}get _queryIdentifier(){let e=zN(this._queryParams),t=nI(e);return t==="{}"?"default":t}get _queryObject(){return zN(this._queryParams)}isEqual(e){if(e=we(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=oI(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+XG(this._path)}};function Xp(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Hi(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===gr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Li)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Wr)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===$e){if(e!=null&&!xc(e)||t!=null&&!xc(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(L(n.getIndex()instanceof Cc||n.getIndex()===lI,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function eg(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var wn=class n extends Zt{constructor(e,t){super(e,t,new Sc,!1)}get parent(){let e=Mx(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},La=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new xe(e),r=$i(this.ref,e);return new n(this._node.getChild(t),r,$e)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,$i(this.ref,r),$e)))}hasChild(e){let t=new xe(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function SI(n,e){return n=we(n),n._checkNotDeleted("ref"),e!==void 0?$i(n._root,e):n._root}function AI(n,e){n=we(n),n._checkNotDeleted("refFromURL");let t=UE(e,n._repo.repoInfo_.nodeAdmin);iP("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&mr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),SI(n,t.path.toString())}function $i(n,e){return n=we(n),ye(n._path)===null?S4("child","path",e,!1):$a("child","path",e,!1),new wn(n._repo,We(n._path,e))}function fP(n,e){n=we(n),_n("push",n._path),_r("push",e,n._path,!0);let t=lP(n._repo),r=z4(t),i=$i(n,r),o=$i(n,r),s;return e!=null?s=tg(o,e).then(()=>o):s=Promise.resolve(o),i.then=s.then.bind(s),i.catch=s.then.bind(s,void 0),i}function pP(n){return _n("remove",n._path),tg(n,null)}function tg(n,e){n=we(n),_n("set",n._path),_r("set",e,n._path,!1);let t=new wt;return DI(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function gP(n,e){n=we(n),_n("setPriority",n._path),II("setPriority",e,!1);let t=new wt;return DI(n._repo,We(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function mP(n,e,t){if(_n("setWithPriority",n._path),_r("setWithPriority",e,n._path,!1),II("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new wt;return DI(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function yP(n,e){rP("update",e,n._path,!1);let t=new wt;return P4(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function _P(n){n=we(n);let e=new Pc(()=>{}),t=new kc(e);return x4(n._repo,n,t).then(r=>new La(r,new wn(n._repo,n._path),n._queryParams.getIndex()))}var kc=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new Pp("value",this,new La(e.snapshotNode,new wn(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new kp(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Fp=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new kp(this,e,t):null}createEvent(e,t){L(e.childName!=null,"Child events should have a childName.");let r=$i(new wn(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new Pp(e.type,this,new La(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Hc(n,e,t,r,i){let o;if(typeof r=="object"&&(o=void 0,i=r),typeof r=="function"&&(o=r),i&&i.onlyOnce){let l=t,c=(d,f)=>{BE(n._repo,n,a),l(d,f)};c.userCallback=t.userCallback,c.context=t.context,t=c}let s=new Pc(t,o||void 0),a=e==="value"?new kc(s):new Fp(e,s);return L4(n._repo,n,a),()=>BE(n._repo,n,a)}function ng(n,e,t,r){return Hc(n,"value",e,t,r)}function MI(n,e,t,r){return Hc(n,"child_added",e,t,r)}function RI(n,e,t,r){return Hc(n,"child_changed",e,t,r)}function NI(n,e,t,r){return Hc(n,"child_moved",e,t,r)}function xI(n,e,t,r){return Hc(n,"child_removed",e,t,r)}function PI(n,e,t){let r=null,i=t?new Pc(t):null;e==="value"?r=new kc(i):e&&(r=new Fp(e,i)),BE(n._repo,n,r)}var En=class{},Vp=class extends En{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){_r("endAt",this._value,e._path,!0);let t=yE(e._queryParams,this._value,this._key);if(eg(t),Hi(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Zt(e._repo,e._path,t,e._orderByCalled)}};function vP(n,e){return Uc("endAt","key",e,!0),new Vp(n,e)}var $E=class extends En{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){_r("endBefore",this._value,e._path,!1);let t=_z(e._queryParams,this._value,this._key);if(eg(t),Hi(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Zt(e._repo,e._path,t,e._orderByCalled)}};function wP(n,e){return Uc("endBefore","key",e,!0),new $E(n,e)}var Lp=class extends En{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){_r("startAt",this._value,e._path,!0);let t=mE(e._queryParams,this._value,this._key);if(eg(t),Hi(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Zt(e._repo,e._path,t,e._orderByCalled)}};function EP(n=null,e){return Uc("startAt","key",e,!0),new Lp(n,e)}var HE=class extends En{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){_r("startAfter",this._value,e._path,!1);let t=yz(e._queryParams,this._value,this._key);if(eg(t),Hi(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Zt(e._repo,e._path,t,e._orderByCalled)}};function IP(n,e){return Uc("startAfter","key",e,!0),new HE(n,e)}var qE=class extends En{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Zt(e._repo,e._path,gz(e._queryParams,this._limit),e._orderByCalled)}};function CP(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new qE(n)}var GE=class extends En{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Zt(e._repo,e._path,mz(e._queryParams,this._limit),e._orderByCalled)}};function DP(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new GE(n)}var zE=class extends En{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Xp(e,"orderByChild");let t=new xe(this._path);if(_e(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new Cc(t),i=Bp(e._queryParams,r);return Hi(i),new Zt(e._repo,e._path,i,!0)}};function TP(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return $a("orderByChild","path",n,!1),new zE(n)}var WE=class extends En{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Xp(e,"orderByKey");let t=Bp(e._queryParams,gr);return Hi(t),new Zt(e._repo,e._path,t,!0)}};function bP(){return new WE}var KE=class extends En{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Xp(e,"orderByPriority");let t=Bp(e._queryParams,$e);return Hi(t),new Zt(e._repo,e._path,t,!0)}};function SP(){return new KE}var QE=class extends En{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Xp(e,"orderByValue");let t=Bp(e._queryParams,lI);return Hi(t),new Zt(e._repo,e._path,t,!0)}};function AP(){return new QE}var YE=class extends En{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(_r("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Vp(this._value,this._key)._apply(new Lp(this._value,this._key)._apply(e))}};function MP(n,e){return Uc("equalTo","key",e,!0),new YE(n,e)}function Fn(n,...e){let t=we(n);for(let r of e)t=r._apply(t);return t}Xz(wn);i4(wn);var W4="FIREBASE_DATABASE_EMULATOR_HOST",ZE={},K4=!1;function Q4(n,e,t,r){n.repoInfo_=new pp(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function kI(n,e,t,r,i){let o=r||n.options.databaseURL;o===void 0&&(n.options.projectId||mr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Et("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let s=UE(o,i),a=s.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[W4]),c?(l=!0,o=`http://${c}?ns=${a.namespace}`,s=UE(o,i),a=s.repoInfo):l=!s.repoInfo.secure;let d=i&&l?new yc(yc.OWNER):new tE(n.name,n.options,e);iP("Invalid Firebase Database URL",s),_e(s.path)||mr("Database URL must point to the root of a Firebase Database (not including a child path).");let f=Z4(a,n,d,new eE(n.name,t));return new JE(f,n)}function Y4(n,e){let t=ZE[e];(!t||t[n.key]!==n)&&mr(`Database ${e}(${n.repoInfo_}) has already been deleted.`),uP(n),delete t[n.key]}function Z4(n,e,t,r){let i=ZE[e.name];i||(i={},ZE[e.name]=i);let o=i[n.toURLString()];return o&&mr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new jE(n,K4,t,r),i[n.toURLString()]=o,o}var JE=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(R4(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new wn(this._repo,Ne())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Y4(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&mr("Cannot call "+e+" on a deleted database.")}};function RP(){Ax.IS_TRANSPORT_INITIALIZED&&jt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function NP(){RP(),Ec.forceDisallow()}function xP(){RP(),Aa.forceDisallow(),Ec.forceAllow()}function PP(n,e,t,r={}){n=we(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&mr("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&mr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new yc(yc.OWNER);else if(r.mockUserToken){let s=typeof r.mockUserToken=="string"?r.mockUserToken:Jd(r.mockUserToken,n.app.options.projectId);o=new yc(s)}Q4(i,e,t,o)}function kP(n){n=we(n),n._checkNotDeleted("goOffline"),uP(n._repo)}function OP(n){n=we(n),n._checkNotDeleted("goOnline"),j4(n._repo)}function FP(n,e){cx(n,e)}function J4(n){tI(rh),go(new un("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return kI(r,i,o,t)},"PUBLIC").setMultipleInstances(!0)),Bn(MN,RN,n),Bn(MN,RN,"esm2017")}var X4={".sv":"timestamp"};function VP(){return X4}function LP(n){return{".sv":{increment:n}}}var XE=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function jP(n,e,t){var r;if(n=we(n),_n("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,o=new wt,s=(l,c,d)=>{let f=null;l?o.reject(l):(f=new La(d,new wn(n._repo,n._path),$e),o.resolve(new XE(c,f)))},a=ng(n,()=>{});return B4(n._repo,n._path,e,s,a,i),o.promise}sI.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};sI.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};J4();var eW="@firebase/database-compat",tW="2.0.2";var nW=new hi("@firebase/database-compat"),BP=function(n){let e="FIREBASE WARNING: "+n;nW.warn(e)};var rW=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(en(n,e)+"must be a boolean.")},iW=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(en(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var OI=class{constructor(e){this._delegate=e}cancel(e){re("OnDisconnect.cancel",0,1,arguments.length),pt("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){re("OnDisconnect.remove",0,1,arguments.length),pt("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){re("OnDisconnect.set",1,2,arguments.length),pt("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){re("OnDisconnect.setWithPriority",2,3,arguments.length),pt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),o=>r(o)),i}update(e,t){if(re("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let o=0;o<e.length;++o)i[""+o]=e[o];e=i,BP("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}pt("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var FI=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return re("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Jo=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return re("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return re("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return re("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return re("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return re("DataSnapshot.child",0,1,arguments.length),e=String(e),$a("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return re("DataSnapshot.hasChild",1,1,arguments.length),$a("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return re("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return re("DataSnapshot.forEach",1,1,arguments.length),pt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return re("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return re("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return re("DataSnapshot.ref",0,0,arguments.length),new Kr(this._database,this._delegate.ref)}get ref(){return this.getRef()}},rg=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var o;re("Query.on",2,4,arguments.length),pt("Query.on","callback",t,!1);let s=n.getCancelAndContextArgs_("Query.on",r,i),a=(c,d)=>{t.call(s.context,new Jo(this.database,c),d)};a.userCallback=t,a.context=s.context;let l=(o=s.cancel)===null||o===void 0?void 0:o.bind(s.context);switch(e){case"value":return ng(this._delegate,a,l),t;case"child_added":return MI(this._delegate,a,l),t;case"child_removed":return xI(this._delegate,a,l),t;case"child_changed":return RI(this._delegate,a,l),t;case"child_moved":return NI(this._delegate,a,l),t;default:throw new Error(en("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(re("Query.off",0,3,arguments.length),iW("Query.off",e,!0),pt("Query.off","callback",t,!0),ly("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,PI(this._delegate,e,i)}else PI(this._delegate,e)}get(){return _P(this._delegate).then(e=>new Jo(this.database,e))}once(e,t,r,i){re("Query.once",1,4,arguments.length),pt("Query.once","callback",t,!0);let o=n.getCancelAndContextArgs_("Query.once",r,i),s=new wt,a=(c,d)=>{let f=new Jo(this.database,c);t&&t.call(o.context,f,d),s.resolve(f)};a.userCallback=t,a.context=o.context;let l=c=>{o.cancel&&o.cancel.call(o.context,c),s.reject(c)};switch(e){case"value":ng(this._delegate,a,l,{onlyOnce:!0});break;case"child_added":MI(this._delegate,a,l,{onlyOnce:!0});break;case"child_removed":xI(this._delegate,a,l,{onlyOnce:!0});break;case"child_changed":RI(this._delegate,a,l,{onlyOnce:!0});break;case"child_moved":NI(this._delegate,a,l,{onlyOnce:!0});break;default:throw new Error(en("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(e){return re("Query.limitToFirst",1,1,arguments.length),new n(this.database,Fn(this._delegate,CP(e)))}limitToLast(e){return re("Query.limitToLast",1,1,arguments.length),new n(this.database,Fn(this._delegate,DP(e)))}orderByChild(e){return re("Query.orderByChild",1,1,arguments.length),new n(this.database,Fn(this._delegate,TP(e)))}orderByKey(){return re("Query.orderByKey",0,0,arguments.length),new n(this.database,Fn(this._delegate,bP()))}orderByPriority(){return re("Query.orderByPriority",0,0,arguments.length),new n(this.database,Fn(this._delegate,SP()))}orderByValue(){return re("Query.orderByValue",0,0,arguments.length),new n(this.database,Fn(this._delegate,AP()))}startAt(e=null,t){return re("Query.startAt",0,2,arguments.length),new n(this.database,Fn(this._delegate,EP(e,t)))}startAfter(e=null,t){return re("Query.startAfter",0,2,arguments.length),new n(this.database,Fn(this._delegate,IP(e,t)))}endAt(e=null,t){return re("Query.endAt",0,2,arguments.length),new n(this.database,Fn(this._delegate,vP(e,t)))}endBefore(e=null,t){return re("Query.endBefore",0,2,arguments.length),new n(this.database,Fn(this._delegate,wP(e,t)))}equalTo(e,t){return re("Query.equalTo",1,2,arguments.length),new n(this.database,Fn(this._delegate,MP(e,t)))}toString(){return re("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return re("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(re("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,pt(e,"cancel",i.cancel,!0),i.context=r,ly(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(en(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Kr(this.database,new wn(this._delegate._repo,this._delegate._path))}},Kr=class n extends rg{constructor(e,t){super(e,new Zt(t._repo,t._path,new Sc,!1)),this.database=e,this._delegate=t}getKey(){return re("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return re("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,$i(this._delegate,e))}getParent(){re("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return re("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){re("Reference.set",1,2,arguments.length),pt("Reference.set","onComplete",t,!0);let r=tg(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(re("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let o=0;o<e.length;++o)i[""+o]=e[o];e=i,BP("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_n("Reference.update",this._delegate._path),pt("Reference.update","onComplete",t,!0);let r=yP(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){re("Reference.setWithPriority",2,3,arguments.length),pt("Reference.setWithPriority","onComplete",r,!0);let i=mP(this._delegate,e,t);return r&&i.then(()=>r(null),o=>r(o)),i}remove(e){re("Reference.remove",0,1,arguments.length),pt("Reference.remove","onComplete",e,!0);let t=pP(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){re("Reference.transaction",1,3,arguments.length),pt("Reference.transaction","transactionUpdate",e,!1),pt("Reference.transaction","onComplete",t,!0),rW("Reference.transaction","applyLocally",r,!0);let i=jP(this._delegate,e,{applyLocally:r}).then(o=>new FI(o.committed,new Jo(this.database,o.snapshot)));return t&&i.then(o=>t(null,o.committed,o.snapshot),o=>t(o,!1,null)),i}setPriority(e,t){re("Reference.setPriority",1,2,arguments.length),pt("Reference.setPriority","onComplete",t,!0);let r=gP(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){re("Reference.push",0,2,arguments.length),pt("Reference.push","onComplete",t,!0);let r=fP(this._delegate,e),i=r.then(s=>new n(this.database,s));t&&i.then(()=>t(null),s=>t(s));let o=new n(this.database,r);return o.then=i.then.bind(i),o.catch=i.catch.bind(i,void 0),o}onDisconnect(){return _n("Reference.onDisconnect",this._delegate._path),new OI(new Op(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Xo=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:NP,forceLongPolling:xP}}useEmulator(e,t,r={}){PP(this._delegate,e,t,r)}ref(e){if(re("database.ref",0,1,arguments.length),e instanceof Kr){let t=AI(this._delegate,e.toString());return new Kr(this,t)}else{let t=SI(this._delegate,e);return new Kr(this,t)}}refFromURL(e){re("database.refFromURL",1,1,arguments.length);let r=AI(this._delegate,e);return new Kr(this,r)}goOffline(){return re("database.goOffline",0,0,arguments.length),kP(this._delegate)}goOnline(){return re("database.goOnline",0,0,arguments.length),OP(this._delegate)}};Xo.ServerValue={TIMESTAMP:VP(),increment:n=>LP(n)};function oW({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:o,nodeAdmin:s=!1}){tI(t);let a=new uy("database-standalone"),l=new nh("auth-internal",a);l.setComponent(new un("auth-internal",()=>r,"PRIVATE"));let c;return i&&(c=new nh("app-check-internal",a),c.setComponent(new un("app-check-internal",()=>i,"PRIVATE"))),{instance:new Xo(kI(n,l,c,e,s),n),namespace:o}}var sW=Object.freeze({__proto__:null,initStandalone:oW});var aW=Xo.ServerValue;function lW(n){n.INTERNAL.registerComponent(new un("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new Xo(i,r)},"PUBLIC").setServiceProps({Reference:Kr,Query:rg,Database:Xo,DataSnapshot:Jo,enableLogging:FP,INTERNAL:sW,ServerValue:aW}).setMultipleInstances(!0)),n.registerVersion(eW,tW)}lW(Dt);function qc(n,e,t="on",r=wo){return new pe(i=>{let o=null;return o=n[t](e,(s,a)=>{r.schedule(()=>{i.next({snapshot:s,prevKey:a})}),t==="once"&&r.schedule(()=>i.complete())},s=>{r.schedule(()=>i.error(s))}),t==="on"?{unsubscribe(){o!=null&&n.off(e,o)}}:{unsubscribe(){}}}).pipe(Z(i=>{let{snapshot:o,prevKey:s}=i,a=null;return o.exists()&&(a=o.key),{type:e,payload:o,prevKey:s,key:a}}),lu())}function uW(n){return typeof n=="string"}function cW(n){return typeof n.exportVal=="function"}function GP(n){return n==null}function zP(n){return typeof n.set=="function"}function UP(n,e){return zP(e)?e:n.ref(e)}function WP(n,e){if(uW(n))return e.stringCase();if(zP(n))return e.firebaseCase();if(cW(n))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof n}`)}function KP(n){return(GP(n)||n.length===0)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function QP(n,e,t){e=KP(e);let r=e.map(i=>qc(n,i,"on",t));return Us(...r)}function dW(n,e,t){let r=QP(n,e).pipe(sr((i,o)=>[...i,o],[]));return fW(n,r,t)}function hW(n,e){return qc(n,"value","on",e).pipe(Z(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}function fW(n,e,t){return hW(n,t).pipe(Vy(e),Z(([i,o])=>{let s=i.lastKeyToLoad,a=o.map(l=>l.key);return{actions:o,lastKeyToLoad:s,loadedKeys:a}}),Oy(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),Z(i=>i.actions))}function $P(n,e){return function(r,i){return WP(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function pW(n){return function(t){return t?WP(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function gW(n,e,t){return qc(n,"value","once",t).pipe(Qe(r=>{let i=[ne(r)];return e.forEach(o=>i.push(qc(n,o,"on",t))),Us(...i).pipe(sr(yW,[]))}),ou())}function YP(n,e){let t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function mW(n,e){if(GP(e))return 0;{let t=YP(n,e);return t===-1?n.length:t+1}}function yW(n,e){let{payload:t,prevKey:r,key:i}=e,o=YP(n,i),s=mW(n,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(l=>{let c={payload:l,type:"value",prevKey:a,key:l.key};return a=l.key,n=[...n,c],!1})}return n;case"child_added":if(o>-1)(n[o-1]?.key||null)!==r&&(n=n.filter(l=>l.payload.key!==t.key),n.splice(s,0,e));else{if(r==null)return[e,...n];n=n.slice(),n.splice(s,0,e)}return n;case"child_removed":return n.filter(a=>a.payload.key!==t.key);case"child_changed":return n.map(a=>a.payload.key===i?e:a);case"child_moved":if(o>-1){let a=n.splice(o,1)[0];return n=n.slice(),n.splice(s,0,a),n}return n;default:return n}}function HP(n,e,t){return e=KP(e),gW(n,e,t)}function _W(n,e,t){let r=e.schedulers.outsideAngular,i=V(De).run(()=>n.ref);return{query:n,update:$P(i,"update"),set:$P(i,"set"),push:o=>i.push(o),remove:pW(i),snapshotChanges(o){return HP(n,o,r).pipe(nt(t))},stateChanges(o){return QP(n,o,r).pipe(nt(t))},auditTrail(o){return dW(n,o,r).pipe(nt(t))},valueChanges(o,s){return HP(n,o,r).pipe(Z(l=>l.map(c=>s&&s.idField?fe($({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),nt(t))}}}function qP(n,e){return function(){return qc(n,"value","on",e)}}function vW(n,e,t){return{query:n,snapshotChanges(){return qP(n,e.schedulers.outsideAngular)().pipe(nt(t))},update(r){return n.ref.update(r)},set(r){return n.ref.set(r)},remove(){return n.ref.remove()},valueChanges(){return qP(n,e.schedulers.outsideAngular)().pipe(nt(t),Z(i=>i.payload.exists()?i.payload.val():null))}}}var wW=new z("angularfire2.realtimeDatabaseURL"),EW=new z("angularfire2.database.use-emulator"),ig=(()=>{class n{schedulers;database;injector=V(it);constructor(t,r,i,o,s,a,l,c,d,f,g,m,v,T,S){this.schedulers=a;let O=l,B=qo(t,s,r);c&&cc(B,s,d,g,m,v,f,T),this.database=ba(`${B.name}.database.${i}`,"AngularFireDatabase",B.name,()=>{let F=s.runOutsideAngular(()=>B.database(i||void 0));return O&&F.useEmulator(...O),F},[O])}list(t,r){let i=V(De).runOutsideAngular(()=>UP(this.database,t)),o=i;return r&&(o=r(i)),_W(o,this,this.injector)}object(t){let r=V(De).runOutsideAngular(()=>UP(this.database,t));return vW(r,this,this.injector)}createPushId(){return V(De).runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||n)(j(Pi),j(ki,8),j(wW,8),j(on),j(De),j(Ho),j(EW,8),j(dc,8),j(ic,8),j(oc,8),j(sc,8),j(ac,8),j(lc,8),j(uc,8),j(xi,8))};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var ZP=(()=>{class n{constructor(t){this.db=t,this.dbPath="/PowerData",this.monitorRef=t.list(this.dbPath)}getAllMonitoringView(){return this.monitorRef}getMonitoringView(t){return this.db.object(`${this.dbPath}/${t}`)}static{this.\u0275fac=function(r){return new(r||n)(j(ig))}}static{this.\u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function DW(n,e){if(n&1&&(Q(0,"option",34),ie(1),Y()),n&2){let t=e.$implicit;$r("value",t.energy_kWh),Re(),Kt(" ",t.energy_kWh," kWh ")}}function TW(n,e){if(n&1&&(Q(0,"tr")(1,"td"),ie(2),Y(),Q(3,"td",8),ie(4),Y(),Q(5,"td"),ie(6),Y(),Q(7,"td",8),ie(8),Y(),Q(9,"td"),ie(10),Y(),Q(11,"td"),ie(12),Y(),Q(13,"td"),ie(14),Y(),Q(15,"td"),ie(16),Y()()),n&2){let t=e.$implicit,r=MM();Re(2),Si(t.current_date+" "+t.current_time),Re(),$r("ngClass",r.getVoltageClass(t.voltage_V)),Re(),Kt("",t.voltage_V," V"),Re(2),Kt("",t.current_A," A"),Re(),$r("ngClass",r.getPowerFactorClass(t.power_factor)),Re(),Si(t.power_factor),Re(2),Kt("",t.frequency_Hz," Hz"),Re(2),Kt("",t.phase_angle_deg,"\xB0"),Re(2),Kt("",t.active_power_W," W"),Re(2),Kt("",t.energy_kWh," kWh")}}var JP=(()=>{class n{constructor(t){this.monitoringService=t,this.filteredMonitoringViewList=[],this.monitoringViewList=[],this.monitoringView={active_power_W:0,apparent_power_VA:0,current_A:0,current_date:"",current_time:"",energy_kWh:0,frequency_Hz:0,phase_angle_deg:0,power_factor:0,voltage_V:0},this.inputCost=0,this.consumptionKwh=0,this.startDate="",this.endDate="",this.startTime="",this.endTime=""}ngOnInit(){this.getAllMonitoringView()}getAllMonitoringView(){this.monitoringService.getAllMonitoringView().snapshotChanges().subscribe({next:t=>{t&&(this.monitoringViewList=[]),t.forEach(r=>{this.monitoringViewList.unshift(r.payload.toJSON()),this.monitoringView=this.monitoringViewList[0]})},error:t=>{},complete:()=>{}})}updateEnergy(){this.monitoringView.energy_kWh=this.selectedEnergy}applyFilters(){if(!this.startDate||!this.endDate){this.filteredMonitoringViewList=[...this.monitoringViewList];return}let t=new Date(`${this.startDate}T${this.startTime||"00:00:00"}`),r=new Date(`${this.endDate}T${this.endTime||"23:59:59"}`);this.filteredMonitoringViewList=this.monitoringViewList.filter(i=>{let[o,s,a]=i.current_date.split("/").map(Number),[l,c,d]=i.current_time.split(":").map(Number),f=new Date(a,o-1,s,l,c,d);return f>=t&&f<=r})}clearFilters(){this.startDate="",this.endDate="",this.startTime="",this.endTime="",this.filteredMonitoringViewList=[]}calculate(){this.inputCost>0&&(this.consumptionKwh=this.inputCost*this.selectedEnergy)}resetConsumption(){this.inputCost=0,this.consumptionKwh=0}convertDateTime(t){let r=t.substring(0,2),i=t.substring(2,4),o=t.substring(4,8),s=t.substring(8,10),a=t.substring(10,12);return`${r}/${i}/${o} ${s}:${a}`}getVoltageClass(t){return t===220?"green":t>=200&&t<=219||t>=221&&t<=240?"yellow":t<200||t>240?"red":""}getPowerFactorClass(t){return t>=.95&&t<=1?"green":t>=.85&&t<=.94?"yellow":t<.85?"red":""}static{this.\u0275fac=function(r){return new(r||n)(ke(ZP))}}static{this.\u0275cmp=ca({type:n,selectors:[["app-monitoring-view"]],decls:134,vars:21,consts:[[1,"container","mt-4"],[1,"row","mb-4"],[1,"col-12"],[1,"text-center"],[1,"row"],[1,"col-12","col-md-6"],[1,"table","table-bordered"],["colspan","2",1,"text-center"],[3,"ngClass"],[1,"wider-dropdown",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"input-group"],["type","number","placeholder","Unit Value kWh","name","inputCost",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-sm","btn-primary",3,"click"],["type","text","readonly","","disabled","",1,"form-control",3,"value"],[1,"d-flex","justify-content-between","align-items-center"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"filters","mt-4"],[1,"filter-row"],[1,"filter-item"],["for","startDate"],["type","date","id","startDate",3,"ngModelChange","change","ngModel"],["for","endDate"],["type","date","id","endDate",3,"ngModelChange","change","ngModel"],["for","startTime"],["type","time","id","startTime",3,"ngModelChange","change","ngModel"],["for","endTime"],["type","time","id","endTime",3,"ngModelChange","change","ngModel"],[1,"button-row"],[1,"btn","btn-primary","small",3,"click"],[1,"btn","btn-secondary","small",3,"click"],[1,"table-container","mt-3"],[1,"table","table-striped","table-bordered"],[4,"ngFor","ngForOf"],[3,"value"]],template:function(r,i){r&1&&(Q(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),ie(4,"REMOTE ELECTRICAL ANALYZER AND LOGGER"),Y()()(),Q(5,"div",4)(6,"div",5)(7,"table",6)(8,"thead")(9,"tr")(10,"th",7),ie(11,"Electrical Measurements"),Y()()(),Q(12,"tbody")(13,"tr")(14,"td"),ie(15,"Date"),Y(),Q(16,"td"),ie(17),Y()(),Q(18,"tr")(19,"td"),ie(20,"Time"),Y(),Q(21,"td"),ie(22),Y()(),Q(23,"tr")(24,"td"),ie(25,"Voltage"),Y(),Q(26,"td",8),ie(27),Y()(),Q(28,"tr")(29,"td"),ie(30,"Current"),Y(),Q(31,"td"),ie(32),Y()(),Q(33,"tr")(34,"td"),ie(35,"Frequency"),Y(),Q(36,"td"),ie(37),Y()(),Q(38,"tr")(39,"td"),ie(40,"Active Power"),Y(),Q(41,"td"),ie(42),Y()(),Q(43,"tr")(44,"td"),ie(45,"Power Factor"),Y(),Q(46,"td",8),ie(47),Y()(),Q(48,"tr")(49,"td"),ie(50,"Phase Angle"),Y(),Q(51,"td"),ie(52),Y()()()()(),Q(53,"div",5)(54,"table",6)(55,"thead")(56,"tr")(57,"th",7),ie(58,"Cost Calculation"),Y()()(),Q(59,"tbody")(60,"tr")(61,"td"),ie(62,"Energy Used"),Y(),Q(63,"td")(64,"select",9),Mi("ngModelChange",function(s){return Oo(i.selectedEnergy,s)||(i.selectedEnergy=s),s}),Mt("change",function(){return i.updateEnergy()}),Nf(65,DW,2,2,"option",10),Y()()(),Q(66,"tr")(67,"td"),ie(68,"Input Cost kWh"),Y(),Q(69,"td")(70,"div",11)(71,"input",12),Mi("ngModelChange",function(s){return Oo(i.inputCost,s)||(i.inputCost=s),s}),Y(),Q(72,"button",13),Mt("click",function(){return i.calculate()}),ie(73,"Send"),Y()()()(),Q(74,"tr")(75,"td"),ie(76,"Cost 1 kWh"),Y(),Q(77,"td"),ko(78,"input",14),Y()(),Q(79,"tr")(80,"td"),ie(81,"Consumption in PHP = kWh"),Y(),Q(82,"td")(83,"div",15)(84,"span"),ie(85),Y(),Q(86,"button",16),Mt("click",function(){return i.resetConsumption()}),ie(87,"Reset"),Y()()()()()()()(),Q(88,"div",17)(89,"div",18)(90,"div",19)(91,"label",20),ie(92,"Start Date:"),Y(),Q(93,"input",21),Mi("ngModelChange",function(s){return Oo(i.startDate,s)||(i.startDate=s),s}),Mt("change",function(){return i.applyFilters()}),Y()(),Q(94,"div",19)(95,"label",22),ie(96,"End Date:"),Y(),Q(97,"input",23),Mi("ngModelChange",function(s){return Oo(i.endDate,s)||(i.endDate=s),s}),Mt("change",function(){return i.applyFilters()}),Y()()(),Q(98,"div",18)(99,"div",19)(100,"label",24),ie(101,"Start Time:"),Y(),Q(102,"input",25),Mi("ngModelChange",function(s){return Oo(i.startTime,s)||(i.startTime=s),s}),Mt("change",function(){return i.applyFilters()}),Y()(),Q(103,"div",19)(104,"label",26),ie(105,"End Time:"),Y(),Q(106,"input",27),Mi("ngModelChange",function(s){return Oo(i.endTime,s)||(i.endTime=s),s}),Mt("change",function(){return i.applyFilters()}),Y()()(),Q(107,"div",28)(108,"button",29),Mt("click",function(){return i.applyFilters()}),ie(109,"Refresh"),Y(),Q(110,"button",30),Mt("click",function(){return i.clearFilters()}),ie(111,"Clear"),Y()()(),Q(112,"div",31)(113,"table",32)(114,"thead")(115,"tr")(116,"th"),ie(117,"DateTime"),Y(),Q(118,"th"),ie(119,"Voltage (V)"),Y(),Q(120,"th"),ie(121,"Current (A)"),Y(),Q(122,"th"),ie(123,"Power Factor"),Y(),Q(124,"th"),ie(125,"Frequency (Hz)"),Y(),Q(126,"th"),ie(127,"Phase Angle (\xB0)"),Y(),Q(128,"th"),ie(129,"Active Power (W)"),Y(),Q(130,"th"),ie(131,"Energy (kWh)"),Y()()(),Q(132,"tbody"),Nf(133,TW,17,10,"tr",33),Y()()()()),r&2&&(Re(17),Si(i.monitoringView.current_date),Re(5),Si(i.monitoringView.current_time),Re(4),$r("ngClass",i.getVoltageClass(i.monitoringView.voltage_V)),Re(),Kt("",i.monitoringView.voltage_V," V"),Re(5),Kt("",i.monitoringView.current_A," A"),Re(5),Kt("",i.monitoringView.frequency_Hz," Hz"),Re(5),Kt("",i.monitoringView.active_power_W," KW"),Re(4),$r("ngClass",i.getPowerFactorClass(i.monitoringView.power_factor)),Re(),Si(i.monitoringView.power_factor),Re(5),Kt("",i.monitoringView.phase_angle_deg," \xB0"),Re(12),Ai("ngModel",i.selectedEnergy),Re(),$r("ngForOf",i.filteredMonitoringViewList),Re(6),Ai("ngModel",i.inputCost),Re(7),Mv("value","1 kWh = \u20B1",i.inputCost,""),Re(7),Si(i.consumptionKwh),Re(8),Ai("ngModel",i.startDate),Re(4),Ai("ngModel",i.endDate),Re(5),Ai("ngModel",i.startTime),Re(4),Ai("ngModel",i.endTime),Re(27),$r("ngForOf",i.filteredMonitoringViewList))},dependencies:[uN,sN,lN,sp,Pw,lp,nN,xw,Mu,HM,qM],styles:["button[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{padding:.4rem 1rem;font-size:.875rem;width:50%}.filters[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-top:50px}.filter-row[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap}.filter-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}.filters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:.25rem}.button-row[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:10px}button.small[_ngcontent-%COMP%]{font-size:.875rem;padding:.4rem 1rem}button[_ngcontent-%COMP%]{padding:.6rem 1.2rem;font-size:1rem}.table-container[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;overflow-x:auto;margin-top:15px;width:100%;display:block}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;table-layout:auto}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{word-wrap:break-word;text-overflow:ellipsis;overflow:hidden}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #ddd}.green[_ngcontent-%COMP%]{color:#57a857}.yellow[_ngcontent-%COMP%]{color:gold}.red[_ngcontent-%COMP%]{color:red}@media (max-width: 768px){.col-md-6[_ngcontent-%COMP%]{width:100%}.filter-row[_ngcontent-%COMP%], .button-row[_ngcontent-%COMP%]{flex-direction:column}.wider-dropdown[_ngcontent-%COMP%]{width:100%}.table-container[_ngcontent-%COMP%]{max-height:350px}}@media (max-width: 576px){button[_ngcontent-%COMP%]{width:50%}.table-container[_ngcontent-%COMP%]{max-height:350px;overflow-x:auto;overflow-y:visible;width:100%}table[_ngcontent-%COMP%]{min-width:600px}}"]})}}return n})();var XP=[{path:"",component:JP}];var ek=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},tk={};var Qr,VI;(function(){var n;function e(I,_){function E(){}E.prototype=_.prototype,I.D=_.prototype,I.prototype=new E,I.prototype.constructor=I,I.C=function(C,D,A){for(var w=Array(arguments.length-2),Ar=2;Ar<arguments.length;Ar++)w[Ar-2]=arguments[Ar];return _.prototype[D].apply(C,w)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,_,E){E||(E=0);var C=Array(16);if(typeof _=="string")for(var D=0;16>D;++D)C[D]=_.charCodeAt(E++)|_.charCodeAt(E++)<<8|_.charCodeAt(E++)<<16|_.charCodeAt(E++)<<24;else for(D=0;16>D;++D)C[D]=_[E++]|_[E++]<<8|_[E++]<<16|_[E++]<<24;_=I.g[0],E=I.g[1],D=I.g[2];var A=I.g[3],w=_+(A^E&(D^A))+C[0]+3614090360&4294967295;_=E+(w<<7&4294967295|w>>>25),w=A+(D^_&(E^D))+C[1]+3905402710&4294967295,A=_+(w<<12&4294967295|w>>>20),w=D+(E^A&(_^E))+C[2]+606105819&4294967295,D=A+(w<<17&4294967295|w>>>15),w=E+(_^D&(A^_))+C[3]+3250441966&4294967295,E=D+(w<<22&4294967295|w>>>10),w=_+(A^E&(D^A))+C[4]+4118548399&4294967295,_=E+(w<<7&4294967295|w>>>25),w=A+(D^_&(E^D))+C[5]+1200080426&4294967295,A=_+(w<<12&4294967295|w>>>20),w=D+(E^A&(_^E))+C[6]+2821735955&4294967295,D=A+(w<<17&4294967295|w>>>15),w=E+(_^D&(A^_))+C[7]+4249261313&4294967295,E=D+(w<<22&4294967295|w>>>10),w=_+(A^E&(D^A))+C[8]+1770035416&4294967295,_=E+(w<<7&4294967295|w>>>25),w=A+(D^_&(E^D))+C[9]+2336552879&4294967295,A=_+(w<<12&4294967295|w>>>20),w=D+(E^A&(_^E))+C[10]+4294925233&4294967295,D=A+(w<<17&4294967295|w>>>15),w=E+(_^D&(A^_))+C[11]+2304563134&4294967295,E=D+(w<<22&4294967295|w>>>10),w=_+(A^E&(D^A))+C[12]+1804603682&4294967295,_=E+(w<<7&4294967295|w>>>25),w=A+(D^_&(E^D))+C[13]+4254626195&4294967295,A=_+(w<<12&4294967295|w>>>20),w=D+(E^A&(_^E))+C[14]+2792965006&4294967295,D=A+(w<<17&4294967295|w>>>15),w=E+(_^D&(A^_))+C[15]+1236535329&4294967295,E=D+(w<<22&4294967295|w>>>10),w=_+(D^A&(E^D))+C[1]+4129170786&4294967295,_=E+(w<<5&4294967295|w>>>27),w=A+(E^D&(_^E))+C[6]+3225465664&4294967295,A=_+(w<<9&4294967295|w>>>23),w=D+(_^E&(A^_))+C[11]+643717713&4294967295,D=A+(w<<14&4294967295|w>>>18),w=E+(A^_&(D^A))+C[0]+3921069994&4294967295,E=D+(w<<20&4294967295|w>>>12),w=_+(D^A&(E^D))+C[5]+3593408605&4294967295,_=E+(w<<5&4294967295|w>>>27),w=A+(E^D&(_^E))+C[10]+38016083&4294967295,A=_+(w<<9&4294967295|w>>>23),w=D+(_^E&(A^_))+C[15]+3634488961&4294967295,D=A+(w<<14&4294967295|w>>>18),w=E+(A^_&(D^A))+C[4]+3889429448&4294967295,E=D+(w<<20&4294967295|w>>>12),w=_+(D^A&(E^D))+C[9]+568446438&4294967295,_=E+(w<<5&4294967295|w>>>27),w=A+(E^D&(_^E))+C[14]+3275163606&4294967295,A=_+(w<<9&4294967295|w>>>23),w=D+(_^E&(A^_))+C[3]+4107603335&4294967295,D=A+(w<<14&4294967295|w>>>18),w=E+(A^_&(D^A))+C[8]+1163531501&4294967295,E=D+(w<<20&4294967295|w>>>12),w=_+(D^A&(E^D))+C[13]+2850285829&4294967295,_=E+(w<<5&4294967295|w>>>27),w=A+(E^D&(_^E))+C[2]+4243563512&4294967295,A=_+(w<<9&4294967295|w>>>23),w=D+(_^E&(A^_))+C[7]+1735328473&4294967295,D=A+(w<<14&4294967295|w>>>18),w=E+(A^_&(D^A))+C[12]+2368359562&4294967295,E=D+(w<<20&4294967295|w>>>12),w=_+(E^D^A)+C[5]+4294588738&4294967295,_=E+(w<<4&4294967295|w>>>28),w=A+(_^E^D)+C[8]+2272392833&4294967295,A=_+(w<<11&4294967295|w>>>21),w=D+(A^_^E)+C[11]+1839030562&4294967295,D=A+(w<<16&4294967295|w>>>16),w=E+(D^A^_)+C[14]+4259657740&4294967295,E=D+(w<<23&4294967295|w>>>9),w=_+(E^D^A)+C[1]+2763975236&4294967295,_=E+(w<<4&4294967295|w>>>28),w=A+(_^E^D)+C[4]+1272893353&4294967295,A=_+(w<<11&4294967295|w>>>21),w=D+(A^_^E)+C[7]+4139469664&4294967295,D=A+(w<<16&4294967295|w>>>16),w=E+(D^A^_)+C[10]+3200236656&4294967295,E=D+(w<<23&4294967295|w>>>9),w=_+(E^D^A)+C[13]+681279174&4294967295,_=E+(w<<4&4294967295|w>>>28),w=A+(_^E^D)+C[0]+3936430074&4294967295,A=_+(w<<11&4294967295|w>>>21),w=D+(A^_^E)+C[3]+3572445317&4294967295,D=A+(w<<16&4294967295|w>>>16),w=E+(D^A^_)+C[6]+76029189&4294967295,E=D+(w<<23&4294967295|w>>>9),w=_+(E^D^A)+C[9]+3654602809&4294967295,_=E+(w<<4&4294967295|w>>>28),w=A+(_^E^D)+C[12]+3873151461&4294967295,A=_+(w<<11&4294967295|w>>>21),w=D+(A^_^E)+C[15]+530742520&4294967295,D=A+(w<<16&4294967295|w>>>16),w=E+(D^A^_)+C[2]+3299628645&4294967295,E=D+(w<<23&4294967295|w>>>9),w=_+(D^(E|~A))+C[0]+4096336452&4294967295,_=E+(w<<6&4294967295|w>>>26),w=A+(E^(_|~D))+C[7]+1126891415&4294967295,A=_+(w<<10&4294967295|w>>>22),w=D+(_^(A|~E))+C[14]+2878612391&4294967295,D=A+(w<<15&4294967295|w>>>17),w=E+(A^(D|~_))+C[5]+4237533241&4294967295,E=D+(w<<21&4294967295|w>>>11),w=_+(D^(E|~A))+C[12]+1700485571&4294967295,_=E+(w<<6&4294967295|w>>>26),w=A+(E^(_|~D))+C[3]+2399980690&4294967295,A=_+(w<<10&4294967295|w>>>22),w=D+(_^(A|~E))+C[10]+4293915773&4294967295,D=A+(w<<15&4294967295|w>>>17),w=E+(A^(D|~_))+C[1]+2240044497&4294967295,E=D+(w<<21&4294967295|w>>>11),w=_+(D^(E|~A))+C[8]+1873313359&4294967295,_=E+(w<<6&4294967295|w>>>26),w=A+(E^(_|~D))+C[15]+4264355552&4294967295,A=_+(w<<10&4294967295|w>>>22),w=D+(_^(A|~E))+C[6]+2734768916&4294967295,D=A+(w<<15&4294967295|w>>>17),w=E+(A^(D|~_))+C[13]+1309151649&4294967295,E=D+(w<<21&4294967295|w>>>11),w=_+(D^(E|~A))+C[4]+4149444226&4294967295,_=E+(w<<6&4294967295|w>>>26),w=A+(E^(_|~D))+C[11]+3174756917&4294967295,A=_+(w<<10&4294967295|w>>>22),w=D+(_^(A|~E))+C[2]+718787259&4294967295,D=A+(w<<15&4294967295|w>>>17),w=E+(A^(D|~_))+C[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(D+(w<<21&4294967295|w>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+A&4294967295}r.prototype.u=function(I,_){_===void 0&&(_=I.length);for(var E=_-this.blockSize,C=this.B,D=this.h,A=0;A<_;){if(D==0)for(;A<=E;)i(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<_;)if(C[D++]=I.charCodeAt(A++),D==this.blockSize){i(this,C),D=0;break}}else for(;A<_;)if(C[D++]=I[A++],D==this.blockSize){i(this,C),D=0;break}}this.h=D,this.o+=_},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;var E=8*this.o;for(_=I.length-8;_<I.length;++_)I[_]=E&255,E/=256;for(this.u(I),I=Array(16),_=E=0;4>_;++_)for(var C=0;32>C;C+=8)I[E++]=this.g[_]>>>C&255;return I};function o(I,_){var E=a;return Object.prototype.hasOwnProperty.call(E,I)?E[I]:E[I]=_(I)}function s(I,_){this.h=_;for(var E=[],C=!0,D=I.length-1;0<=D;D--){var A=I[D]|0;C&&A==_||(E[D]=A,C=!1)}this.g=E}var a={};function l(I){return-128<=I&&128>I?o(I,function(_){return new s([_|0],0>_?-1:0)}):new s([I|0],0>I?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return f;if(0>I)return S(c(-I));for(var _=[],E=1,C=0;I>=E;C++)_[C]=I/E|0,E*=4294967296;return new s(_,0)}function d(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return S(d(I.substring(1),_));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=c(Math.pow(_,8)),C=f,D=0;D<I.length;D+=8){var A=Math.min(8,I.length-D),w=parseInt(I.substring(D,D+A),_);8>A?(A=c(Math.pow(_,A)),C=C.j(A).add(c(w))):(C=C.j(E),C=C.add(c(w)))}return C}var f=l(0),g=l(1),m=l(16777216);n=s.prototype,n.m=function(){if(T(this))return-S(this).m();for(var I=0,_=1,E=0;E<this.g.length;E++){var C=this.i(E);I+=(0<=C?C:4294967296+C)*_,_*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(v(this))return"0";if(T(this))return"-"+S(this).toString(I);for(var _=c(Math.pow(I,6)),E=this,C="";;){var D=W(E,_).g;E=O(E,D.j(_));var A=((0<E.g.length?E.g[0]:E.h)>>>0).toString(I);if(E=D,v(E))return A+C;for(;6>A.length;)A="0"+A;C=A+C}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function v(I){if(I.h!=0)return!1;for(var _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function T(I){return I.h==-1}n.l=function(I){return I=O(this,I),T(I)?-1:v(I)?0:1};function S(I){for(var _=I.g.length,E=[],C=0;C<_;C++)E[C]=~I.g[C];return new s(E,~I.h).add(g)}n.abs=function(){return T(this)?S(this):this},n.add=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],C=0,D=0;D<=_;D++){var A=C+(this.i(D)&65535)+(I.i(D)&65535),w=(A>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);C=w>>>16,A&=65535,w&=65535,E[D]=w<<16|A}return new s(E,E[E.length-1]&-2147483648?-1:0)};function O(I,_){return I.add(S(_))}n.j=function(I){if(v(this)||v(I))return f;if(T(this))return T(I)?S(this).j(S(I)):S(S(this).j(I));if(T(I))return S(this.j(S(I)));if(0>this.l(m)&&0>I.l(m))return c(this.m()*I.m());for(var _=this.g.length+I.g.length,E=[],C=0;C<2*_;C++)E[C]=0;for(C=0;C<this.g.length;C++)for(var D=0;D<I.g.length;D++){var A=this.i(C)>>>16,w=this.i(C)&65535,Ar=I.i(D)>>>16,Nl=I.i(D)&65535;E[2*C+2*D]+=w*Nl,B(E,2*C+2*D),E[2*C+2*D+1]+=A*Nl,B(E,2*C+2*D+1),E[2*C+2*D+1]+=w*Ar,B(E,2*C+2*D+1),E[2*C+2*D+2]+=A*Ar,B(E,2*C+2*D+2)}for(C=0;C<_;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=_;C<2*_;C++)E[C]=0;return new s(E,0)};function B(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function F(I,_){this.g=I,this.h=_}function W(I,_){if(v(_))throw Error("division by zero");if(v(I))return new F(f,f);if(T(I))return _=W(S(I),_),new F(S(_.g),S(_.h));if(T(_))return _=W(I,S(_)),new F(S(_.g),_.h);if(30<I.g.length){if(T(I)||T(_))throw Error("slowDivide_ only works with positive integers.");for(var E=g,C=_;0>=C.l(I);)E=oe(E),C=oe(C);var D=X(E,1),A=X(C,1);for(C=X(C,2),E=X(E,2);!v(C);){var w=A.add(C);0>=w.l(I)&&(D=D.add(E),A=w),C=X(C,1),E=X(E,1)}return _=O(I,D.j(_)),new F(D,_)}for(D=f;0<=I.l(_);){for(E=Math.max(1,Math.floor(I.m()/_.m())),C=Math.ceil(Math.log(E)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),A=c(E),w=A.j(_);T(w)||0<w.l(I);)E-=C,A=c(E),w=A.j(_);v(A)&&(A=g),D=D.add(A),I=O(I,w)}return new F(D,I)}n.A=function(I){return W(this,I).h},n.and=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],C=0;C<_;C++)E[C]=this.i(C)&I.i(C);return new s(E,this.h&I.h)},n.or=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],C=0;C<_;C++)E[C]=this.i(C)|I.i(C);return new s(E,this.h|I.h)},n.xor=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],C=0;C<_;C++)E[C]=this.i(C)^I.i(C);return new s(E,this.h^I.h)};function oe(I){for(var _=I.g.length+1,E=[],C=0;C<_;C++)E[C]=I.i(C)<<1|I.i(C-1)>>>31;return new s(E,I.h)}function X(I,_){var E=_>>5;_%=32;for(var C=I.g.length-E,D=[],A=0;A<C;A++)D[A]=0<_?I.i(A+E)>>>_|I.i(A+E+1)<<32-_:I.i(A+E);return new s(D,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,VI=tk.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=d,Qr=tk.Integer=s}).apply(typeof ek<"u"?ek:typeof self<"u"?self:typeof window<"u"?window:{});var og=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Yr={};var LI,bW,qa,jI,Gc,sg,BI,UI,$I;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,h,p){return u==Array.prototype||u==Object.prototype||(u[h]=p.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof og=="object"&&og];for(var h=0;h<u.length;++h){var p=u[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(u,h){if(h)e:{var p=r;u=u.split(".");for(var y=0;y<u.length-1;y++){var b=u[y];if(!(b in p))break e;p=p[b]}u=u[u.length-1],y=p[u],h=h(y),h!=y&&h!=null&&e(p,u,{configurable:!0,writable:!0,value:h})}}function o(u,h){u instanceof String&&(u+="");var p=0,y=!1,b={next:function(){if(!y&&p<u.length){var R=p++;return{value:h(R,u[R]),done:!1}}return y=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}i("Array.prototype.values",function(u){return u||function(){return o(this,function(h,p){return p})}});var s=s||{},a=this||self;function l(u){var h=typeof u;return h=h!="object"?h:u?Array.isArray(u)?"array":h:"null",h=="array"||h=="object"&&typeof u.length=="number"}function c(u){var h=typeof u;return h=="object"&&u!=null||h=="function"}function d(u,h,p){return u.call.apply(u.bind,arguments)}function f(u,h,p){if(!u)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,y),u.apply(h,b)}}return function(){return u.apply(h,arguments)}}function g(u,h,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,g.apply(null,arguments)}function m(u,h){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),u.apply(this,y)}}function v(u,h){function p(){}p.prototype=h.prototype,u.aa=h.prototype,u.prototype=new p,u.prototype.constructor=u,u.Qb=function(y,b,R){for(var U=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)U[Le-2]=arguments[Le];return h.prototype[b].apply(y,U)}}function T(u){let h=u.length;if(0<h){let p=Array(h);for(let y=0;y<h;y++)p[y]=u[y];return p}return[]}function S(u,h){for(let p=1;p<arguments.length;p++){let y=arguments[p];if(l(y)){let b=u.length||0,R=y.length||0;u.length=b+R;for(let U=0;U<R;U++)u[b+U]=y[U]}else u.push(y)}}class O{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function B(u){return/^[\s\xa0]*$/.test(u)}function F(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function W(u){return W[" "](u),u}W[" "]=function(){};var oe=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function X(u,h,p){for(let y in u)h.call(p,u[y],y,u)}function I(u,h){for(let p in u)h.call(void 0,u[p],p,u)}function _(u){let h={};for(let p in u)h[p]=u[p];return h}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,h){let p,y;for(let b=1;b<arguments.length;b++){y=arguments[b];for(p in y)u[p]=y[p];for(let R=0;R<E.length;R++)p=E[R],Object.prototype.hasOwnProperty.call(y,p)&&(u[p]=y[p])}}function D(u){var h=1;u=u.split(":");let p=[];for(;0<h&&u.length;)p.push(u.shift()),h--;return u.length&&p.push(u.join(":")),p}function A(u){a.setTimeout(()=>{throw u},0)}function w(){var u=Pm;let h=null;return u.g&&(h=u.g,u.g=u.g.next,u.g||(u.h=null),h.next=null),h}class Ar{constructor(){this.h=this.g=null}add(h,p){let y=Nl.get();y.set(h,p),this.h?this.h.next=y:this.g=y,this.h=y}}var Nl=new O(()=>new VF,u=>u.reset());class VF{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let xl,Pl=!1,Pm=new Ar,HT=()=>{let u=a.Promise.resolve(void 0);xl=()=>{u.then(LF)}};var LF=()=>{for(var u;u=w();){try{u.h.call(u.g)}catch(p){A(p)}var h=Nl;h.j(u),100>h.h&&(h.h++,u.next=h.g,h.g=u)}Pl=!1};function ai(){this.s=this.s,this.C=this.C}ai.prototype.s=!1,ai.prototype.ma=function(){this.s||(this.s=!0,this.N())},ai.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Pt(u,h){this.type=u,this.g=this.target=h,this.defaultPrevented=!1}Pt.prototype.h=function(){this.defaultPrevented=!0};var jF=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,h=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return u}();function kl(u,h){if(Pt.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var p=this.type=u.type,y=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=h,h=u.relatedTarget){if(oe){e:{try{W(h.nodeName);var b=!0;break e}catch{}b=!1}b||(h=null)}}else p=="mouseover"?h=u.fromElement:p=="mouseout"&&(h=u.toElement);this.relatedTarget=h,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:BF[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&kl.aa.h.call(this)}}v(kl,Pt);var BF={2:"touch",3:"pen",4:"mouse"};kl.prototype.h=function(){kl.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ol="closure_listenable_"+(1e6*Math.random()|0),UF=0;function $F(u,h,p,y,b){this.listener=u,this.proxy=null,this.src=h,this.type=p,this.capture=!!y,this.ha=b,this.key=++UF,this.da=this.fa=!1}function Pd(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function kd(u){this.src=u,this.g={},this.h=0}kd.prototype.add=function(u,h,p,y,b){var R=u.toString();u=this.g[R],u||(u=this.g[R]=[],this.h++);var U=Om(u,h,y,b);return-1<U?(h=u[U],p||(h.fa=!1)):(h=new $F(h,this.src,R,!!y,b),h.fa=p,u.push(h)),h};function km(u,h){var p=h.type;if(p in u.g){var y=u.g[p],b=Array.prototype.indexOf.call(y,h,void 0),R;(R=0<=b)&&Array.prototype.splice.call(y,b,1),R&&(Pd(h),u.g[p].length==0&&(delete u.g[p],u.h--))}}function Om(u,h,p,y){for(var b=0;b<u.length;++b){var R=u[b];if(!R.da&&R.listener==h&&R.capture==!!p&&R.ha==y)return b}return-1}var Fm="closure_lm_"+(1e6*Math.random()|0),Vm={};function qT(u,h,p,y,b){if(y&&y.once)return zT(u,h,p,y,b);if(Array.isArray(h)){for(var R=0;R<h.length;R++)qT(u,h[R],p,y,b);return null}return p=Um(p),u&&u[Ol]?u.K(h,p,c(y)?!!y.capture:!!y,b):GT(u,h,p,!1,y,b)}function GT(u,h,p,y,b,R){if(!h)throw Error("Invalid event type");var U=c(b)?!!b.capture:!!b,Le=jm(u);if(Le||(u[Fm]=Le=new kd(u)),p=Le.add(h,p,y,U,R),p.proxy)return p;if(y=HF(),p.proxy=y,y.src=u,y.listener=p,u.addEventListener)jF||(b=U),b===void 0&&(b=!1),u.addEventListener(h.toString(),y,b);else if(u.attachEvent)u.attachEvent(KT(h.toString()),y);else if(u.addListener&&u.removeListener)u.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function HF(){function u(p){return h.call(u.src,u.listener,p)}let h=qF;return u}function zT(u,h,p,y,b){if(Array.isArray(h)){for(var R=0;R<h.length;R++)zT(u,h[R],p,y,b);return null}return p=Um(p),u&&u[Ol]?u.L(h,p,c(y)?!!y.capture:!!y,b):GT(u,h,p,!0,y,b)}function WT(u,h,p,y,b){if(Array.isArray(h))for(var R=0;R<h.length;R++)WT(u,h[R],p,y,b);else y=c(y)?!!y.capture:!!y,p=Um(p),u&&u[Ol]?(u=u.i,h=String(h).toString(),h in u.g&&(R=u.g[h],p=Om(R,p,y,b),-1<p&&(Pd(R[p]),Array.prototype.splice.call(R,p,1),R.length==0&&(delete u.g[h],u.h--)))):u&&(u=jm(u))&&(h=u.g[h.toString()],u=-1,h&&(u=Om(h,p,y,b)),(p=-1<u?h[u]:null)&&Lm(p))}function Lm(u){if(typeof u!="number"&&u&&!u.da){var h=u.src;if(h&&h[Ol])km(h.i,u);else{var p=u.type,y=u.proxy;h.removeEventListener?h.removeEventListener(p,y,u.capture):h.detachEvent?h.detachEvent(KT(p),y):h.addListener&&h.removeListener&&h.removeListener(y),(p=jm(h))?(km(p,u),p.h==0&&(p.src=null,h[Fm]=null)):Pd(u)}}}function KT(u){return u in Vm?Vm[u]:Vm[u]="on"+u}function qF(u,h){if(u.da)u=!0;else{h=new kl(h,this);var p=u.listener,y=u.ha||u.src;u.fa&&Lm(u),u=p.call(y,h)}return u}function jm(u){return u=u[Fm],u instanceof kd?u:null}var Bm="__closure_events_fn_"+(1e9*Math.random()>>>0);function Um(u){return typeof u=="function"?u:(u[Bm]||(u[Bm]=function(h){return u.handleEvent(h)}),u[Bm])}function kt(){ai.call(this),this.i=new kd(this),this.M=this,this.F=null}v(kt,ai),kt.prototype[Ol]=!0,kt.prototype.removeEventListener=function(u,h,p,y){WT(this,u,h,p,y)};function Ht(u,h){var p,y=u.F;if(y)for(p=[];y;y=y.F)p.push(y);if(u=u.M,y=h.type||h,typeof h=="string")h=new Pt(h,u);else if(h instanceof Pt)h.target=h.target||u;else{var b=h;h=new Pt(y,u),C(h,b)}if(b=!0,p)for(var R=p.length-1;0<=R;R--){var U=h.g=p[R];b=Od(U,y,!0,h)&&b}if(U=h.g=u,b=Od(U,y,!0,h)&&b,b=Od(U,y,!1,h)&&b,p)for(R=0;R<p.length;R++)U=h.g=p[R],b=Od(U,y,!1,h)&&b}kt.prototype.N=function(){if(kt.aa.N.call(this),this.i){var u=this.i,h;for(h in u.g){for(var p=u.g[h],y=0;y<p.length;y++)Pd(p[y]);delete u.g[h],u.h--}}this.F=null},kt.prototype.K=function(u,h,p,y){return this.i.add(String(u),h,!1,p,y)},kt.prototype.L=function(u,h,p,y){return this.i.add(String(u),h,!0,p,y)};function Od(u,h,p,y){if(h=u.i.g[String(h)],!h)return!0;h=h.concat();for(var b=!0,R=0;R<h.length;++R){var U=h[R];if(U&&!U.da&&U.capture==p){var Le=U.listener,Ct=U.ha||U.src;U.fa&&km(u.i,U),b=Le.call(Ct,y)!==!1&&b}}return b&&!y.defaultPrevented}function QT(u,h,p){if(typeof u=="function")p&&(u=g(u,p));else if(u&&typeof u.handleEvent=="function")u=g(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(u,h||0)}function YT(u){u.g=QT(()=>{u.g=null,u.i&&(u.i=!1,YT(u))},u.l);let h=u.h;u.h=null,u.m.apply(null,h)}class GF extends ai{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:YT(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Fl(u){ai.call(this),this.h=u,this.g={}}v(Fl,ai);var ZT=[];function JT(u){X(u.g,function(h,p){this.g.hasOwnProperty(p)&&Lm(h)},u),u.g={}}Fl.prototype.N=function(){Fl.aa.N.call(this),JT(this)},Fl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var $m=a.JSON.stringify,zF=a.JSON.parse,WF=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Hm(){}Hm.prototype.h=null;function XT(u){return u.h||(u.h=u.i())}function eb(){}var Vl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function qm(){Pt.call(this,"d")}v(qm,Pt);function Gm(){Pt.call(this,"c")}v(Gm,Pt);var co={},tb=null;function Fd(){return tb=tb||new kt}co.La="serverreachability";function nb(u){Pt.call(this,co.La,u)}v(nb,Pt);function Ll(u){let h=Fd();Ht(h,new nb(h))}co.STAT_EVENT="statevent";function rb(u,h){Pt.call(this,co.STAT_EVENT,u),this.stat=h}v(rb,Pt);function qt(u){let h=Fd();Ht(h,new rb(h,u))}co.Ma="timingevent";function ib(u,h){Pt.call(this,co.Ma,u),this.size=h}v(ib,Pt);function jl(u,h){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},h)}function Bl(){this.g=!0}Bl.prototype.xa=function(){this.g=!1};function KF(u,h,p,y,b,R){u.info(function(){if(u.g)if(R)for(var U="",Le=R.split("&"),Ct=0;Ct<Le.length;Ct++){var Me=Le[Ct].split("=");if(1<Me.length){var Ot=Me[0];Me=Me[1];var Ft=Ot.split("_");U=2<=Ft.length&&Ft[1]=="type"?U+(Ot+"="+Me+"&"):U+(Ot+"=redacted&")}}else U=null;else U=R;return"XMLHTTP REQ ("+y+") [attempt "+b+"]: "+h+`
`+p+`
`+U})}function QF(u,h,p,y,b,R,U){u.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+b+"]: "+h+`
`+p+`
`+R+" "+U})}function Ds(u,h,p,y){u.info(function(){return"XMLHTTP TEXT ("+h+"): "+ZF(u,p)+(y?" "+y:"")})}function YF(u,h){u.info(function(){return"TIMEOUT: "+h})}Bl.prototype.info=function(){};function ZF(u,h){if(!u.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(u=0;u<p.length;u++)if(Array.isArray(p[u])){var y=p[u];if(!(2>y.length)){var b=y[1];if(Array.isArray(b)&&!(1>b.length)){var R=b[0];if(R!="noop"&&R!="stop"&&R!="close")for(var U=1;U<b.length;U++)b[U]=""}}}}return $m(p)}catch{return h}}var Vd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ob={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},zm;function Ld(){}v(Ld,Hm),Ld.prototype.g=function(){return new XMLHttpRequest},Ld.prototype.i=function(){return{}},zm=new Ld;function li(u,h,p,y){this.j=u,this.i=h,this.l=p,this.R=y||1,this.U=new Fl(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new sb}function sb(){this.i=null,this.g="",this.h=!1}var ab={},Wm={};function Km(u,h,p){u.L=1,u.v=$d(Mr(h)),u.m=p,u.P=!0,lb(u,null)}function lb(u,h){u.F=Date.now(),jd(u),u.A=Mr(u.v);var p=u.A,y=u.R;Array.isArray(y)||(y=[String(y)]),Ib(p.i,"t",y),u.C=0,p=u.j.J,u.h=new sb,u.g=Bb(u.j,p?h:null,!u.m),0<u.O&&(u.M=new GF(g(u.Y,u,u.g),u.O)),h=u.U,p=u.g,y=u.ca;var b="readystatechange";Array.isArray(b)||(b&&(ZT[0]=b.toString()),b=ZT);for(var R=0;R<b.length;R++){var U=qT(p,b[R],y||h.handleEvent,!1,h.h||h);if(!U)break;h.g[U.key]=U}h=u.H?_(u.H):{},u.m?(u.u||(u.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,h)):(u.u="GET",u.g.ea(u.A,u.u,null,h)),Ll(),KF(u.i,u.u,u.A,u.l,u.R,u.m)}li.prototype.ca=function(u){u=u.target;let h=this.M;h&&Rr(u)==3?h.j():this.Y(u)},li.prototype.Y=function(u){try{if(u==this.g)e:{let Ft=Rr(this.g);var h=this.g.Ba();let Ss=this.g.Z();if(!(3>Ft)&&(Ft!=3||this.g&&(this.h.h||this.g.oa()||Mb(this.g)))){this.J||Ft!=4||h==7||(h==8||0>=Ss?Ll(3):Ll(2)),Qm(this);var p=this.g.Z();this.X=p;t:if(ub(this)){var y=Mb(this.g);u="";var b=y.length,R=Rr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ho(this),Ul(this);var U="";break t}this.h.i=new a.TextDecoder}for(h=0;h<b;h++)this.h.h=!0,u+=this.h.i.decode(y[h],{stream:!(R&&h==b-1)});y.length=0,this.h.g+=u,this.C=0,U=this.h.g}else U=this.g.oa();if(this.o=p==200,QF(this.i,this.u,this.A,this.l,this.R,Ft,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Le,Ct=this.g;if((Le=Ct.g?Ct.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(Le)){var Me=Le;break t}}Me=null}if(p=Me)Ds(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ym(this,p);else{this.o=!1,this.s=3,qt(12),ho(this),Ul(this);break e}}if(this.P){p=!0;let jn;for(;!this.J&&this.C<U.length;)if(jn=JF(this,U),jn==Wm){Ft==4&&(this.s=4,qt(14),p=!1),Ds(this.i,this.l,null,"[Incomplete Response]");break}else if(jn==ab){this.s=4,qt(15),Ds(this.i,this.l,U,"[Invalid Chunk]"),p=!1;break}else Ds(this.i,this.l,jn,null),Ym(this,jn);if(ub(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ft!=4||U.length!=0||this.h.h||(this.s=1,qt(16),p=!1),this.o=this.o&&p,!p)Ds(this.i,this.l,U,"[Invalid Chunked Response]"),ho(this),Ul(this);else if(0<U.length&&!this.W){this.W=!0;var Ot=this.j;Ot.g==this&&Ot.ba&&!Ot.M&&(Ot.j.info("Great, no buffering proxy detected. Bytes received: "+U.length),ny(Ot),Ot.M=!0,qt(11))}}else Ds(this.i,this.l,U,null),Ym(this,U);Ft==4&&ho(this),this.o&&!this.J&&(Ft==4?Fb(this.j,this):(this.o=!1,jd(this)))}else gV(this.g),p==400&&0<U.indexOf("Unknown SID")?(this.s=3,qt(12)):(this.s=0,qt(13)),ho(this),Ul(this)}}}catch{}finally{}};function ub(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function JF(u,h){var p=u.C,y=h.indexOf(`
`,p);return y==-1?Wm:(p=Number(h.substring(p,y)),isNaN(p)?ab:(y+=1,y+p>h.length?Wm:(h=h.slice(y,y+p),u.C=y+p,h)))}li.prototype.cancel=function(){this.J=!0,ho(this)};function jd(u){u.S=Date.now()+u.I,cb(u,u.I)}function cb(u,h){if(u.B!=null)throw Error("WatchDog timer not null");u.B=jl(g(u.ba,u),h)}function Qm(u){u.B&&(a.clearTimeout(u.B),u.B=null)}li.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(YF(this.i,this.A),this.L!=2&&(Ll(),qt(17)),ho(this),this.s=2,Ul(this)):cb(this,this.S-u)};function Ul(u){u.j.G==0||u.J||Fb(u.j,u)}function ho(u){Qm(u);var h=u.M;h&&typeof h.ma=="function"&&h.ma(),u.M=null,JT(u.U),u.g&&(h=u.g,u.g=null,h.abort(),h.ma())}function Ym(u,h){try{var p=u.j;if(p.G!=0&&(p.g==u||Zm(p.h,u))){if(!u.K&&Zm(p.h,u)&&p.G==3){try{var y=p.Da.g.parse(h)}catch{y=null}if(Array.isArray(y)&&y.length==3){var b=y;if(b[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<u.F)Wd(p),Gd(p);else break e;ty(p),qt(18)}}else p.za=b[1],0<p.za-p.T&&37500>b[2]&&p.F&&p.v==0&&!p.C&&(p.C=jl(g(p.Za,p),6e3));if(1>=fb(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else po(p,11)}else if((u.K||p.g==u)&&Wd(p),!B(h))for(b=p.Da.g.parse(h),h=0;h<b.length;h++){let Me=b[h];if(p.T=Me[0],Me=Me[1],p.G==2)if(Me[0]=="c"){p.K=Me[1],p.ia=Me[2];let Ot=Me[3];Ot!=null&&(p.la=Ot,p.j.info("VER="+p.la));let Ft=Me[4];Ft!=null&&(p.Aa=Ft,p.j.info("SVER="+p.Aa));let Ss=Me[5];Ss!=null&&typeof Ss=="number"&&0<Ss&&(y=1.5*Ss,p.L=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;let jn=u.g;if(jn){let Qd=jn.g?jn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qd){var R=y.h;R.g||Qd.indexOf("spdy")==-1&&Qd.indexOf("quic")==-1&&Qd.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(Jm(R,R.h),R.h=null))}if(y.D){let ry=jn.g?jn.g.getResponseHeader("X-HTTP-Session-Id"):null;ry&&(y.ya=ry,qe(y.I,y.D,ry))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-u.F,p.j.info("Handshake RTT: "+p.R+"ms")),y=p;var U=u;if(y.qa=jb(y,y.J?y.ia:null,y.W),U.K){pb(y.h,U);var Le=U,Ct=y.L;Ct&&(Le.I=Ct),Le.B&&(Qm(Le),jd(Le)),y.g=U}else kb(y);0<p.i.length&&zd(p)}else Me[0]!="stop"&&Me[0]!="close"||po(p,7);else p.G==3&&(Me[0]=="stop"||Me[0]=="close"?Me[0]=="stop"?po(p,7):ey(p):Me[0]!="noop"&&p.l&&p.l.ta(Me),p.v=0)}}Ll(4)}catch{}}var XF=class{constructor(u,h){this.g=u,this.map=h}};function db(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function hb(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function fb(u){return u.h?1:u.g?u.g.size:0}function Zm(u,h){return u.h?u.h==h:u.g?u.g.has(h):!1}function Jm(u,h){u.g?u.g.add(h):u.h=h}function pb(u,h){u.h&&u.h==h?u.h=null:u.g&&u.g.has(h)&&u.g.delete(h)}db.prototype.cancel=function(){if(this.i=gb(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function gb(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let h=u.i;for(let p of u.g.values())h=h.concat(p.D);return h}return T(u.i)}function eV(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var h=[],p=u.length,y=0;y<p;y++)h.push(u[y]);return h}h=[],p=0;for(y in u)h[p++]=u[y];return h}function tV(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var h=[];u=u.length;for(var p=0;p<u;p++)h.push(p);return h}h=[],p=0;for(let y in u)h[p++]=y;return h}}}function mb(u,h){if(u.forEach&&typeof u.forEach=="function")u.forEach(h,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,h,void 0);else for(var p=tV(u),y=eV(u),b=y.length,R=0;R<b;R++)h.call(void 0,y[R],p&&p[R],u)}var yb=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nV(u,h){if(u){u=u.split("&");for(var p=0;p<u.length;p++){var y=u[p].indexOf("="),b=null;if(0<=y){var R=u[p].substring(0,y);b=u[p].substring(y+1)}else R=u[p];h(R,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function fo(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof fo){this.h=u.h,Bd(this,u.j),this.o=u.o,this.g=u.g,Ud(this,u.s),this.l=u.l;var h=u.i,p=new ql;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),_b(this,p),this.m=u.m}else u&&(h=String(u).match(yb))?(this.h=!1,Bd(this,h[1]||"",!0),this.o=$l(h[2]||""),this.g=$l(h[3]||"",!0),Ud(this,h[4]),this.l=$l(h[5]||"",!0),_b(this,h[6]||"",!0),this.m=$l(h[7]||"")):(this.h=!1,this.i=new ql(null,this.h))}fo.prototype.toString=function(){var u=[],h=this.j;h&&u.push(Hl(h,vb,!0),":");var p=this.g;return(p||h=="file")&&(u.push("//"),(h=this.o)&&u.push(Hl(h,vb,!0),"@"),u.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&u.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&u.push("/"),u.push(Hl(p,p.charAt(0)=="/"?oV:iV,!0))),(p=this.i.toString())&&u.push("?",p),(p=this.m)&&u.push("#",Hl(p,aV)),u.join("")};function Mr(u){return new fo(u)}function Bd(u,h,p){u.j=p?$l(h,!0):h,u.j&&(u.j=u.j.replace(/:$/,""))}function Ud(u,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);u.s=h}else u.s=null}function _b(u,h,p){h instanceof ql?(u.i=h,lV(u.i,u.h)):(p||(h=Hl(h,sV)),u.i=new ql(h,u.h))}function qe(u,h,p){u.i.set(h,p)}function $d(u){return qe(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function $l(u,h){return u?h?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Hl(u,h,p){return typeof u=="string"?(u=encodeURI(u).replace(h,rV),p&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function rV(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var vb=/[#\/\?@]/g,iV=/[#\?:]/g,oV=/[#\?]/g,sV=/[#\?@]/g,aV=/#/g;function ql(u,h){this.h=this.g=null,this.i=u||null,this.j=!!h}function ui(u){u.g||(u.g=new Map,u.h=0,u.i&&nV(u.i,function(h,p){u.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=ql.prototype,n.add=function(u,h){ui(this),this.i=null,u=Ts(this,u);var p=this.g.get(u);return p||this.g.set(u,p=[]),p.push(h),this.h+=1,this};function wb(u,h){ui(u),h=Ts(u,h),u.g.has(h)&&(u.i=null,u.h-=u.g.get(h).length,u.g.delete(h))}function Eb(u,h){return ui(u),h=Ts(u,h),u.g.has(h)}n.forEach=function(u,h){ui(this),this.g.forEach(function(p,y){p.forEach(function(b){u.call(h,b,y,this)},this)},this)},n.na=function(){ui(this);let u=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let y=0;y<h.length;y++){let b=u[y];for(let R=0;R<b.length;R++)p.push(h[y])}return p},n.V=function(u){ui(this);let h=[];if(typeof u=="string")Eb(this,u)&&(h=h.concat(this.g.get(Ts(this,u))));else{u=Array.from(this.g.values());for(let p=0;p<u.length;p++)h=h.concat(u[p])}return h},n.set=function(u,h){return ui(this),this.i=null,u=Ts(this,u),Eb(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[h]),this.h+=1,this},n.get=function(u,h){return u?(u=this.V(u),0<u.length?String(u[0]):h):h};function Ib(u,h,p){wb(u,h),0<p.length&&(u.i=null,u.g.set(Ts(u,h),T(p)),u.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var y=h[p];let R=encodeURIComponent(String(y)),U=this.V(y);for(y=0;y<U.length;y++){var b=R;U[y]!==""&&(b+="="+encodeURIComponent(String(U[y]))),u.push(b)}}return this.i=u.join("&")};function Ts(u,h){return h=String(h),u.j&&(h=h.toLowerCase()),h}function lV(u,h){h&&!u.j&&(ui(u),u.i=null,u.g.forEach(function(p,y){var b=y.toLowerCase();y!=b&&(wb(this,y),Ib(this,b,p))},u)),u.j=h}function uV(u,h){let p=new Bl;if(a.Image){let y=new Image;y.onload=m(ci,p,"TestLoadImage: loaded",!0,h,y),y.onerror=m(ci,p,"TestLoadImage: error",!1,h,y),y.onabort=m(ci,p,"TestLoadImage: abort",!1,h,y),y.ontimeout=m(ci,p,"TestLoadImage: timeout",!1,h,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=u}else h(!1)}function cV(u,h){let p=new Bl,y=new AbortController,b=setTimeout(()=>{y.abort(),ci(p,"TestPingServer: timeout",!1,h)},1e4);fetch(u,{signal:y.signal}).then(R=>{clearTimeout(b),R.ok?ci(p,"TestPingServer: ok",!0,h):ci(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(b),ci(p,"TestPingServer: error",!1,h)})}function ci(u,h,p,y,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),y(p)}catch{}}function dV(){this.g=new WF}function hV(u,h,p){let y=p||"";try{mb(u,function(b,R){let U=b;c(b)&&(U=$m(b)),h.push(y+R+"="+encodeURIComponent(U))})}catch(b){throw h.push(y+"type="+encodeURIComponent("_badmap")),b}}function Gl(u){this.l=u.Ub||null,this.j=u.eb||!1}v(Gl,Hm),Gl.prototype.g=function(){return new Hd(this.l,this.j)},Gl.prototype.i=function(u){return function(){return u}}({});function Hd(u,h){kt.call(this),this.D=u,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(Hd,kt),n=Hd.prototype,n.open=function(u,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=h,this.readyState=1,Wl(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(h.body=u),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,zl(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Wl(this)),this.g&&(this.readyState=3,Wl(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Cb(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Cb(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var h=u.value?u.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!u.done}))&&(this.response=this.responseText+=h)}u.done?zl(this):Wl(this),this.readyState==3&&Cb(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,zl(this))},n.Qa=function(u){this.g&&(this.response=u,zl(this))},n.ga=function(){this.g&&zl(this)};function zl(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Wl(u)}n.setRequestHeader=function(u,h){this.u.append(u,h)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,u.push(p[0]+": "+p[1]),p=h.next();return u.join(`\r
`)};function Wl(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Hd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Db(u){let h="";return X(u,function(p,y){h+=y,h+=":",h+=p,h+=`\r
`}),h}function Xm(u,h,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=Db(p),typeof u=="string"?p!=null&&encodeURIComponent(String(p)):qe(u,h,p))}function et(u){kt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(et,kt);var fV=/^https?$/i,pV=["POST","PUT"];n=et.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,h,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);h=h?h.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():zm.g(),this.v=this.o?XT(this.o):XT(zm),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(u),!0),this.B=!1}catch(R){Tb(this,R);return}if(u=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var b in y)p.set(b,y[b]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let R of y.keys())p.set(R,y.get(R));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(R=>R.toLowerCase()=="content-type"),b=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(pV,h,void 0))||y||b||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[R,U]of p)this.g.setRequestHeader(R,U);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ab(this),this.u=!0,this.g.send(u),this.u=!1}catch(R){Tb(this,R)}};function Tb(u,h){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=h,u.m=5,bb(u),qd(u)}function bb(u){u.A||(u.A=!0,Ht(u,"complete"),Ht(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Ht(this,"complete"),Ht(this,"abort"),qd(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qd(this,!0)),et.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Sb(this):this.bb())},n.bb=function(){Sb(this)};function Sb(u){if(u.h&&typeof s<"u"&&(!u.v[1]||Rr(u)!=4||u.Z()!=2)){if(u.u&&Rr(u)==4)QT(u.Ea,0,u);else if(Ht(u,"readystatechange"),Rr(u)==4){u.h=!1;try{let U=u.Z();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var y;if(y=U===0){var b=String(u.D).match(yb)[1]||null;!b&&a.self&&a.self.location&&(b=a.self.location.protocol.slice(0,-1)),y=!fV.test(b?b.toLowerCase():"")}p=y}if(p)Ht(u,"complete"),Ht(u,"success");else{u.m=6;try{var R=2<Rr(u)?u.g.statusText:""}catch{R=""}u.l=R+" ["+u.Z()+"]",bb(u)}}finally{qd(u)}}}}function qd(u,h){if(u.g){Ab(u);let p=u.g,y=u.v[0]?()=>{}:null;u.g=null,u.v=null,h||Ht(u,"ready");try{p.onreadystatechange=y}catch{}}}function Ab(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Rr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Rr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var h=this.g.responseText;return u&&h.indexOf(u)==0&&(h=h.substring(u.length)),zF(h)}};function Mb(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function gV(u){let h={};u=(u.g&&2<=Rr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<u.length;y++){if(B(u[y]))continue;var p=D(u[y]);let b=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let R=h[b]||[];h[b]=R,R.push(p)}I(h,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Kl(u,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[u]||h}function Rb(u){this.Aa=0,this.i=[],this.j=new Bl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Kl("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Kl("baseRetryDelayMs",5e3,u),this.cb=Kl("retryDelaySeedMs",1e4,u),this.Wa=Kl("forwardChannelMaxRetries",2,u),this.wa=Kl("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new db(u&&u.concurrentRequestLimit),this.Da=new dV,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Rb.prototype,n.la=8,n.G=1,n.connect=function(u,h,p,y){qt(0),this.W=u,this.H=h||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.I=jb(this,null,this.W),zd(this)};function ey(u){if(Nb(u),u.G==3){var h=u.U++,p=Mr(u.I);if(qe(p,"SID",u.K),qe(p,"RID",h),qe(p,"TYPE","terminate"),Ql(u,p),h=new li(u,u.j,h),h.L=2,h.v=$d(Mr(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=Bb(h.j,null),h.g.ea(h.v)),h.F=Date.now(),jd(h)}Lb(u)}function Gd(u){u.g&&(ny(u),u.g.cancel(),u.g=null)}function Nb(u){Gd(u),u.u&&(a.clearTimeout(u.u),u.u=null),Wd(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function zd(u){if(!hb(u.h)&&!u.s){u.s=!0;var h=u.Ga;xl||HT(),Pl||(xl(),Pl=!0),Pm.add(h,u),u.B=0}}function mV(u,h){return fb(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=h.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=jl(g(u.Ga,u,h),Vb(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let b=new li(this,this.j,u),R=this.o;if(this.S&&(R?(R=_(R),C(R,this.S)):R=this.S),this.m!==null||this.O||(b.H=R,R=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(h+=y,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=Pb(this,b,h),p=Mr(this.I),qe(p,"RID",u),qe(p,"CVER",22),this.D&&qe(p,"X-HTTP-Session-Id",this.D),Ql(this,p),R&&(this.O?h="headers="+encodeURIComponent(String(Db(R)))+"&"+h:this.m&&Xm(p,this.m,R)),Jm(this.h,b),this.Ua&&qe(p,"TYPE","init"),this.P?(qe(p,"$req",h),qe(p,"SID","null"),b.T=!0,Km(b,p,null)):Km(b,p,h),this.G=2}}else this.G==3&&(u?xb(this,u):this.i.length==0||hb(this.h)||xb(this))};function xb(u,h){var p;h?p=h.l:p=u.U++;let y=Mr(u.I);qe(y,"SID",u.K),qe(y,"RID",p),qe(y,"AID",u.T),Ql(u,y),u.m&&u.o&&Xm(y,u.m,u.o),p=new li(u,u.j,p,u.B+1),u.m===null&&(p.H=u.o),h&&(u.i=h.D.concat(u.i)),h=Pb(u,p,1e3),p.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Jm(u.h,p),Km(p,y,h)}function Ql(u,h){u.H&&X(u.H,function(p,y){qe(h,y,p)}),u.l&&mb({},function(p,y){qe(h,y,p)})}function Pb(u,h,p){p=Math.min(u.i.length,p);var y=u.l?g(u.l.Na,u.l,u):null;e:{var b=u.i;let R=-1;for(;;){let U=["count="+p];R==-1?0<p?(R=b[0].g,U.push("ofs="+R)):R=0:U.push("ofs="+R);let Le=!0;for(let Ct=0;Ct<p;Ct++){let Me=b[Ct].g,Ot=b[Ct].map;if(Me-=R,0>Me)R=Math.max(0,b[Ct].g-100),Le=!1;else try{hV(Ot,U,"req"+Me+"_")}catch{y&&y(Ot)}}if(Le){y=U.join("&");break e}}}return u=u.i.splice(0,p),h.D=u,y}function kb(u){if(!u.g&&!u.u){u.Y=1;var h=u.Fa;xl||HT(),Pl||(xl(),Pl=!0),Pm.add(h,u),u.v=0}}function ty(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=jl(g(u.Fa,u),Vb(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Ob(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=jl(g(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,qt(10),Gd(this),Ob(this))};function ny(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Ob(u){u.g=new li(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var h=Mr(u.qa);qe(h,"RID","rpc"),qe(h,"SID",u.K),qe(h,"AID",u.T),qe(h,"CI",u.F?"0":"1"),!u.F&&u.ja&&qe(h,"TO",u.ja),qe(h,"TYPE","xmlhttp"),Ql(u,h),u.m&&u.o&&Xm(h,u.m,u.o),u.L&&(u.g.I=u.L);var p=u.g;u=u.ia,p.L=1,p.v=$d(Mr(h)),p.m=null,p.P=!0,lb(p,u)}n.Za=function(){this.C!=null&&(this.C=null,Gd(this),ty(this),qt(19))};function Wd(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Fb(u,h){var p=null;if(u.g==h){Wd(u),ny(u),u.g=null;var y=2}else if(Zm(u.h,h))p=h.D,pb(u.h,h),y=1;else return;if(u.G!=0){if(h.o)if(y==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var b=u.B;y=Fd(),Ht(y,new ib(y,p)),zd(u)}else kb(u);else if(b=h.s,b==3||b==0&&0<h.X||!(y==1&&mV(u,h)||y==2&&ty(u)))switch(p&&0<p.length&&(h=u.h,h.i=h.i.concat(p)),b){case 1:po(u,5);break;case 4:po(u,10);break;case 3:po(u,6);break;default:po(u,2)}}}function Vb(u,h){let p=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(p*=2),p*h}function po(u,h){if(u.j.info("Error code "+h),h==2){var p=g(u.fb,u),y=u.Xa;let b=!y;y=new fo(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Bd(y,"https"),$d(y),b?uV(y.toString(),p):cV(y.toString(),p)}else qt(2);u.G=0,u.l&&u.l.sa(h),Lb(u),Nb(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),qt(2)):(this.j.info("Failed to ping google.com"),qt(1))};function Lb(u){if(u.G=0,u.ka=[],u.l){let h=gb(u.h);(h.length!=0||u.i.length!=0)&&(S(u.ka,h),S(u.ka,u.i),u.h.i.length=0,T(u.i),u.i.length=0),u.l.ra()}}function jb(u,h,p){var y=p instanceof fo?Mr(p):new fo(p);if(y.g!="")h&&(y.g=h+"."+y.g),Ud(y,y.s);else{var b=a.location;y=b.protocol,h=h?h+"."+b.hostname:b.hostname,b=+b.port;var R=new fo(null);y&&Bd(R,y),h&&(R.g=h),b&&Ud(R,b),p&&(R.l=p),y=R}return p=u.D,h=u.ya,p&&h&&qe(y,p,h),qe(y,"VER",u.la),Ql(u,y),y}function Bb(u,h,p){if(h&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=u.Ca&&!u.pa?new et(new Gl({eb:p})):new et(u.pa),h.Ha(u.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ub(){}n=Ub.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Kd(){}Kd.prototype.g=function(u,h){return new ln(u,h)};function ln(u,h){kt.call(this),this.g=new Rb(h),this.l=u,this.h=h&&h.messageUrlParams||null,u=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(u?u["X-WebChannel-Content-Type"]=h.messageContentType:u={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(u?u["X-WebChannel-Client-Profile"]=h.va:u={"X-WebChannel-Client-Profile":h.va}),this.g.S=u,(u=h&&h.Sb)&&!B(u)&&(this.g.m=u),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!B(h)&&(this.g.D=h,u=this.h,u!==null&&h in u&&(u=this.h,h in u&&delete u[h])),this.j=new bs(this)}v(ln,kt),ln.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ln.prototype.close=function(){ey(this.g)},ln.prototype.o=function(u){var h=this.g;if(typeof u=="string"){var p={};p.__data__=u,u=p}else this.u&&(p={},p.__data__=$m(u),u=p);h.i.push(new XF(h.Ya++,u)),h.G==3&&zd(h)},ln.prototype.N=function(){this.g.l=null,delete this.j,ey(this.g),delete this.g,ln.aa.N.call(this)};function $b(u){qm.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var h=u.__sm__;if(h){e:{for(let p in h){u=p;break e}u=void 0}(this.i=u)&&(u=this.i,h=h!==null&&u in h?h[u]:void 0),this.data=h}else this.data=u}v($b,qm);function Hb(){Gm.call(this),this.status=1}v(Hb,Gm);function bs(u){this.g=u}v(bs,Ub),bs.prototype.ua=function(){Ht(this.g,"a")},bs.prototype.ta=function(u){Ht(this.g,new $b(u))},bs.prototype.sa=function(u){Ht(this.g,new Hb)},bs.prototype.ra=function(){Ht(this.g,"b")},Kd.prototype.createWebChannel=Kd.prototype.g,ln.prototype.send=ln.prototype.o,ln.prototype.open=ln.prototype.m,ln.prototype.close=ln.prototype.close,$I=Yr.createWebChannelTransport=function(){return new Kd},UI=Yr.getStatEventTarget=function(){return Fd()},BI=Yr.Event=co,sg=Yr.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Vd.NO_ERROR=0,Vd.TIMEOUT=8,Vd.HTTP_ERROR=6,Gc=Yr.ErrorCode=Vd,ob.COMPLETE="complete",jI=Yr.EventType=ob,eb.EventType=Vl,Vl.OPEN="a",Vl.CLOSE="b",Vl.ERROR="c",Vl.MESSAGE="d",kt.prototype.listen=kt.prototype.K,qa=Yr.WebChannel=eb,bW=Yr.FetchXmlHttpFactory=Gl,et.prototype.listenOnce=et.prototype.L,et.prototype.getLastError=et.prototype.Ka,et.prototype.getLastErrorCode=et.prototype.Ba,et.prototype.getStatus=et.prototype.Z,et.prototype.getResponseJson=et.prototype.Oa,et.prototype.getResponseText=et.prototype.oa,et.prototype.send=et.prototype.ea,et.prototype.setWithCredentials=et.prototype.Ha,LI=Yr.XhrIo=et}).apply(typeof og<"u"?og:typeof self<"u"?self:typeof window<"u"?window:{});var nk="@firebase/firestore";var ht=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ht.UNAUTHENTICATED=new ht(null),ht.GOOGLE_CREDENTIALS=new ht("google-credentials-uid"),ht.FIRST_PARTY=new ht("first-party-uid"),ht.MOCK_USER=new ht("mock-user");var El="11.2.0";var Yi=new hi("@firebase/firestore");function Qa(){return Yi.logLevel}function iO(n){Yi.setLogLevel(n)}function k(n,...e){if(Yi.logLevel<=Tn.DEBUG){let t=e.map(zD);Yi.debug(`Firestore (${El}): ${n}`,...t)}}function ot(n,...e){if(Yi.logLevel<=Tn.ERROR){let t=e.map(zD);Yi.error(`Firestore (${El}): ${n}`,...t)}}function Zn(n,...e){if(Yi.logLevel<=Tn.WARN){let t=e.map(zD);Yi.warn(`Firestore (${El}): ${n}`,...t)}}function zD(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function G(n="Unexpected state"){let e=`FIRESTORE (${El}) INTERNAL ASSERTION FAILED: `+n;throw ot(e),new Error(e)}function K(n,e){n||G()}function oO(n,e){n||G()}function H(n,e){return n}var x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},P=class extends Yb{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var _t=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var _g=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},KI=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ht.UNAUTHENTICATED))}shutdown(){}},QI=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},YI=class{constructor(e){this.t=e,this.currentUser=ht.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){K(this.o===void 0);let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),o=new _t;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new _t,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let l=o;e.enqueueRetryable(()=>N(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},a=l=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?a(l):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new _t)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(K(typeof r.accessToken=="string"),new _g(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return K(e===null||typeof e=="string"),new ht(e)}},ZI=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ht.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);let e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}},JI=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new ZI(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ht.FIRST_PARTY))}shutdown(){}invalidateToken(){}},XI=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},eC=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){K(this.o===void 0);let r=o=>{o.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,k("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(K(typeof t.token=="string"),this.R=t.token,new XI(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function SW(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var vg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=SW(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function le(n,e){return n<e?-1:n>e?1:0}function il(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function sO(n){return n+"\0"}var Je=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new P(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new P(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new P(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var J=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Je(0,0))}static max(){return new n(new Je(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var wg=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&G(),r===void 0?r=e.length-t:r>e.length-t&&G(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Math.sign(e.length-t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Qr.fromString(e.substring(4,e.length-2))}},Se=class n extends wg{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new P(x.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},AW=/^[_a-zA-Z][_a-zA-Z0-9]*$/,st=class n extends wg{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return AW.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new P(x.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new P(x.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new P(x.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new P(x.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var q=class n{constructor(e){this.path=e}static fromPath(e){return new n(Se.fromString(e))}static fromName(e){return new n(Se.fromString(e).popFirst(5))}static empty(){return new n(Se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Se.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Se.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Se(e.slice()))}};var ol=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function tC(n){return n.fields.find(e=>e.kind===2)}function ts(n){return n.fields.filter(e=>e.kind!==2)}ol.UNKNOWN_ID=-1;var tl=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var rd=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Vn.min())}};function aO(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=J.fromTimestamp(r===1e9?new Je(t+1,0):new Je(t,r));return new Vn(i,q.empty(),e)}function lO(n){return new Vn(n.readTime,n.key,-1)}var Vn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(J.min(),q.empty(),-1)}static max(){return new n(J.max(),q.empty(),-1)}};function WD(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=q.comparator(n.documentKey,e.documentKey),t!==0?t:le(n.largestBatchId,e.largestBatchId))}var uO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Eg=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function so(n){return N(this,null,function*(){if(n.code!==x.FAILED_PRECONDITION||n.message!==uO)throw n;k("LocalStore","Unexpectedly lost primary lease")})}var M=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&G(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},l=>r(l))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let l=0;l<o;l++){let c=l;t(e[c]).next(d=>{s[c]=d,++a,a===o&&r(s)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};var Ig=class n{static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(o){throw new as(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new _t,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new as(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=KD(r.target.error);this.V.reject(new as(e,i))}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(k("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new rC(t)}},Zi=class n{static delete(e){return k("SimpleDb","Removing database:",e),ns(window.indexedDB.deleteDatabase(e)).toPromise()}static p(){if(!Xd())return!1;if(n.S())return!0;let e=Yl(),t=n.D(e),r=0<t&&t<10,i=cO(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static S(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static C(e,t){return e.store(t)}static D(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.F=r,n.D(Yl())===12.2&&ot("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}M(e){return N(this,null,function*(){return this.db||(k("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{r(new as(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?r(new P(x.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new P(x.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new as(e,s))},i.onupgradeneeded=o=>{k("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;this.F.O(s,i.transaction,o.oldVersion,this.version).next(()=>{k("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}B(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return N(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.M(e);let a=Ig.open(this.db,e,o?"readonly":"readwrite",r),l=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),M.reject(c))).toPromise();return l.catch(()=>{}),yield a.m,l}catch(a){let l=a,c=l.name!=="FirebaseError"&&s<3;if(k("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function cO(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var nC=class{constructor(e){this.L=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.L=e}done(){this.k=!0}$(e){this.q=e}delete(){return ns(this.L.delete())}},as=class extends P{constructor(e,t){super(x.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function ao(n){return n.name==="IndexedDbTransactionError"}var rC=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(k("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(k("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ns(r)}add(e){return k("SimpleDb","ADD",this.store.name,e,e),ns(this.store.add(e))}get(e){return ns(this.store.get(e)).next(t=>(t===void 0&&(t=null),k("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return k("SimpleDb","DELETE",this.store.name,e),ns(this.store.delete(e))}count(){return k("SimpleDb","COUNT",this.store.name),ns(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(r.range);return new M((s,a)=>{o.onerror=l=>{a(l.target.error)},o.onsuccess=l=>{s(l.target.result)}})}{let o=this.cursor(r),s=[];return this.W(o,(a,l)=>{s.push(l)}).next(()=>s)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new M((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}j(e,t){k("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(o,s,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new M((r,i)=>{t.onerror=o=>{let s=KD(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}W(e,t){let r=[];return new M((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let a=s.target.result;if(!a)return void i();let l=new nC(a),c=t(a.primaryKey,a.value,l);if(c instanceof M){let d=c.catch(f=>(l.done(),M.reject(f)));r.push(d)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>M.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function ns(n){return new M((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=KD(r.target.error);t(i)}})}var rk=!1;function KD(n){let e=Zi.D(Yl());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new P("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return rk||(rk=!0,setTimeout(()=>{throw r},0)),r}}return n}var iC=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){k("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>N(this,null,function*(){this.task=null;try{k("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){ao(t)?k("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield so(t)}yield this.X(6e4)}))}},oC=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return N(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,o=!0;return M.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return k("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(i,o)).next(a=>(k("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}re(e,t){let r=e;return t.changes.forEach((i,o)=>{let s=lO(o);WD(s,r)>0&&(r=s)}),new Vn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var In=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Td(n){return n==null}function id(n){return n===0&&1/n==-1/0}function dO(n){return typeof n=="number"&&Number.isInteger(n)&&!id(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function $t(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=ik(e)),e=MW(n.get(t),e);return ik(e)}function MW(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function ik(n){return n+""}function vr(n){let e=n.length;if(K(e>=2),e===2)return K(n.charAt(0)===""&&n.charAt(1)===""),Se.emptyPath();let t=e-2,r=[],i="";for(let o=0;o<e;){let s=n.indexOf("",o);switch((s<0||s>t)&&G(),n.charAt(s+1)){case"":let a=n.substring(o,s),l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:G()}o=s+2}return new Se(r)}var ok=["userId","batchId"];function hg(n,e){return[n,$t(e)]}function hO(n,e,t){return[n,$t(e),t]}var RW={},NW=["prefixPath","collectionGroup","readTime","documentId"],xW=["prefixPath","collectionGroup","documentId"],PW=["collectionGroup","readTime","prefixPath","documentId"],kW=["canonicalId","targetId"],OW=["targetId","path"],FW=["path","targetId"],VW=["collectionId","parent"],LW=["indexId","uid"],jW=["uid","sequenceNumber"],BW=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],UW=["indexId","uid","orderedDocumentKey"],$W=["userId","collectionPath","documentId"],HW=["userId","collectionPath","largestBatchId"],qW=["userId","collectionGroup","largestBatchId"],fO=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],GW=[...fO,"documentOverlays"],pO=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],gO=pO,QD=[...gO,"indexConfiguration","indexState","indexEntries"],zW=QD,WW=[...QD,"globals"];var od=class extends Eg{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function vt(n,e){let t=H(n);return Zi.C(t._e,e)}function sk(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function lo(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function mO(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ze=class n{constructor(e,t){this.comparator=e,this.root=t||Er.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Er.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Er.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new el(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new el(this.root,e,this.comparator,!1)}getReverseIterator(){return new el(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new el(this.root,e,this.comparator,!0)}},el=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Er=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw G();let e=this.left.check();if(e!==this.right.check())throw G();return e+(this.isRed()?0:1)}};Er.EMPTY=null,Er.RED=!0,Er.BLACK=!1;Er.EMPTY=new class{constructor(){this.size=0}get key(){throw G()}get value(){throw G()}get color(){throw G()}get left(){throw G()}get right(){throw G()}copy(e,t,r,i,o){return this}insert(e,t,r){return new Er(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ve=class n{constructor(e){this.comparator=e,this.data=new ze(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Cg(this.data.getIterator())}getIteratorFrom(e){return new Cg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Cg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ga(n){return n.hasNext()?n.getNext():void 0}var Cn=class n{constructor(e){this.fields=e,e.sort(st.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ve(st.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return il(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Dg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function yO(){return typeof atob<"u"}var lt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Dg("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};lt.EMPTY_BYTE_STRING=new lt("");var KW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xr(n){if(K(!!n),typeof n=="string"){let e=0,t=KW.exec(n);if(K(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ke(n.seconds),nanos:Ke(n.nanos)}}function Ke(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ei(n){return typeof n=="string"?lt.fromBase64String(n):lt.fromUint8Array(n)}function mm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function ym(n){let e=n.mapValue.fields.__previous_value__;return mm(e)?ym(e):e}function sd(n){let e=Xr(n.mapValue.fields.__local_write_time__.timestampValue);return new Je(e.seconds,e.nanos)}var sC=class{constructor(e,t,r,i,o,s,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}},Ji=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ki={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},fg={nullValue:"NULL_VALUE"};function Xi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?mm(n)?4:_O(n)?9007199254740991:_m(n)?10:11:G()}function Dr(n,e){if(n===e)return!0;let t=Xi(n);if(t!==Xi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return sd(n).isEqual(sd(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=Xr(i.timestampValue),a=Xr(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return ei(i.bytesValue).isEqual(ei(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return Ke(i.geoPointValue.latitude)===Ke(o.geoPointValue.latitude)&&Ke(i.geoPointValue.longitude)===Ke(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Ke(i.integerValue)===Ke(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=Ke(i.doubleValue),a=Ke(o.doubleValue);return s===a?id(s)===id(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return il(n.arrayValue.values||[],e.arrayValue.values||[],Dr);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(sk(s)!==sk(a))return!1;for(let l in s)if(s.hasOwnProperty(l)&&(a[l]===void 0||!Dr(s[l],a[l])))return!1;return!0}(n,e);default:return G()}}function ad(n,e){return(n.values||[]).find(t=>Dr(t,e))!==void 0}function eo(n,e){if(n===e)return 0;let t=Xi(n),r=Xi(e);if(t!==r)return le(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return le(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=Ke(o.integerValue||o.doubleValue),l=Ke(s.integerValue||s.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return ak(n.timestampValue,e.timestampValue);case 4:return ak(sd(n),sd(e));case 5:return le(n.stringValue,e.stringValue);case 6:return function(o,s){let a=ei(o),l=ei(s);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),l=s.split("/");for(let c=0;c<a.length&&c<l.length;c++){let d=le(a[c],l[c]);if(d!==0)return d}return le(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=le(Ke(o.latitude),Ke(s.latitude));return a!==0?a:le(Ke(o.longitude),Ke(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return lk(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,l,c,d;let f=o.fields||{},g=s.fields||{},m=(a=f.value)===null||a===void 0?void 0:a.arrayValue,v=(l=g.value)===null||l===void 0?void 0:l.arrayValue,T=le(((c=m?.values)===null||c===void 0?void 0:c.length)||0,((d=v?.values)===null||d===void 0?void 0:d.length)||0);return T!==0?T:lk(m,v)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===Ki.mapValue&&s===Ki.mapValue)return 0;if(o===Ki.mapValue)return 1;if(s===Ki.mapValue)return-1;let a=o.fields||{},l=Object.keys(a),c=s.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){let g=le(l[f],d[f]);if(g!==0)return g;let m=eo(a[l[f]],c[d[f]]);if(m!==0)return m}return le(l.length,d.length)}(n.mapValue,e.mapValue);default:throw G()}}function ak(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return le(n,e);let t=Xr(n),r=Xr(e),i=le(t.seconds,r.seconds);return i!==0?i:le(t.nanos,r.nanos)}function lk(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=eo(t[i],r[i]);if(o)return o}return le(t.length,r.length)}function sl(n){return aC(n)}function aC(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Xr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ei(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return q.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=aC(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${aC(t.fields[s])}`;return i+"}"}(n.mapValue):G()}function pg(n){switch(Xi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=ym(n);return e?16+pg(e):16;case 5:return 2*n.stringValue.length;case 6:return ei(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,o)=>i+pg(o),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return lo(r.fields,(o,s)=>{i+=o.length+pg(s)}),i}(n.mapValue);default:throw G()}}function ls(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function lC(n){return!!n&&"integerValue"in n}function ld(n){return!!n&&"arrayValue"in n}function uk(n){return!!n&&"nullValue"in n}function ck(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function gg(n){return!!n&&"mapValue"in n}function _m(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Jc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return lo(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Jc(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Jc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function _O(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var vO={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function QW(n){return"nullValue"in n?fg:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ls(Ji.empty(),q.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?_m(n)?vO:{mapValue:{}}:G()}function YW(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ls(Ji.empty(),q.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?vO:"mapValue"in n?_m(n)?{mapValue:{}}:Ki:G()}function dk(n,e){let t=eo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function hk(n,e){let t=eo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Ut=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!gg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Jc(t)}setAll(e){let t=st.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=Jc(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());gg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Dr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];gg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){lo(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Jc(this.value))}};function wO(n){let e=[];return lo(n.fields,(t,r)=>{let i=new st([t]);if(gg(r)){let o=wO(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new Cn(e)}var ft=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,J.min(),J.min(),J.min(),Ut.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,J.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,J.min(),J.min(),Ut.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,J.min(),J.min(),Ut.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(J.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ut.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=J.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Tr=class{constructor(e,t){this.position=e,this.inclusive=t}};function fk(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=q.comparator(q.fromName(s.referenceValue),t.key):r=eo(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function pk(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Dr(n.position[t],e.position[t]))return!1;return!0}var us=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function ZW(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Tg=class{},Ee=class n extends Tg{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new dC(e,t,r):t==="array-contains"?new pC(e,r):t==="in"?new bg(e,r):t==="not-in"?new gC(e,r):t==="array-contains-any"?new mC(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new hC(e,r):new fC(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(eo(t,this.value)):t!==null&&Xi(this.value)===Xi(t)&&this.matchesComparison(eo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return G()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Fe=class n extends Tg{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return al(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function al(n){return n.op==="and"}function uC(n){return n.op==="or"}function YD(n){return EO(n)&&al(n)}function EO(n){for(let e of n.filters)if(e instanceof Fe)return!1;return!0}function cC(n){if(n instanceof Ee)return n.field.canonicalString()+n.op.toString()+sl(n.value);if(YD(n))return n.filters.map(e=>cC(e)).join(",");{let e=n.filters.map(t=>cC(t)).join(",");return`${n.op}(${e})`}}function IO(n,e){return n instanceof Ee?function(r,i){return i instanceof Ee&&r.op===i.op&&r.field.isEqual(i.field)&&Dr(r.value,i.value)}(n,e):n instanceof Fe?function(r,i){return i instanceof Fe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&IO(s,i.filters[a]),!0):!1}(n,e):void G()}function CO(n,e){let t=n.filters.concat(e);return Fe.create(t,n.op)}function DO(n){return n instanceof Ee?function(t){return`${t.field.canonicalString()} ${t.op} ${sl(t.value)}`}(n):n instanceof Fe?function(t){return t.op.toString()+" {"+t.getFilters().map(DO).join(" ,")+"}"}(n):"Filter"}var dC=class extends Ee{constructor(e,t,r){super(e,t,r),this.key=q.fromName(r.referenceValue)}matches(e){let t=q.comparator(e.key,this.key);return this.matchesComparison(t)}},hC=class extends Ee{constructor(e,t){super(e,"in",t),this.keys=TO("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},fC=class extends Ee{constructor(e,t){super(e,"not-in",t),this.keys=TO("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function TO(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>q.fromName(r.referenceValue))}var pC=class extends Ee{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return ld(t)&&ad(t.arrayValue,this.value)}},bg=class extends Ee{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&ad(this.value.arrayValue,t)}},gC=class extends Ee{constructor(e,t){super(e,"not-in",t)}matches(e){if(ad(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!ad(this.value.arrayValue,t)}},mC=class extends Ee{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!ld(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>ad(this.value.arrayValue,r))}};var yC=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}};function _C(n,e=null,t=[],r=[],i=null,o=null,s=null){return new yC(n,e,t,r,i,o,s)}function cs(n){let e=H(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>cC(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Td(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>sl(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>sl(r)).join(",")),e.ue=t}return e.ue}function bd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!ZW(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!IO(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!pk(n.startAt,e.startAt)&&pk(n.endAt,e.endAt)}function Sg(n){return q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ag(n,e){return n.filters.filter(t=>t instanceof Ee&&t.field.isEqual(e))}function gk(n,e,t){let r=fg,i=!0;for(let o of Ag(n,e)){let s=fg,a=!0;switch(o.op){case"<":case"<=":s=QW(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=fg}dk({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];dk({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function mk(n,e,t){let r=Ki,i=!0;for(let o of Ag(n,e)){let s=Ki,a=!0;switch(o.op){case">=":case">":s=YW(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=Ki}hk({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];hk({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}var Jn=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function bO(n,e,t,r,i,o,s,a){return new Jn(n,e,t,r,i,o,s,a)}function Il(n){return new Jn(n)}function yk(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ZD(n){return n.collectionGroup!==null}function nl(n){let e=H(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Ve(st.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new us(o,r))}),t.has(st.keyField().canonicalString())||e.ce.push(new us(st.keyField(),r))}return e.ce}function Jt(n){let e=H(n);return e.le||(e.le=JW(e,nl(n))),e.le}function JW(n,e){if(n.limitType==="F")return _C(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new us(i.field,o)});let t=n.endAt?new Tr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Tr(n.startAt.position,n.startAt.inclusive):null;return _C(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function vC(n,e){let t=n.filters.concat([e]);return new Jn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Mg(n,e,t){return new Jn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Sd(n,e){return bd(Jt(n),Jt(e))&&n.limitType===e.limitType}function SO(n){return`${cs(Jt(n))}|lt:${n.limitType}`}function Ya(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>DO(i)).join(", ")}]`),Td(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>sl(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>sl(i)).join(",")),`Target(${r})`}(Jt(n))}; limitType=${n.limitType})`}function Ad(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):q.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of nl(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,l){let c=fk(s,a,l);return s.inclusive?c<=0:c<0}(r.startAt,nl(r),i)||r.endAt&&!function(s,a,l){let c=fk(s,a,l);return s.inclusive?c>=0:c>0}(r.endAt,nl(r),i))}(n,e)}function AO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function MO(n){return(e,t)=>{let r=!1;for(let i of nl(n)){let o=XW(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function XW(n,e,t){let r=n.field.isKeyField()?q.comparator(e.key,t.key):function(o,s,a){let l=s.data.field(o),c=a.data.field(o);return l!==null&&c!==null?eo(l,c):G()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return G()}}var Xn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return mO(this.inner)}size(){return this.innerSize}};var e9=new ze(q.comparator);function an(){return e9}var RO=new ze(q.comparator);function Yc(...n){let e=RO;for(let t of n)e=e.insert(t.key,t);return e}function NO(n){let e=RO;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function wr(){return Xc()}function xO(){return Xc()}function Xc(){return new Xn(n=>n.toString(),(n,e)=>n.isEqual(e))}var t9=new ze(q.comparator),n9=new Ve(q.comparator);function he(...n){let e=n9;for(let t of n)e=e.add(t);return e}var r9=new Ve(le);function JD(){return r9}function XD(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:id(e)?"-0":e}}function PO(n){return{integerValue:""+n}}function kO(n,e){return dO(e)?PO(e):XD(n,e)}var ll=class{constructor(){this._=void 0}};function i9(n,e,t){return n instanceof to?function(i,o){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&mm(o)&&(o=ym(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof ti?FO(n,e):n instanceof ni?VO(n,e):function(i,o){let s=OO(i,o),a=_k(s)+_k(i.Pe);return lC(s)&&lC(i.Pe)?PO(a):XD(i.serializer,a)}(n,e)}function o9(n,e,t){return n instanceof ti?FO(n,e):n instanceof ni?VO(n,e):t}function OO(n,e){return n instanceof no?function(r){return lC(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var to=class extends ll{},ti=class extends ll{constructor(e){super(),this.elements=e}};function FO(n,e){let t=LO(e);for(let r of n.elements)t.some(i=>Dr(i,r))||t.push(r);return{arrayValue:{values:t}}}var ni=class extends ll{constructor(e){super(),this.elements=e}};function VO(n,e){let t=LO(e);for(let r of n.elements)t=t.filter(i=>!Dr(i,r));return{arrayValue:{values:t}}}var no=class extends ll{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function _k(n){return Ke(n.integerValue||n.doubleValue)}function LO(n){return ld(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var ds=class{constructor(e,t){this.field=e,this.transform=t}};function s9(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof ti&&i instanceof ti||r instanceof ni&&i instanceof ni?il(r.elements,i.elements,Dr):r instanceof no&&i instanceof no?Dr(r.Pe,i.Pe):r instanceof to&&i instanceof to}(n.transform,e.transform)}var wC=class{constructor(e,t){this.version=e,this.transformResults=t}},rt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function mg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var ul=class{};function jO(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new io(n.key,rt.none()):new ro(n.key,n.data,rt.none());{let t=n.data,r=Ut.empty(),i=new Ve(st.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new er(n.key,r,new Cn(i.toArray()),rt.none())}}function a9(n,e,t){n instanceof ro?function(i,o,s){let a=i.value.clone(),l=wk(i.fieldTransforms,o,s.transformResults);a.setAll(l),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof er?function(i,o,s){if(!mg(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=wk(i.fieldTransforms,o,s.transformResults),l=o.data;l.setAll(BO(i)),l.setAll(a),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function ed(n,e,t,r){return n instanceof ro?function(o,s,a,l){if(!mg(o.precondition,s))return a;let c=o.value.clone(),d=Ek(o.fieldTransforms,l,s);return c.setAll(d),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof er?function(o,s,a,l){if(!mg(o.precondition,s))return a;let c=Ek(o.fieldTransforms,l,s),d=s.data;return d.setAll(BO(o)),d.setAll(c),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(o,s,a){return mg(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function l9(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=OO(r.transform,i||null);o!=null&&(t===null&&(t=Ut.empty()),t.set(r.field,o))}return t||null}function vk(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&il(r,i,(o,s)=>s9(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var ro=class extends ul{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},er=class extends ul{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function BO(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function wk(n,e,t){let r=new Map;K(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,o9(s,a,t[i]))}return r}function Ek(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,i9(o,s,e))}return r}var io=class extends ul{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ud=class extends ul{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var cd=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&a9(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ed(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ed(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=xO();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let l=jO(s,a);l!==null&&r.set(i.key,l),s.isValidDocument()||s.convertToNoDocument(J.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),he())}isEqual(e){return this.batchId===e.batchId&&il(this.mutations,e.mutations,(t,r)=>vk(t,r))&&il(this.baseMutations,e.baseMutations,(t,r)=>vk(t,r))}},EC=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){K(e.mutations.length===r.length);let i=function(){return t9}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var dd=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var IC=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ct,be;function UO(n){switch(n){default:return G();case x.CANCELLED:case x.UNKNOWN:case x.DEADLINE_EXCEEDED:case x.RESOURCE_EXHAUSTED:case x.INTERNAL:case x.UNAVAILABLE:case x.UNAUTHENTICATED:return!1;case x.INVALID_ARGUMENT:case x.NOT_FOUND:case x.ALREADY_EXISTS:case x.PERMISSION_DENIED:case x.FAILED_PRECONDITION:case x.ABORTED:case x.OUT_OF_RANGE:case x.UNIMPLEMENTED:case x.DATA_LOSS:return!0}}function $O(n){if(n===void 0)return ot("GRPC error has no .code"),x.UNKNOWN;switch(n){case ct.OK:return x.OK;case ct.CANCELLED:return x.CANCELLED;case ct.UNKNOWN:return x.UNKNOWN;case ct.DEADLINE_EXCEEDED:return x.DEADLINE_EXCEEDED;case ct.RESOURCE_EXHAUSTED:return x.RESOURCE_EXHAUSTED;case ct.INTERNAL:return x.INTERNAL;case ct.UNAVAILABLE:return x.UNAVAILABLE;case ct.UNAUTHENTICATED:return x.UNAUTHENTICATED;case ct.INVALID_ARGUMENT:return x.INVALID_ARGUMENT;case ct.NOT_FOUND:return x.NOT_FOUND;case ct.ALREADY_EXISTS:return x.ALREADY_EXISTS;case ct.PERMISSION_DENIED:return x.PERMISSION_DENIED;case ct.FAILED_PRECONDITION:return x.FAILED_PRECONDITION;case ct.ABORTED:return x.ABORTED;case ct.OUT_OF_RANGE:return x.OUT_OF_RANGE;case ct.UNIMPLEMENTED:return x.UNIMPLEMENTED;case ct.DATA_LOSS:return x.DATA_LOSS;default:return G()}}(be=ct||(ct={}))[be.OK=0]="OK",be[be.CANCELLED=1]="CANCELLED",be[be.UNKNOWN=2]="UNKNOWN",be[be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",be[be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",be[be.NOT_FOUND=5]="NOT_FOUND",be[be.ALREADY_EXISTS=6]="ALREADY_EXISTS",be[be.PERMISSION_DENIED=7]="PERMISSION_DENIED",be[be.UNAUTHENTICATED=16]="UNAUTHENTICATED",be[be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",be[be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",be[be.ABORTED=10]="ABORTED",be[be.OUT_OF_RANGE=11]="OUT_OF_RANGE",be[be.UNIMPLEMENTED=12]="UNIMPLEMENTED",be[be.INTERNAL=13]="INTERNAL",be[be.UNAVAILABLE=14]="UNAVAILABLE",be[be.DATA_LOSS=15]="DATA_LOSS";var Ik=null;function HO(){return new TextEncoder}var u9=new Qr([4294967295,4294967295],0);function Ck(n){let e=HO().encode(n),t=new VI;return t.update(e),new Uint8Array(t.digest())}function Dk(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Qr([t,r],0),new Qr([i,o],0)]}var CC=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ss(`Invalid padding: ${t}`);if(r<0)throw new ss(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ss(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ss(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ie=Qr.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(Qr.fromNumber(r)));return i.compare(u9)===1&&(i=new Qr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ie).toNumber()}Ee(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let t=Ck(e),[r,i]=Dk(t);for(let o=0;o<this.hashCount;o++){let s=this.de(r,i,o);if(!this.Ee(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.Te===0)return;let t=Ck(e),[r,i]=Dk(t);for(let o=0;o<this.hashCount;o++){let s=this.de(r,i,o);this.Ae(s)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},ss=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var hd=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,fd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(J.min(),i,new ze(le),an(),he())}},fd=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,he(),he(),he())}};var rl=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Rg=class{constructor(e,t){this.targetId=e,this.me=t}},Ng=class{constructor(e,t,r=lt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},xg=class{constructor(){this.fe=0,this.ge=Tk(),this.pe=lt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=he(),t=he(),r=he();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:G()}}),new fd(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Tk()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,K(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},DC=class{constructor(e){this.Be=e,this.Le=new Map,this.ke=an(),this.qe=ag(),this.Qe=ag(),this.Ke=new ze(le)}$e(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(t,e.Ve):this.We(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.We(t,e.key,e.Ve)}Ge(e){this.forEachTarget(e,t=>{let r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.je(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.De(e.resumeToken));break;default:G()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Le.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){let t=e.targetId,r=e.me.count,i=this.Ye(t);if(i){let o=i.target;if(Sg(o))if(r===0){let s=new q(o.path);this.We(t,s,ft.newNoDocument(s,J.min()))}else K(r===1);else{let s=this.Ze(t);if(s!==r){let a=this.Xe(e),l=a?this.et(a,e,s):1;if(l!==0){this.He(t);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,c)}Ik?.tt(function(d,f,g,m,v){var T,S,O,B,F,W;let oe={localCacheCount:d,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},X=f.unchangedNames;return X&&(oe.bloomFilter={applied:v===0,hashCount:(T=X?.hashCount)!==null&&T!==void 0?T:0,bitmapLength:(B=(O=(S=X?.bits)===null||S===void 0?void 0:S.bitmap)===null||O===void 0?void 0:O.length)!==null&&B!==void 0?B:0,padding:(W=(F=X?.bits)===null||F===void 0?void 0:F.padding)!==null&&W!==void 0?W:0,mightContain:I=>{var _;return(_=m?.mightContain(I))!==null&&_!==void 0&&_}}),oe}(s,e.me,this.Be.nt(),a,l))}}}}Xe(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=ei(r).toUint8Array()}catch(l){if(l instanceof Dg)return Zn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new CC(s,i,o)}catch(l){return Zn(l instanceof ss?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Te===0?null:a}et(e,t,r){return t.me.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){let r=this.Be.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Be.nt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.We(t,o,null),i++)}),i}it(e){let t=new Map;this.Le.forEach((o,s)=>{let a=this.Ye(s);if(a){if(o.current&&Sg(a.target)){let l=new q(a.target.path);this.st(l).has(s)||this.ot(s,l)||this.We(s,l,ft.newNoDocument(l,e))}o.be&&(t.set(s,o.ve()),o.Ce())}});let r=he();this.Qe.forEach((o,s)=>{let a=!0;s.forEachWhile(l=>{let c=this.Ye(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));let i=new hd(e,t,this.Ke,this.ke,r);return this.ke=an(),this.qe=ag(),this.Qe=ag(),this.Ke=new ze(le),i}Ue(e,t){if(!this.je(e))return;let r=this.ot(e,t.key)?2:0;this.ze(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e)),this.Qe=this.Qe.insert(t.key,this._t(t.key).add(e))}We(e,t,r){if(!this.je(e))return;let i=this.ze(e);this.ot(e,t)?i.Fe(t,1):i.Me(t),this.Qe=this.Qe.insert(t,this._t(t).delete(e)),this.Qe=this.Qe.insert(t,this._t(t).add(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Le.delete(e)}Ze(e){let t=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let t=this.Le.get(e);return t||(t=new xg,this.Le.set(e,t)),t}_t(e){let t=this.Qe.get(e);return t||(t=new Ve(le),this.Qe=this.Qe.insert(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ve(le),this.qe=this.qe.insert(e,t)),t}je(e){let t=this.Ye(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){let t=this.Le.get(e);return t&&t.Se?null:this.Be.ut(e)}He(e){this.Le.set(e,new xg),this.Be.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}ot(e,t){return this.Be.getRemoteKeysForTarget(e).has(t)}};function ag(){return new ze(q.comparator)}function Tk(){return new ze(q.comparator)}var c9={asc:"ASCENDING",desc:"DESCENDING"},d9={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},h9={and:"AND",or:"OR"},TC=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function bC(n,e){return n.useProto3Json||Td(e)?e:{value:e}}function cl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qO(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function f9(n,e){return cl(n,e.toTimestamp())}function at(n){return K(!!n),J.fromTimestamp(function(t){let r=Xr(t);return new Je(r.seconds,r.nanos)}(n))}function eT(n,e){return SC(n,e).canonicalString()}function SC(n,e){let t=function(i){return new Se(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function GO(n){let e=Se.fromString(n);return K(t1(e)),e}function pd(n,e){return eT(n.databaseId,e.path)}function Ir(n,e){let t=GO(e);if(t.get(1)!==n.databaseId.projectId)throw new P(x.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new P(x.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new q(KO(t))}function zO(n,e){return eT(n.databaseId,e)}function WO(n){let e=GO(n);return e.length===4?Se.emptyPath():KO(e)}function AC(n){return new Se(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function KO(n){return K(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function bk(n,e,t){return{name:pd(n,e),fields:t.value.mapValue.fields}}function QO(n,e,t){let r=Ir(n,e.name),i=at(e.updateTime),o=e.createTime?at(e.createTime):J.min(),s=new Ut({mapValue:{fields:e.fields}}),a=ft.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function p9(n,e){return"found"in e?function(r,i){K(!!i.found),i.found.name,i.found.updateTime;let o=Ir(r,i.found.name),s=at(i.found.updateTime),a=i.found.createTime?at(i.found.createTime):J.min(),l=new Ut({mapValue:{fields:i.found.fields}});return ft.newFoundDocument(o,s,a,l)}(n,e):"missing"in e?function(r,i){K(!!i.missing),K(!!i.readTime);let o=Ir(r,i.missing),s=at(i.readTime);return ft.newNoDocument(o,s)}(n,e):G()}function g9(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:G()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(c,d){return c.useProto3Json?(K(d===void 0||typeof d=="string"),lt.fromBase64String(d||"")):(K(d===void 0||d instanceof Buffer||d instanceof Uint8Array),lt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(c){let d=c.code===void 0?x.UNKNOWN:$O(c.code);return new P(d,c.message||"")}(s);t=new Ng(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Ir(n,r.document.name),o=at(r.document.updateTime),s=r.document.createTime?at(r.document.createTime):J.min(),a=new Ut({mapValue:{fields:r.document.fields}}),l=ft.newFoundDocument(i,o,s,a),c=r.targetIds||[],d=r.removedTargetIds||[];t=new rl(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Ir(n,r.document),o=r.readTime?at(r.readTime):J.min(),s=ft.newNoDocument(i,o),a=r.removedTargetIds||[];t=new rl([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Ir(n,r.document),o=r.removedTargetIds||[];t=new rl([],o,i,null)}else{if(!("filter"in e))return G();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new IC(i,o),a=r.targetId;t=new Rg(a,s)}}return t}function gd(n,e){let t;if(e instanceof ro)t={update:bk(n,e.key,e.value)};else if(e instanceof io)t={delete:pd(n,e.key)};else if(e instanceof er)t={update:bk(n,e.key,e.data),updateMask:E9(e.fieldMask)};else{if(!(e instanceof ud))return G();t={verify:pd(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof to)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ti)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ni)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof no)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw G()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:f9(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:G()}(n,e.precondition)),t}function MC(n,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?rt.updateTime(at(o.updateTime)):o.exists!==void 0?rt.exists(o.exists):rt.none()}(e.currentDocument):rt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let l=null;if("setToServerValue"in a)K(a.setToServerValue==="REQUEST_TIME"),l=new to;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];l=new ti(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];l=new ni(d)}else"increment"in a?l=new no(s,a.increment):G();let c=st.fromServerFormat(a.fieldPath);return new ds(c,l)}(n,i)):[];if(e.update){e.update.name;let i=Ir(n,e.update.name),o=new Ut({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(l){let c=l.fieldPaths||[];return new Cn(c.map(d=>st.fromServerFormat(d)))}(e.updateMask);return new er(i,o,s,t,r)}return new ro(i,o,t,r)}if(e.delete){let i=Ir(n,e.delete);return new io(i,t)}if(e.verify){let i=Ir(n,e.verify);return new ud(i,t)}return G()}function m9(n,e){return n&&n.length>0?(K(e!==void 0),n.map(t=>function(i,o){let s=i.updateTime?at(i.updateTime):at(o);return s.isEqual(J.min())&&(s=at(o)),new wC(s,i.transformResults||[])}(t,e))):[]}function YO(n,e){return{documents:[zO(n,e.path)]}}function ZO(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=zO(n,i);let o=function(c){if(c.length!==0)return e1(Fe.create(c,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(c){if(c.length!==0)return c.map(d=>function(g){return{field:Za(g.field),direction:_9(g.dir)}}(d))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=bC(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ct:t,parent:i}}function JO(n){let e=WO(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){K(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=function(f){let g=XO(f);return g instanceof Fe&&YD(g)?g.getFilters():[g]}(t.where));let s=[];t.orderBy&&(s=function(f){return f.map(g=>function(v){return new us(Ja(v.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(f){let g;return g=typeof f=="object"?f.value:f,Td(g)?null:g}(t.limit));let l=null;t.startAt&&(l=function(f){let g=!!f.before,m=f.values||[];return new Tr(m,g)}(t.startAt));let c=null;return t.endAt&&(c=function(f){let g=!f.before,m=f.values||[];return new Tr(m,g)}(t.endAt)),bO(e,i,s,o,a,"F",l,c)}function y9(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return G()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function XO(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Ja(t.unaryFilter.field);return Ee.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Ja(t.unaryFilter.field);return Ee.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Ja(t.unaryFilter.field);return Ee.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=Ja(t.unaryFilter.field);return Ee.create(s,"!=",{nullValue:"NULL_VALUE"});default:return G()}}(n):n.fieldFilter!==void 0?function(t){return Ee.create(Ja(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return G()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Fe.create(t.compositeFilter.filters.map(r=>XO(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return G()}}(t.compositeFilter.op))}(n):G()}function _9(n){return c9[n]}function v9(n){return d9[n]}function w9(n){return h9[n]}function Za(n){return{fieldPath:n.canonicalString()}}function Ja(n){return st.fromServerFormat(n.fieldPath)}function e1(n){return n instanceof Ee?function(t){if(t.op==="=="){if(ck(t.value))return{unaryFilter:{field:Za(t.field),op:"IS_NAN"}};if(uk(t.value))return{unaryFilter:{field:Za(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(ck(t.value))return{unaryFilter:{field:Za(t.field),op:"IS_NOT_NAN"}};if(uk(t.value))return{unaryFilter:{field:Za(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Za(t.field),op:v9(t.op),value:t.value}}}(n):n instanceof Fe?function(t){let r=t.getFilters().map(i=>e1(i));return r.length===1?r[0]:{compositeFilter:{op:w9(t.op),filters:r}}}(n):G()}function E9(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function t1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var dl=class n{constructor(e,t,r,i,o=J.min(),s=J.min(),a=lt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Pg=class{constructor(e){this.ht=e}};function I9(n,e){let t;if(e.document)t=QO(n.ht,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=q.fromSegments(e.noDocument.path),i=fs(e.noDocument.readTime);t=ft.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return G();{let r=q.fromSegments(e.unknownDocument.path),i=fs(e.unknownDocument.version);t=ft.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let o=new Je(i[0],i[1]);return J.fromTimestamp(o)}(e.readTime)),t}function Sk(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:kg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:pd(o,s.key),fields:s.data.value.mapValue.fields,updateTime:cl(o,s.version.toTimestamp()),createTime:cl(o,s.createTime.toTimestamp())}}(n.ht,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:hs(e.version)};else{if(!e.isUnknownDocument())return G();r.unknownDocument={path:t.path.toArray(),version:hs(e.version)}}return r}function kg(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function hs(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function fs(n){let e=new Je(n.seconds,n.nanoseconds);return J.fromTimestamp(e)}function rs(n,e){let t=(e.baseMutations||[]).map(o=>MC(n.ht,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let r=e.mutations.map(o=>MC(n.ht,o)),i=Je.fromMillis(e.localWriteTimeMs);return new cd(e.batchId,i,t,r)}function Zc(n){let e=fs(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?fs(n.lastLimboFreeSnapshotVersion):J.min(),r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){return K(o.documents.length===1),Jt(Il(WO(o.documents[0])))}(n.query):function(o){return Jt(JO(o))}(n.query),new dl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,lt.fromBase64String(n.resumeToken))}function n1(n,e){let t=hs(e.snapshotVersion),r=hs(e.lastLimboFreeSnapshotVersion),i;i=Sg(e.target)?YO(n.ht,e.target):ZO(n.ht,e.target).ct;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:cs(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function tT(n){let e=JO({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Mg(e,e.limit,"L"):e}function HI(n,e){return new dd(e.largestBatchId,MC(n.ht,e.overlayMutation))}function Ak(n,e){let t=e.path.lastSegment();return[n,$t(e.path.popLast()),t]}function Mk(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:hs(r.readTime),documentKey:$t(r.documentKey.path),largestBatchId:r.largestBatchId}}var RC=class{getBundleMetadata(e,t){return Rk(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:fs(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return Rk(e).put(function(i){return{bundleId:i.id,createTime:hs(at(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return Nk(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:tT(o.bundledQuery),readTime:fs(o.readTime)}}(r)})}saveNamedQuery(e,t){return Nk(e).put(function(i){return{name:i.name,readTime:hs(at(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function Rk(n){return vt(n,"bundles")}function Nk(n){return vt(n,"namedQueries")}var Og=class n{constructor(e,t){this.serializer=e,this.userId=t}static Pt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return zc(e).get(Ak(this.userId,t)).next(r=>r?HI(this.serializer,r):null)}getOverlays(e,t){let r=wr();return M.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((o,s)=>{let a=new dd(t,s);i.push(this.Tt(e,a))}),M.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(s=>i.add($t(s.getCollectionPath())));let o=[];return i.forEach(s=>{let a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(zc(e).j("collectionPathOverlayIndex",a))}),M.waitFor(o)}getOverlaysForCollection(e,t,r){let i=wr(),o=$t(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return zc(e).U("collectionPathOverlayIndex",s).next(a=>{for(let l of a){let c=HI(this.serializer,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let o=wr(),s,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return zc(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,d)=>{let f=HI(this.serializer,c);o.size()<i||f.largestBatchId===s?(o.set(f.getKey(),f),s=f.largestBatchId):d.done()}).next(()=>o)}Tt(e,t){return zc(e).put(function(i,o,s){let[a,l,c]=Ak(o,s.mutation.key);return{userId:o,collectionPath:l,documentId:c,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:gd(i.ht,s.mutation)}}(this.serializer,this.userId,t))}};function zc(n){return vt(n,"documentOverlays")}var NC=class{It(e){return vt(e,"globals")}getSessionToken(e){return this.It(e).get("sessionToken").next(t=>{let r=t?.value;return r?lt.fromUint8Array(r):lt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.It(e).put({name:"sessionToken",value:t.toUint8Array()})}};var Zr=class{constructor(){}dt(e,t){this.Et(e,t),t.At()}Et(e,t){if("nullValue"in e)this.Rt(t,5);else if("booleanValue"in e)this.Rt(t,10),t.Vt(e.booleanValue?1:0);else if("integerValue"in e)this.Rt(t,15),t.Vt(Ke(e.integerValue));else if("doubleValue"in e){let r=Ke(e.doubleValue);isNaN(r)?this.Rt(t,13):(this.Rt(t,15),id(r)?t.Vt(0):t.Vt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Rt(t,20),typeof r=="string"&&(r=Xr(r)),t.ft(`${r.seconds||""}`),t.Vt(r.nanos||0)}else if("stringValue"in e)this.gt(e.stringValue,t),this.yt(t);else if("bytesValue"in e)this.Rt(t,30),t.wt(ei(e.bytesValue)),this.yt(t);else if("referenceValue"in e)this.St(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Rt(t,45),t.Vt(r.latitude||0),t.Vt(r.longitude||0)}else"mapValue"in e?_O(e)?this.Rt(t,Number.MAX_SAFE_INTEGER):_m(e)?this.bt(e.mapValue,t):(this.Dt(e.mapValue,t),this.yt(t)):"arrayValue"in e?(this.vt(e.arrayValue,t),this.yt(t)):G()}gt(e,t){this.Rt(t,25),this.Ct(e,t)}Ct(e,t){t.ft(e)}Dt(e,t){let r=e.fields||{};this.Rt(t,55);for(let i of Object.keys(r))this.gt(i,t),this.Et(r[i],t)}bt(e,t){var r,i;let o=e.fields||{};this.Rt(t,53);let s="value",a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Rt(t,15),t.Vt(Ke(a)),this.gt(s,t),this.Et(o[s],t)}vt(e,t){let r=e.values||[];this.Rt(t,50);for(let i of r)this.Et(i,t)}St(e,t){this.Rt(t,37),q.fromName(e).path.forEach(r=>{this.Rt(t,60),this.Ct(r,t)})}Rt(e,t){e.Vt(t)}yt(e){e.Vt(2)}};Zr.Ft=new Zr;function C9(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function xk(n){let e=64-function(r){let i=0;for(let o=0;o<8;++o){let s=C9(255&r[o]);if(i+=s,s!==8)break}return i}(n);return Math.ceil(e/8)}var xC=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Mt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.xt(r.value),r=t.next();this.Ot()}Nt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Bt(r.value),r=t.next();this.Lt()}kt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.xt(r);else if(r<2048)this.xt(960|r>>>6),this.xt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.xt(480|r>>>12),this.xt(128|63&r>>>6),this.xt(128|63&r);else{let i=t.codePointAt(0);this.xt(240|i>>>18),this.xt(128|63&i>>>12),this.xt(128|63&i>>>6),this.xt(128|63&i)}}this.Ot()}qt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Bt(r);else if(r<2048)this.Bt(960|r>>>6),this.Bt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Bt(480|r>>>12),this.Bt(128|63&r>>>6),this.Bt(128|63&r);else{let i=t.codePointAt(0);this.Bt(240|i>>>18),this.Bt(128|63&i>>>12),this.Bt(128|63&i>>>6),this.Bt(128|63&i)}}this.Lt()}Qt(e){let t=this.Kt(e),r=xk(t);this.$t(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Ut(e){let t=this.Kt(e),r=xk(t);this.$t(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Wt(){this.Gt(255),this.Gt(255)}zt(){this.jt(255),this.jt(255)}reset(){this.position=0}seed(e){this.$t(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ht(){return this.buffer.slice(0,this.position)}Kt(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}xt(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(t)}Bt(e){let t=255&e;t===0?(this.jt(0),this.jt(255)):t===255?(this.jt(255),this.jt(0)):this.jt(e)}Ot(){this.Gt(0),this.Gt(1)}Lt(){this.jt(0),this.jt(1)}Gt(e){this.$t(1),this.buffer[this.position++]=e}jt(e){this.$t(1),this.buffer[this.position++]=~e}$t(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},PC=class{constructor(e){this.Jt=e}wt(e){this.Jt.Mt(e)}ft(e){this.Jt.kt(e)}Vt(e){this.Jt.Qt(e)}At(){this.Jt.Wt()}},kC=class{constructor(e){this.Jt=e}wt(e){this.Jt.Nt(e)}ft(e){this.Jt.qt(e)}Vt(e){this.Jt.Ut(e)}At(){this.Jt.zt()}},is=class{constructor(){this.Jt=new xC,this.Yt=new PC(this.Jt),this.Zt=new kC(this.Jt)}seed(e){this.Jt.seed(e)}Xt(e){return e===0?this.Yt:this.Zt}Ht(){return this.Jt.Ht()}reset(){this.Jt.reset()}};var os=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}en(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function qi(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=Pk(n.arrayValue,e.arrayValue),t!==0?t:(t=Pk(n.directionalValue,e.directionalValue),t!==0?t:q.comparator(n.documentKey,e.documentKey)))}function Pk(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Fg=class{constructor(e){this.tn=new Ve((t,r)=>st.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.nn=e.orderBy,this.rn=[];for(let t of e.filters){let r=t;r.isInequality()?this.tn=this.tn.add(r):this.rn.push(r)}}get sn(){return this.tn.size>1}on(e){if(K(e.collectionGroup===this.collectionId),this.sn)return!1;let t=tC(e);if(t!==void 0&&!this._n(t))return!1;let r=ts(e),i=new Set,o=0,s=0;for(;o<r.length&&this._n(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.tn.size>0){let a=this.tn.getIterator().getNext();if(!i.has(a.field.canonicalString())){let l=r[o];if(!this.an(a,l)||!this.un(this.nn[s++],l))return!1}++o}for(;o<r.length;++o){let a=r[o];if(s>=this.nn.length||!this.un(this.nn[s++],a))return!1}return!0}cn(){if(this.sn)return null;let e=new Ve(st.comparator),t=[];for(let r of this.rn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new tl(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new tl(r.field,0))}for(let r of this.nn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new tl(r.field,r.dir==="asc"?0:1)));return new ol(ol.UNKNOWN_ID,this.collectionId,t,rd.empty())}_n(e){for(let t of this.rn)if(this.an(t,e))return!0;return!1}an(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}un(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function r1(n){var e,t;if(K(n instanceof Ee||n instanceof Fe),n instanceof Ee){if(n instanceof bg){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>Ee.create(n.field,"==",o)))||[];return Fe.create(i,"or")}return n}let r=n.filters.map(i=>r1(i));return Fe.create(r,n.op)}function D9(n){if(n.getFilters().length===0)return[];let e=VC(r1(n));return K(i1(e)),OC(e)||FC(e)?[e]:e.getFilters()}function OC(n){return n instanceof Ee}function FC(n){return n instanceof Fe&&YD(n)}function i1(n){return OC(n)||FC(n)||function(t){if(t instanceof Fe&&uC(t)){for(let r of t.getFilters())if(!OC(r)&&!FC(r))return!1;return!0}return!1}(n)}function VC(n){if(K(n instanceof Ee||n instanceof Fe),n instanceof Ee)return n;if(n.filters.length===1)return VC(n.filters[0]);let e=n.filters.map(r=>VC(r)),t=Fe.create(e,n.op);return t=Vg(t),i1(t)?t:(K(t instanceof Fe),K(al(t)),K(t.filters.length>1),t.filters.reduce((r,i)=>nT(r,i)))}function nT(n,e){let t;return K(n instanceof Ee||n instanceof Fe),K(e instanceof Ee||e instanceof Fe),t=n instanceof Ee?e instanceof Ee?function(i,o){return Fe.create([i,o],"and")}(n,e):kk(n,e):e instanceof Ee?kk(e,n):function(i,o){if(K(i.filters.length>0&&o.filters.length>0),al(i)&&al(o))return CO(i,o.getFilters());let s=uC(i)?i:o,a=uC(i)?o:i,l=s.filters.map(c=>nT(c,a));return Fe.create(l,"or")}(n,e),Vg(t)}function kk(n,e){if(al(e))return CO(e,n.getFilters());{let t=e.filters.map(r=>nT(n,r));return Fe.create(t,"or")}}function Vg(n){if(K(n instanceof Ee||n instanceof Fe),n instanceof Ee)return n;let e=n.getFilters();if(e.length===1)return Vg(e[0]);if(EO(n))return n;let t=e.map(i=>Vg(i)),r=[];return t.forEach(i=>{i instanceof Ee?r.push(i):i instanceof Fe&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Fe.create(r,n.op)}var LC=class{constructor(){this.ln=new md}addToCollectionParentIndex(e,t){return this.ln.add(t),M.resolve()}getCollectionParents(e,t){return M.resolve(this.ln.getEntries(t))}addFieldIndex(e,t){return M.resolve()}deleteFieldIndex(e,t){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,t){return M.resolve()}getDocumentsMatchingTarget(e,t){return M.resolve(null)}getIndexType(e,t){return M.resolve(0)}getFieldIndexes(e,t){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,t){return M.resolve(Vn.min())}getMinOffsetFromCollectionGroup(e,t){return M.resolve(Vn.min())}updateCollectionGroup(e,t,r){return M.resolve()}updateIndexEntries(e,t){return M.resolve()}},md=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ve(Se.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ve(Se.comparator)).toArray()}};var lg=new Uint8Array(0),jC=class{constructor(e,t){this.databaseId=t,this.hn=new md,this.Pn=new Xn(r=>cs(r),(r,i)=>bd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.hn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.hn.add(t)});let o={collectionId:r,parent:$t(i)};return Ok(e).put(o)}return M.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[sO(t),""],!1,!0);return Ok(e).U(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;r.push(vr(s.parent))}return r})}addFieldIndex(e,t){let r=Wc(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete i.indexId;let o=r.add(i);if(t.indexState){let s=Wa(e);return o.next(a=>{s.put(Mk(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let r=Wc(e),i=Wa(e),o=za(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Wc(e),r=za(e),i=Wa(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return M.forEach(this.Tn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let o=new Fg(r).cn();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let r=za(e),i=!0,o=new Map;return M.forEach(this.Tn(t),s=>this.In(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=he(),a=[];return M.forEach(o,(l,c)=>{k("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(W=>`${W.fieldPath}:${W.kind}`).join(",")}`}(l)} to execute ${cs(t)}`);let d=function(F,W){let oe=tC(W);if(oe===void 0)return null;for(let X of Ag(F,oe.fieldPath))switch(X.op){case"array-contains-any":return X.value.arrayValue.values||[];case"array-contains":return[X.value]}return null}(c,l),f=function(F,W){let oe=new Map;for(let X of ts(W))for(let I of Ag(F,X.fieldPath))switch(I.op){case"==":case"in":oe.set(X.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return oe.set(X.fieldPath.canonicalString(),I.value),Array.from(oe.values())}return null}(c,l),g=function(F,W){let oe=[],X=!0;for(let I of ts(W)){let _=I.kind===0?gk(F,I.fieldPath,F.startAt):mk(F,I.fieldPath,F.startAt);oe.push(_.value),X&&(X=_.inclusive)}return new Tr(oe,X)}(c,l),m=function(F,W){let oe=[],X=!0;for(let I of ts(W)){let _=I.kind===0?mk(F,I.fieldPath,F.endAt):gk(F,I.fieldPath,F.endAt);oe.push(_.value),X&&(X=_.inclusive)}return new Tr(oe,X)}(c,l),v=this.dn(l,c,g),T=this.dn(l,c,m),S=this.En(l,c,f),O=this.An(l.indexId,d,v,g.inclusive,T,m.inclusive,S);return M.forEach(O,B=>r.G(B,t.limit).next(F=>{F.forEach(W=>{let oe=q.fromSegments(W.documentKey);s.has(oe)||(s=s.add(oe),a.push(oe))})}))}).next(()=>a)}return M.resolve(null)})}Tn(e){let t=this.Pn.get(e);return t||(e.filters.length===0?t=[e]:t=D9(Fe.create(e.filters,"and")).map(r=>_C(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Pn.set(e,t),t)}An(e,t,r,i,o,s,a){let l=(t!=null?t.length:1)*Math.max(r.length,o.length),c=l/(t!=null?t.length:1),d=[];for(let f=0;f<l;++f){let g=t?this.Rn(t[f/c]):lg,m=this.Vn(e,g,r[f%c],i),v=this.mn(e,g,o[f%c],s),T=a.map(S=>this.Vn(e,g,S,!0));d.push(...this.createRange(m,v,T))}return d}Vn(e,t,r,i){let o=new os(e,q.empty(),t,r);return i?o:o.en()}mn(e,t,r,i){let o=new os(e,q.empty(),t,r);return i?o.en():o}In(e,t){let r=new Fg(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let a of o)r.on(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2,i=this.Tn(t);return M.forEach(i,o=>this.In(e,o).next(s=>{s?r!==0&&s.fields.length<function(l){let c=new Ve(st.comparator),d=!1;for(let f of l.filters)for(let g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:c=c.add(g.field));for(let f of l.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(d?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}fn(e,t){let r=new is;for(let i of ts(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=r.Xt(i.kind);Zr.Ft.dt(o,s)}return r.Ht()}Rn(e){let t=new is;return Zr.Ft.dt(e,t.Xt(0)),t.Ht()}gn(e,t){let r=new is;return Zr.Ft.dt(ls(this.databaseId,t),r.Xt(function(o){let s=ts(o);return s.length===0?0:s[s.length-1].kind}(e))),r.Ht()}En(e,t,r){if(r===null)return[];let i=[];i.push(new is);let o=0;for(let s of ts(e)){let a=r[o++];for(let l of i)if(this.pn(t,s.fieldPath)&&ld(a))i=this.yn(i,s,a);else{let c=l.Xt(s.kind);Zr.Ft.dt(a,c)}}return this.wn(i)}dn(e,t,r){return this.En(e,t,r.position)}wn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Ht();return t}yn(e,t,r){let i=[...e],o=[];for(let s of r.arrayValue.values||[])for(let a of i){let l=new is;l.seed(a.Ht()),Zr.Ft.dt(s,l.Xt(t.kind)),o.push(l)}return o}pn(e,t){return!!e.filters.find(r=>r instanceof Ee&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Wc(e),i=Wa(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(o=>{let s=[];return M.forEach(o,a=>i.get([a.indexId,this.uid]).next(l=>{s.push(function(d,f){let g=f?new rd(f.sequenceNumber,new Vn(fs(f.readTime),new q(vr(f.documentKey)),f.largestBatchId)):rd.empty(),m=d.fields.map(([v,T])=>new tl(st.fromServerFormat(v),T));return new ol(d.indexId,d.collectionGroup,m,g)}(a,l))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:le(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Wc(e),o=Wa(e);return this.Sn(e).next(s=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>M.forEach(a,l=>o.put(Mk(l.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){let r=new Map;return M.forEach(t,(i,o)=>{let s=r.get(i.collectionGroup);return(s?M.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),M.forEach(a,l=>this.bn(e,i,l).next(c=>{let d=this.Dn(o,l);return c.isEqual(d)?M.resolve():this.vn(e,o,l,c,d)}))))})}Cn(e,t,r,i){return za(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.gn(r,t.key),documentKey:t.key.path.toArray()})}Fn(e,t,r,i){return za(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.gn(r,t.key),t.key.path.toArray()])}bn(e,t,r){let i=za(e),o=new Ve(qi);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.gn(r,t)])},(s,a)=>{o=o.add(new os(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>o)}Dn(e,t){let r=new Ve(qi),i=this.fn(t,e);if(i==null)return r;let o=tC(t);if(o!=null){let s=e.data.field(o.fieldPath);if(ld(s))for(let a of s.arrayValue.values||[])r=r.add(new os(t.indexId,e.key,this.Rn(a),i))}else r=r.add(new os(t.indexId,e.key,lg,i));return r}vn(e,t,r,i,o){k("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let s=[];return function(l,c,d,f,g){let m=l.getIterator(),v=c.getIterator(),T=Ga(m),S=Ga(v);for(;T||S;){let O=!1,B=!1;if(T&&S){let F=d(T,S);F<0?B=!0:F>0&&(O=!0)}else T!=null?B=!0:O=!0;O?(f(S),S=Ga(v)):B?(g(T),T=Ga(m)):(T=Ga(m),S=Ga(v))}}(i,o,qi,a=>{s.push(this.Cn(e,t,r,a))},a=>{s.push(this.Fn(e,t,r,a))}),M.waitFor(s)}Sn(e){let t=1;return Wa(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>qi(s,a)).filter((s,a,l)=>!a||qi(s,l[a-1])!==0);let i=[];i.push(e);for(let s of r){let a=qi(s,e),l=qi(s,t);if(a===0)i[0]=e.en();else if(a>0&&l<0)i.push(s),i.push(s.en());else if(l>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.Mn(i[s],i[s+1]))return[];let a=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,lg,[]],l=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,lg,[]];o.push(IDBKeyRange.bound(a,l))}return o}Mn(e,t){return qi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Fk)}getMinOffset(e,t){return M.mapArray(this.Tn(t),r=>this.In(e,r).next(i=>i||G())).next(Fk)}};function Ok(n){return vt(n,"collectionParents")}function za(n){return vt(n,"indexEntries")}function Wc(n){return vt(n,"indexConfiguration")}function Wa(n){return vt(n,"indexState")}function Fk(n){K(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;WD(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Vn(e.readTime,e.documentKey,t)}var Vk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},sn=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};function o1(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),o=[],s=IDBKeyRange.only(t.batchId),a=0,l=r.J({range:s},(d,f,g)=>(a++,g.delete()));o.push(l.next(()=>{K(a===1)}));let c=[];for(let d of t.mutations){let f=hO(e,d.key.path,t.batchId);o.push(i.delete(f)),c.push(d.key)}return M.waitFor(o).next(()=>c)}function Lg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw G();e=n.noDocument}return JSON.stringify(e).length}sn.DEFAULT_COLLECTION_PERCENTILE=10,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sn.DEFAULT=new sn(41943040,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sn.DISABLED=new sn(-1,0,0);var jg=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.xn={}}static Pt(e,t,r,i){K(e.uid!=="");let o=e.isAuthenticated()?e.uid:"";return new n(o,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gi(e).J({index:"userMutationsIndex",range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let o=Xa(e),s=Gi(e);return s.add({}).next(a=>{K(typeof a=="number");let l=new cd(a,t,r,i),c=function(m,v,T){let S=T.baseMutations.map(B=>gd(m.ht,B)),O=T.mutations.map(B=>gd(m.ht,B));return{userId:v,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:S,mutations:O}}(this.serializer,this.userId,l),d=[],f=new Ve((g,m)=>le(g.canonicalString(),m.canonicalString()));for(let g of i){let m=hO(this.userId,g.key.path,a);f=f.add(g.key.path.popLast()),d.push(s.put(c)),d.push(o.put(m,RW))}return f.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.xn[a]=l.keys()}),M.waitFor(d).next(()=>l)})}lookupMutationBatch(e,t){return Gi(e).get(t).next(r=>r?(K(r.userId===this.userId),rs(this.serializer,r)):null)}On(e,t){return this.xn[t]?M.resolve(this.xn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.xn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Gi(e).J({index:"userMutationsIndex",range:i},(s,a,l)=>{a.userId===this.userId&&(K(a.batchId>=r),o=rs(this.serializer,a)),l.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Gi(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Gi(e).U("userMutationsIndex",t).next(r=>r.map(i=>rs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=hg(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Xa(e).J({range:i},(s,a,l)=>{let[c,d,f]=s,g=vr(d);if(c===this.userId&&t.path.isEqual(g))return Gi(e).get(f).next(m=>{if(!m)throw G();K(m.userId===this.userId),o.push(rs(this.serializer,m))});l.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ve(le),i=[];return t.forEach(o=>{let s=hg(this.userId,o.path),a=IDBKeyRange.lowerBound(s),l=Xa(e).J({range:a},(c,d,f)=>{let[g,m,v]=c,T=vr(m);g===this.userId&&o.path.isEqual(T)?r=r.add(v):f.done()});i.push(l)}),M.waitFor(i).next(()=>this.Nn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=hg(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Ve(le);return Xa(e).J({range:s},(l,c,d)=>{let[f,g,m]=l,v=vr(g);f===this.userId&&r.isPrefixOf(v)?v.length===i&&(a=a.add(m)):d.done()}).next(()=>this.Nn(e,a))}Nn(e,t){let r=[],i=[];return t.forEach(o=>{i.push(Gi(e).get(o).next(s=>{if(s===null)throw G();K(s.userId===this.userId),r.push(rs(this.serializer,s))}))}),M.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return o1(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Bn(t.batchId)}),M.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Bn(e){delete this.xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return M.resolve();let r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return Xa(e).J({range:r},(o,s,a)=>{if(o[0]===this.userId){let l=vr(o[1]);i.push(l)}else a.done()}).next(()=>{K(i.length===0)})})}containsKey(e,t){return s1(e,this.userId,t)}Ln(e){return a1(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function s1(n,e,t){let r=hg(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Xa(n).J({range:o,H:!0},(a,l,c)=>{let[d,f,g]=a;d===e&&f===i&&(s=!0),c.done()}).next(()=>s)}function Gi(n){return vt(n,"mutations")}function Xa(n){return vt(n,"documentMutations")}function a1(n){return vt(n,"mutationQueues")}var hl=class n{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new n(0)}static Qn(){return new n(-1)}};var BC=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Kn(e).next(t=>{let r=new hl(t.highestTargetId);return t.highestTargetId=r.next(),this.$n(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Kn(e).next(t=>J.fromTimestamp(new Je(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Kn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Kn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.$n(e,i)))}addTargetData(e,t){return this.Un(e,t).next(()=>this.Kn(e).next(r=>(r.targetCount+=1,this.Wn(t,r),this.$n(e,r))))}updateTargetData(e,t){return this.Un(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Ka(e).delete(t.targetId)).next(()=>this.Kn(e)).next(r=>(K(r.targetCount>0),r.targetCount-=1,this.$n(e,r)))}removeTargets(e,t,r){let i=0,o=[];return Ka(e).J((s,a)=>{let l=Zc(a);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,o.push(this.removeTargetData(e,l)))}).next(()=>M.waitFor(o)).next(()=>i)}forEachTarget(e,t){return Ka(e).J((r,i)=>{let o=Zc(i);t(o)})}Kn(e){return Lk(e).get("targetGlobalKey").next(t=>(K(t!==null),t))}$n(e,t){return Lk(e).put("targetGlobalKey",t)}Un(e,t){return Ka(e).put(n1(this.serializer,t))}Wn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Kn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=cs(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Ka(e).J({range:i,index:"queryTargetsIndex"},(s,a,l)=>{let c=Zc(a);bd(t,c.target)&&(o=c,l.done())}).next(()=>o)}addMatchingKeys(e,t,r){let i=[],o=zi(e);return t.forEach(s=>{let a=$t(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),M.waitFor(i)}removeMatchingKeys(e,t,r){let i=zi(e);return M.forEach(t,o=>{let s=$t(o.path);return M.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){let r=zi(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=zi(e),o=he();return i.J({range:r,H:!0},(s,a,l)=>{let c=vr(s[1]),d=new q(c);o=o.add(d)}).next(()=>o)}containsKey(e,t){let r=$t(t.path),i=IDBKeyRange.bound([r],[sO(r)],!1,!0),o=0;return zi(e).J({index:"documentTargetsIndex",H:!0,range:i},([s,a],l,c)=>{s!==0&&(o++,c.done())}).next(()=>o>0)}ut(e,t){return Ka(e).get(t).next(r=>r?Zc(r):null)}};function Ka(n){return vt(n,"targets")}function Lk(n){return vt(n,"targetGlobal")}function zi(n){return vt(n,"targetDocuments")}function jk([n,e],[t,r]){let i=le(n,t);return i===0?le(e,r):i}var UC=class{constructor(e){this.Gn=e,this.buffer=new Ve(jk),this.zn=0}jn(){return++this.zn}Hn(e){let t=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();jk(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Bg=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){k("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>N(this,null,function*(){this.Jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){ao(t)?k("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield so(t)}yield this.Yn(3e5)}))}},$C=class{constructor(e,t){this.Zn=e,this.params=t}calculateTargetCount(e,t){return this.Zn.Xn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return M.resolve(In.oe);let r=new UC(t);return this.Zn.forEachTarget(e,i=>r.Hn(i.sequenceNumber)).next(()=>this.Zn.er(e,i=>r.Hn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(Vk)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Vk):this.tr(e,t))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,t){let r,i,o,s,a,l,c,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,s=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(o=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),Qa()<=Tn.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:f})))}};function l1(n,e){return new $C(n,e)}var HC=class{constructor(e,t){this.db=e,this.garbageCollector=l1(this,t)}Xn(e){let t=this.nr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}nr(e){let t=0;return this.er(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}er(e,t){return this.rr(e,(r,i)=>t(i))}addReference(e,t,r){return ug(e,r)}removeReference(e,t,r){return ug(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return ug(e,t)}ir(e,t){return function(i,o){let s=!1;return a1(i).Y(a=>s1(i,a,o).next(l=>(l&&(s=!0),M.resolve(!l)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.rr(e,(s,a)=>{if(a<=t){let l=this.ir(e,s).next(c=>{if(!c)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,J.min()),zi(e).delete(function(f){return[0,$t(f.path)]}(s))))});i.push(l)}}).next(()=>M.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return ug(e,t)}rr(e,t){let r=zi(e),i,o=In.oe;return r.J({index:"documentTargetsIndex"},([s,a],{path:l,sequenceNumber:c})=>{s===0?(o!==In.oe&&t(new q(vr(i)),o),o=c,i=l):o=In.oe}).next(()=>{o!==In.oe&&t(new q(vr(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function ug(n,e){return zi(n).put(function(r,i){return{targetId:0,path:$t(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var Ug=class{constructor(){this.changes=new Xn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ft.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?M.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var qC=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return es(e).put(r)}removeEntry(e,t,r){return es(e).delete(function(o,s){let a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],kg(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.sr(e,r)))}getEntry(e,t){let r=ft.newInvalidDocument(t);return es(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Kc(t))},(i,o)=>{r=this._r(t,o)}).next(()=>r)}ar(e,t){let r={size:0,document:ft.newInvalidDocument(t)};return es(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Kc(t))},(i,o)=>{r={document:this._r(t,o),size:Lg(o)}}).next(()=>r)}getEntries(e,t){let r=an();return this.ur(e,t,(i,o)=>{let s=this._r(i,o);r=r.insert(i,s)}).next(()=>r)}cr(e,t){let r=an(),i=new ze(q.comparator);return this.ur(e,t,(o,s)=>{let a=this._r(o,s);r=r.insert(o,a),i=i.insert(o,Lg(s))}).next(()=>({documents:r,lr:i}))}ur(e,t,r){if(t.isEmpty())return M.resolve();let i=new Ve($k);t.forEach(l=>i=i.add(l));let o=IDBKeyRange.bound(Kc(i.first()),Kc(i.last())),s=i.getIterator(),a=s.getNext();return es(e).J({index:"documentKeyIndex",range:o},(l,c,d)=>{let f=q.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&$k(a,f)<0;)r(a,null),a=s.getNext();a&&a.isEqual(f)&&(r(a,c),a=s.hasNext()?s.getNext():null),a?d.$(Kc(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),kg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return es(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{o?.incrementDocumentReadCount(c.length);let d=an();for(let f of c){let g=this._r(q.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(Ad(t,g)||i.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,i){let o=an(),s=Uk(t,r),a=Uk(t,Vn.max());return es(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(l,c,d)=>{let f=this._r(q.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);o=o.insert(f.key,f),o.size===i&&d.done()}).next(()=>o)}newChangeBuffer(e){return new GC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Bk(e).get("remoteDocumentGlobalKey").next(t=>(K(!!t),t))}sr(e,t){return Bk(e).put("remoteDocumentGlobalKey",t)}_r(e,t){if(t){let r=I9(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(J.min())))return r}return ft.newInvalidDocument(e)}};function u1(n){return new qC(n)}var GC=class extends Ug{constructor(e,t){super(),this.hr=e,this.trackRemovals=t,this.Pr=new Xn(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Ve((o,s)=>le(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let a=this.Pr.get(o);if(t.push(this.hr.removeEntry(e,o,a.readTime)),s.isValidDocument()){let l=Sk(this.hr.serializer,s);i=i.add(o.path.popLast());let c=Lg(l);r+=c-a.size,t.push(this.hr.addEntry(e,o,l))}else if(r-=a.size,this.trackRemovals){let l=Sk(this.hr.serializer,s.convertToNoDocument(J.min()));t.push(this.hr.addEntry(e,o,l))}}),i.forEach(o=>{t.push(this.hr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.hr.updateMetadata(e,r)),M.waitFor(t)}getFromCache(e,t){return this.hr.ar(e,t).next(r=>(this.Pr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.hr.cr(e,t).next(({documents:r,lr:i})=>(i.forEach((o,s)=>{this.Pr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}};function Bk(n){return vt(n,"remoteDocumentGlobal")}function es(n){return vt(n,"remoteDocumentsV14")}function Kc(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Uk(n,e){let t=e.documentKey.path.toArray();return[n,kg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function $k(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=le(t[o],r[o]),i)return i;return i=le(t.length,r.length),i||(i=le(t[t.length-2],r[r.length-2]),i||le(t[t.length-1],r[r.length-1]))}var zC=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var $g=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ed(r.mutation,i,Cn.empty(),Je.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,he()).next(()=>r))}getLocalViewOfDocuments(e,t,r=he()){let i=wr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=Yc();return o.forEach((a,l)=>{s=s.insert(a,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=wr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,he()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=an(),s=Xc(),a=function(){return Xc()}();return t.forEach((l,c)=>{let d=r.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof er)?o=o.insert(c.key,c):d!==void 0?(s.set(c.key,d.mutation.getFieldMask()),ed(d.mutation,c,d.mutation.getFieldMask(),Je.now())):s.set(c.key,Cn.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((c,d)=>s.set(c,d)),t.forEach((c,d)=>{var f;return a.set(c,new zC(d,(f=s.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Xc(),i=new ze((s,a)=>s-a),o=he();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(l=>{let c=t.get(l);if(c===null)return;let d=r.get(l)||Cn.empty();d=a.applyToLocalView(c,d),r.set(l,d);let f=(i.get(a.batchId)||he()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),c=l.key,d=l.value,f=xO();d.forEach(g=>{if(!o.has(g)){let m=jO(t.get(g),r.get(g));m!==null&&f.set(g,m),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,c,f))}return M.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return q.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ZD(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):M.resolve(wr()),a=-1,l=o;return s.next(c=>M.forEach(c,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),o.get(d)?M.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{l=l.insert(d,g)}))).next(()=>this.populateOverlays(e,c,o)).next(()=>this.computeViews(e,l,c,he())).next(d=>({batchId:a,changes:NO(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next(r=>{let i=Yc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=Yc();return this.indexManager.getCollectionParents(e,o).next(a=>M.forEach(a,l=>{let c=function(f,g){return new Jn(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(d=>{d.forEach((f,g)=>{s=s.insert(f,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((l,c)=>{let d=c.getKey();s.get(d)===null&&(s=s.insert(d,ft.newInvalidDocument(d)))});let a=Yc();return s.forEach((l,c)=>{let d=o.get(l);d!==void 0&&ed(d.mutation,c,Cn.empty(),Je.now()),Ad(t,c)&&(a=a.insert(l,c))}),a})}};var WC=class{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,t){return M.resolve(this.Tr.get(t))}saveBundleMetadata(e,t){return this.Tr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:at(i.createTime)}}(t)),M.resolve()}getNamedQuery(e,t){return M.resolve(this.Ir.get(t))}saveNamedQuery(e,t){return this.Ir.set(t.name,function(i){return{name:i.name,query:tT(i.bundledQuery),readTime:at(i.readTime)}}(t)),M.resolve()}};var KC=class{constructor(){this.overlays=new ze(q.comparator),this.dr=new Map}getOverlay(e,t){return M.resolve(this.overlays.get(t))}getOverlays(e,t){let r=wr();return M.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.Tt(e,t,o)}),M.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.dr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.dr.delete(r)),M.resolve()}getOverlaysForCollection(e,t,r){let i=wr(),o=t.length+1,s=new q(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===o&&l.largestBatchId>r&&i.set(l.getKey(),l)}return M.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ze((c,d)=>c-d),s=this.overlays.getIterator();for(;s.hasNext();){let c=s.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let d=o.get(c.largestBatchId);d===null&&(d=wr(),o=o.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}let a=wr(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=i)););return M.resolve(a)}Tt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.dr.get(i.largestBatchId).delete(r.key);this.dr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new dd(t,r));let o=this.dr.get(t);o===void 0&&(o=he(),this.dr.set(t,o)),this.dr.set(t,o.add(r.key))}};var QC=class{constructor(){this.sessionToken=lt.EMPTY_BYTE_STRING}getSessionToken(e){return M.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,M.resolve()}};var yd=class{constructor(){this.Er=new Ve(dt.Ar),this.Rr=new Ve(dt.Vr)}isEmpty(){return this.Er.isEmpty()}addReference(e,t){let r=new dt(e,t);this.Er=this.Er.add(r),this.Rr=this.Rr.add(r)}mr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.gr(new dt(e,t))}pr(e,t){e.forEach(r=>this.removeReference(r,t))}yr(e){let t=new q(new Se([])),r=new dt(t,e),i=new dt(t,e+1),o=[];return this.Rr.forEachInRange([r,i],s=>{this.gr(s),o.push(s.key)}),o}wr(){this.Er.forEach(e=>this.gr(e))}gr(e){this.Er=this.Er.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){let t=new q(new Se([])),r=new dt(t,e),i=new dt(t,e+1),o=he();return this.Rr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new dt(e,0),r=this.Er.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},dt=class{constructor(e,t){this.key=e,this.br=t}static Ar(e,t){return q.comparator(e.key,t.key)||le(e.br,t.br)}static Vr(e,t){return le(e.br,t.br)||q.comparator(e.key,t.key)}};var YC=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Dr=1,this.vr=new Ve(dt.Ar)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new cd(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.vr=this.vr.add(new dt(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return M.resolve(s)}lookupMutationBatch(e,t){return M.resolve(this.Cr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Fr(r),o=i<0?0:i;return M.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new dt(t,0),i=new dt(t,Number.POSITIVE_INFINITY),o=[];return this.vr.forEachInRange([r,i],s=>{let a=this.Cr(s.br);o.push(a)}),M.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ve(le);return t.forEach(i=>{let o=new dt(i,0),s=new dt(i,Number.POSITIVE_INFINITY);this.vr.forEachInRange([o,s],a=>{r=r.add(a.br)})}),M.resolve(this.Mr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;q.isDocumentKey(o)||(o=o.child(""));let s=new dt(new q(o),0),a=new Ve(le);return this.vr.forEachWhile(l=>{let c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.br)),!0)},s),M.resolve(this.Mr(a))}Mr(e){let t=[];return e.forEach(r=>{let i=this.Cr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){K(this.Or(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.vr;return M.forEach(t.mutations,i=>{let o=new dt(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.vr=r})}Bn(e){}containsKey(e,t){let r=new dt(t,0),i=this.vr.firstAfterOrEqual(r);return M.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}Or(e,t){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){let t=this.Fr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var ZC=class{constructor(e){this.Nr=e,this.docs=function(){return new ze(q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Nr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return M.resolve(r?r.document.mutableCopy():ft.newInvalidDocument(t))}getEntries(e,t){let r=an();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():ft.newInvalidDocument(i))}),M.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=an(),s=t.path,a=new q(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:c,value:{document:d}}=l.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||WD(lO(d),r)<=0||(i.has(d.key)||Ad(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return M.resolve(o)}getAllFromCollectionGroup(e,t,r,i){G()}Br(e,t){return M.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new JC(this)}getSize(e){return M.resolve(this.size)}},JC=class extends Ug{constructor(e){super(),this.hr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.hr.addEntry(e,i)):this.hr.removeEntry(r)}),M.waitFor(t)}getFromCache(e,t){return this.hr.getEntry(e,t)}getAllFromCache(e,t){return this.hr.getEntries(e,t)}};var XC=class{constructor(e){this.persistence=e,this.Lr=new Xn(t=>cs(t),bd),this.lastRemoteSnapshotVersion=J.min(),this.highestTargetId=0,this.kr=0,this.qr=new yd,this.targetCount=0,this.Qr=hl.qn()}forEachTarget(e,t){return this.Lr.forEach((r,i)=>t(i)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.kr&&(this.kr=t),M.resolve()}Un(e){this.Lr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Qr=new hl(t),this.highestTargetId=t),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,t){return this.Un(t),this.targetCount+=1,M.resolve()}updateTargetData(e,t){return this.Un(t),M.resolve()}removeTargetData(e,t){return this.Lr.delete(t.target),this.qr.yr(t.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Lr.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Lr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),M.waitFor(o).next(()=>i)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,t){let r=this.Lr.get(t)||null;return M.resolve(r)}addMatchingKeys(e,t,r){return this.qr.mr(t,r),M.resolve()}removeMatchingKeys(e,t,r){this.qr.pr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),M.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.qr.yr(t),M.resolve()}getMatchingKeysForTargetId(e,t){let r=this.qr.Sr(t);return M.resolve(r)}containsKey(e,t){return M.resolve(this.qr.containsKey(t))}};var _d=class{constructor(e,t){this.Kr={},this.overlays={},this.$r=new In(0),this.Ur=!1,this.Ur=!0,this.Wr=new QC,this.referenceDelegate=e(this),this.Gr=new XC(this),this.indexManager=new LC,this.remoteDocumentCache=function(i){return new ZC(i)}(r=>this.referenceDelegate.zr(r)),this.serializer=new Pg(t),this.jr=new WC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new KC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Kr[e.toKey()];return r||(r=new YC(t,this.referenceDelegate),this.Kr[e.toKey()]=r),r}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,t,r){k("MemoryPersistence","Starting transaction:",e);let i=new eD(this.$r.next());return this.referenceDelegate.Hr(),r(i).next(o=>this.referenceDelegate.Jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Yr(e,t){return M.or(Object.values(this.Kr).map(r=>()=>r.containsKey(e,t)))}},eD=class extends Eg{constructor(e){super(),this.currentSequenceNumber=e}},Hg=class n{constructor(e){this.persistence=e,this.Zr=new yd,this.Xr=null}static ei(e){return new n(e)}get ti(){if(this.Xr)return this.Xr;throw G()}addReference(e,t,r){return this.Zr.addReference(r,t),this.ti.delete(r.toString()),M.resolve()}removeReference(e,t,r){return this.Zr.removeReference(r,t),this.ti.add(r.toString()),M.resolve()}markPotentiallyOrphaned(e,t){return this.ti.add(t.toString()),M.resolve()}removeTarget(e,t){this.Zr.yr(t.targetId).forEach(i=>this.ti.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.ti.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Hr(){this.Xr=new Set}Jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.ti,r=>{let i=q.fromPath(r);return this.ni(e,i).next(o=>{o||t.removeEntry(i,J.min())})}).next(()=>(this.Xr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ni(e,t).next(r=>{r?this.ti.delete(t.toString()):this.ti.add(t.toString())})}zr(e){return 0}ni(e,t){return M.or([()=>M.resolve(this.Zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Yr(e,t)])}},qg=class n{constructor(e,t){this.persistence=e,this.ri=new Xn(r=>$t(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=l1(this,t)}static ei(e,t){return new n(e,t)}Hr(){}Jr(e){return M.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Xn(e){let t=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}nr(e){let t=0;return this.er(e,r=>{t++}).next(()=>t)}er(e,t){return M.forEach(this.ri,(r,i)=>this.ir(e,r,i).next(o=>o?M.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.Br(e,s=>this.ir(e,s,t).next(a=>{a||(r++,o.removeEntry(s,J.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ri.set(t,e.currentSequenceNumber),M.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ri.set(r,e.currentSequenceNumber),M.resolve()}removeReference(e,t,r){return this.ri.set(r,e.currentSequenceNumber),M.resolve()}updateLimboDocument(e,t){return this.ri.set(t,e.currentSequenceNumber),M.resolve()}zr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=pg(e.data.value)),t}ir(e,t,r){return M.or([()=>this.persistence.Yr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.ri.get(t);return M.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var tD=class{constructor(e){this.serializer=e}O(e,t,r,i){let o=new Ig("createOrUpgrade",t);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ok,{unique:!0}),l.createObjectStore("documentMutations")}(e),Hk(e),function(l){l.createObjectStore("remoteDocuments")}(e));let s=M.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),Hk(e)),s=s.next(()=>function(l){let c=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:J.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(l,c){return c.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ok,{unique:!0});let f=c.store("mutations"),g=d.map(m=>f.put(m));return M.waitFor(g)})}(e,o))),s=s.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.ii(o))),r<6&&i>=6&&(s=s.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.si(o)))),r<7&&i>=7&&(s=s.next(()=>this.oi(o))),r<8&&i>=8&&(s=s.next(()=>this._i(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.ai(o))),r<11&&i>=11&&(s=s.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(l){let c=l.createObjectStore("documentOverlays",{keyPath:$W});c.createIndex("collectionPathOverlayIndex",HW,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",qW,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(l){let c=l.createObjectStore("remoteDocumentsV14",{keyPath:NW});c.createIndex("documentKeyIndex",xW),c.createIndex("collectionGroupIndex",PW)}(e)).next(()=>this.ui(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(s=s.next(()=>this.ci(e,o))),r<15&&i>=15&&(s=s.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:LW}).createIndex("sequenceNumberIndex",jW,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:BW}).createIndex("documentKeyIndex",UW,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),s}si(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Lg(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ii(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>M.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",s).next(a=>M.forEach(a,l=>{K(l.userId===o.userId);let c=rs(this.serializer,l);return o1(e,o.userId,c).next(()=>{})}))}))}oi(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let o=[];return r.J((s,a)=>{let l=new Se(s),c=function(f){return[0,$t(f)]}(l);o.push(t.get(c).next(d=>d?M.resolve():(f=>t.put({targetId:0,path:$t(f),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>M.waitFor(o))})}_i(e,t){e.createObjectStore("collectionParents",{keyPath:VW});let r=t.store("collectionParents"),i=new md,o=s=>{if(i.add(s)){let a=s.lastSegment(),l=s.popLast();return r.put({collectionId:a,parent:$t(l)})}};return t.store("remoteDocuments").J({H:!0},(s,a)=>{let l=new Se(s);return o(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([s,a,l],c)=>{let d=vr(a);return o(d.popLast())}))}ai(e){let t=e.store("targets");return t.J((r,i)=>{let o=Zc(i),s=n1(this.serializer,o);return t.put(s)})}ui(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((o,s)=>{let a=t.store("remoteDocumentsV14"),l=function(f){return f.document?new q(Se.fromString(f.document.name).popFirst(5)):f.noDocument?q.fromSegments(f.noDocument.path):f.unknownDocument?q.fromSegments(f.unknownDocument.path):G()}(s).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(c))}).next(()=>M.waitFor(i))}ci(e,t){let r=t.store("mutations"),i=u1(this.serializer),o=new _d(Hg.ei,this.serializer.ht);return r.U().next(s=>{let a=new Map;return s.forEach(l=>{var c;let d=(c=a.get(l.userId))!==null&&c!==void 0?c:he();rs(this.serializer,l).keys().forEach(f=>d=d.add(f)),a.set(l.userId,d)}),M.forEach(a,(l,c)=>{let d=new ht(c),f=Og.Pt(this.serializer,d),g=o.getIndexManager(d),m=jg.Pt(d,this.serializer,g,o.referenceDelegate);return new $g(i,m,f,g).recalculateAndSaveOverlaysForDocumentKeys(new od(t,In.oe),l).next()})})}};function Hk(n){n.createObjectStore("targetDocuments",{keyPath:OW}).createIndex("documentTargetsIndex",FW,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",kW,{unique:!0}),n.createObjectStore("targetGlobal")}var qI="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",nD=class n{constructor(e,t,r,i,o,s,a,l,c,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.li=o,this.window=s,this.document=a,this.hi=c,this.Pi=d,this.Ti=f,this.$r=null,this.Ur=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ii=null,this.inForeground=!1,this.di=null,this.Ei=null,this.Ai=Number.NEGATIVE_INFINITY,this.Ri=g=>Promise.resolve(),!n.p())throw new P(x.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new HC(this,i),this.Vi=t+"main",this.serializer=new Pg(l),this.mi=new Zi(this.Vi,this.Ti,new tD(this.serializer)),this.Wr=new NC,this.Gr=new BC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=u1(this.serializer),this.jr=new RC,this.window&&this.window.localStorage?this.fi=this.window.localStorage:(this.fi=null,d===!1&&ot("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new P(x.FAILED_PRECONDITION,qI);return this.pi(),this.yi(),this.wi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Gr.getHighestSequenceNumber(e))}).then(e=>{this.$r=new In(e,this.hi)}).then(()=>{this.Ur=!0}).catch(e=>(this.mi&&this.mi.close(),Promise.reject(e)))}Si(e){return this.Ri=t=>N(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.mi.B(t=>N(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.li.enqueueAndForget(()=>N(this,null,function*(){this.started&&(yield this.gi())})))}gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>cg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.bi(e).next(t=>{t||(this.isPrimary=!1,this.li.enqueueRetryable(()=>this.Ri(!1)))})}).next(()=>this.Di(e)).next(t=>this.isPrimary&&!t?this.vi(e).next(()=>!1):!!t&&this.Ci(e).next(()=>!0))).catch(e=>{if(ao(e))return k("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return k("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.li.enqueueRetryable(()=>this.Ri(e)),this.isPrimary=e})}bi(e){return Qc(e).get("owner").next(t=>M.resolve(this.Fi(t)))}Mi(e){return cg(e).delete(this.clientId)}xi(){return N(this,null,function*(){if(this.isPrimary&&!this.Oi(this.Ai,18e5)){this.Ai=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=vt(t,"clientMetadata");return r.U().next(i=>{let o=this.Ni(i,18e5),s=i.filter(a=>o.indexOf(a)===-1);return M.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.fi)for(let t of e)this.fi.removeItem(this.Bi(t.clientId))}})}wi(){this.Ei=this.li.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.gi().then(()=>this.xi()).then(()=>this.wi()))}Fi(e){return!!e&&e.ownerId===this.clientId}Di(e){return this.Pi?M.resolve(!0):Qc(e).get("owner").next(t=>{if(t!==null&&this.Oi(t.leaseTimestampMs,5e3)&&!this.Li(t.ownerId)){if(this.Fi(t)&&this.networkEnabled)return!0;if(!this.Fi(t)){if(!t.allowTabSynchronization)throw new P(x.FAILED_PRECONDITION,qI);return!1}}return!(!this.networkEnabled||!this.inForeground)||cg(e).U().next(r=>this.Ni(r,5e3).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&k("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return N(this,null,function*(){this.Ur=!1,this.ki(),this.Ei&&(this.Ei.cancel(),this.Ei=null),this.qi(),this.Qi(),yield this.mi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new od(e,In.oe);return this.vi(t).next(()=>this.Mi(t))}),this.mi.close(),this.Ki()})}Ni(e,t){return e.filter(r=>this.Oi(r.updateTimeMs,t)&&!this.Li(r.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>cg(e).U().next(t=>this.Ni(t,18e5).map(r=>r.clientId)))}get started(){return this.Ur}getGlobalsCache(){return this.Wr}getMutationQueue(e,t){return jg.Pt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new jC(e,this.serializer.ht.databaseId)}getDocumentOverlayCache(e){return Og.Pt(this.serializer,e)}getBundleCache(){return this.jr}runTransaction(e,t,r){k("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=function(l){return l===17?WW:l===16?zW:l===15?QD:l===14?gO:l===13?pO:l===12?GW:l===11?fO:void G()}(this.Ti),s;return this.mi.runTransaction(e,i,o,a=>(s=new od(a,this.$r?this.$r.next():In.oe),t==="readwrite-primary"?this.bi(s).next(l=>!!l||this.Di(s)).next(l=>{if(!l)throw ot(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.li.enqueueRetryable(()=>this.Ri(!1)),new P(x.FAILED_PRECONDITION,uO);return r(s)}).next(l=>this.Ci(s).next(()=>l)):this.Ui(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}Ui(e){return Qc(e).get("owner").next(t=>{if(t!==null&&this.Oi(t.leaseTimestampMs,5e3)&&!this.Li(t.ownerId)&&!this.Fi(t)&&!(this.Pi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new P(x.FAILED_PRECONDITION,qI)})}Ci(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Qc(e).put("owner",t)}static p(){return Zi.p()}vi(e){let t=Qc(e);return t.get("owner").next(r=>this.Fi(r)?(k("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):M.resolve())}Oi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ot(`Detected an update time that is in the future: ${e} > ${r}`),!1))}pi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.di=()=>{this.li.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.gi()))},this.document.addEventListener("visibilitychange",this.di),this.inForeground=this.document.visibilityState==="visible")}qi(){this.di&&(this.document.removeEventListener("visibilitychange",this.di),this.di=null)}yi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ii=()=>{this.ki();let t=/(?:Version|Mobile)\/1[456]/;sy()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.li.enterRestrictedMode(!0),this.li.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ii))}Qi(){this.Ii&&(this.window.removeEventListener("pagehide",this.Ii),this.Ii=null)}Li(e){var t;try{let r=((t=this.fi)===null||t===void 0?void 0:t.getItem(this.Bi(e)))!==null;return k("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ot("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}ki(){if(this.fi)try{this.fi.setItem(this.Bi(this.clientId),String(Date.now()))}catch(e){ot("Failed to set zombie client id.",e)}}Ki(){if(this.fi)try{this.fi.removeItem(this.Bi(this.clientId))}catch{}}Bi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Qc(n){return vt(n,"owner")}function cg(n){return vt(n,"clientMetadata")}function rT(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var rD=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Wi=r,this.Gi=i}static zi(e,t){let r=he(),i=he();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var iD=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Gg=class{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return sy()?8:cO(Yl())>0?6:4}()}initialize(e,t){this.Zi=e,this.indexManager=t,this.ji=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Xi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.es(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new iD;return this.ts(e,t,s).next(a=>{if(o.result=a,this.Hi)return this.ns(e,t,s,a.size)})}).next(()=>o.result)}ns(e,t,r,i){return r.documentReadCount<this.Ji?(Qa()<=Tn.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",Ya(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),M.resolve()):(Qa()<=Tn.DEBUG&&k("QueryEngine","Query:",Ya(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Yi*i?(Qa()<=Tn.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",Ya(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jt(t))):M.resolve())}Xi(e,t){if(yk(t))return M.resolve(null);let r=Jt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Mg(t,null,"F"),r=Jt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=he(...o);return this.Zi.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{let c=this.rs(t,a);return this.ss(t,c,s,l.readTime)?this.Xi(e,Mg(t,null,"F")):this.os(e,c,t,l)}))})))}es(e,t,r,i){return yk(t)||i.isEqual(J.min())?M.resolve(null):this.Zi.getDocuments(e,r).next(o=>{let s=this.rs(t,o);return this.ss(t,s,r,i)?M.resolve(null):(Qa()<=Tn.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ya(t)),this.os(e,s,t,aO(i,-1)).next(a=>a))})}rs(e,t){let r=new Ve(MO(e));return t.forEach((i,o)=>{Ad(e,o)&&(r=r.add(o))}),r}ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ts(e,t,r){return Qa()<=Tn.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",Ya(t)),this.Zi.getDocumentsMatchingQuery(e,t,Vn.min(),r)}os(e,t,r,i){return this.Zi.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var oD=class{constructor(e,t,r,i){this.persistence=e,this._s=t,this.serializer=i,this.us=new ze(le),this.cs=new Xn(o=>cs(o),bd),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(r)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $g(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.us))}};function c1(n,e,t,r){return new oD(n,e,t,r)}function d1(n,e){return N(this,null,function*(){let t=H(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Ps(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],l=he();for(let c of i){s.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}for(let c of o){a.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next(c=>({Ts:c,removedBatchIds:s,addedBatchIds:a}))})})})}function T9(n,e){let t=H(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.hs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){let f=c.batch,g=f.keys(),m=M.resolve();return g.forEach(v=>{m=m.next(()=>d.getEntry(l,v)).next(T=>{let S=c.docVersions.get(v);K(S!==null),T.version.compareTo(S)<0&&(f.applyToRemoteDocument(T,c),T.isValidDocument()&&(T.setReadTime(c.commitVersion),d.addEntry(T)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=he();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function h1(n){let e=H(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Gr.getLastRemoteSnapshotVersion(t))}function b9(n,e){let t=H(n),r=e.snapshotVersion,i=t.us;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.hs.newChangeBuffer({trackRemovals:!0});i=t.us;let a=[];e.targetChanges.forEach((d,f)=>{let g=i.get(f);if(!g)return;a.push(t.Gr.removeMatchingKeys(o,d.removedDocuments,f).next(()=>t.Gr.addMatchingKeys(o,d.addedDocuments,f)));let m=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(f)!==null?m=m.withResumeToken(lt.EMPTY_BYTE_STRING,J.min()).withLastLimboFreeSnapshotVersion(J.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),i=i.insert(f,m),function(T,S,O){return T.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=3e8?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0}(g,m,d)&&a.push(t.Gr.updateTargetData(o,m))});let l=an(),c=he();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(f1(o,s,e.documentUpdates).next(d=>{l=d.Is,c=d.ds})),!r.isEqual(J.min())){let d=t.Gr.getLastRemoteSnapshotVersion(o).next(f=>t.Gr.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(d)}return M.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,l,c)).next(()=>l)}).then(o=>(t.us=i,o))}function f1(n,e,t){let r=he(),i=he();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=an();return t.forEach((a,l)=>{let c=o.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(J.min())?(e.removeEntry(a,l.readTime),s=s.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),s=s.insert(a,l)):k("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Is:s,ds:i}})}function S9(n,e){let t=H(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function fl(n,e){let t=H(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Gr.getTargetData(r,e).next(o=>o?(i=o,M.resolve(i)):t.Gr.allocateTargetId(r).next(s=>(i=new dl(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Gr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.us.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.us=t.us.insert(r.targetId,r),t.cs.set(e,r.targetId)),r})}function pl(n,e,t){return N(this,null,function*(){let r=H(n),i=r.us.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!ao(s))throw s;k("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.us=r.us.remove(e),r.cs.delete(i.target)})}function zg(n,e,t){let r=H(n),i=J.min(),o=he();return r.persistence.runTransaction("Execute query","readwrite",s=>function(l,c,d){let f=H(l),g=f.cs.get(d);return g!==void 0?M.resolve(f.us.get(g)):f.Gr.getTargetData(c,d)}(r,s,Jt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Gr.getMatchingKeysForTargetId(s,a.targetId).next(l=>{o=l})}).next(()=>r._s.getDocumentsMatchingQuery(s,e,t?i:J.min(),t?o:he())).next(a=>(m1(r,AO(e),a),{documents:a,Es:o})))}function p1(n,e){let t=H(n),r=H(t.Gr),i=t.us.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.ut(o,e).next(s=>s?s.target:null))}function g1(n,e){let t=H(n),r=t.ls.get(e)||J.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.hs.getAllFromCollectionGroup(i,e,aO(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(m1(t,e,i),i))}function m1(n,e,t){let r=n.ls.get(e)||J.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.ls.set(e,r)}function A9(n,e,t,r){return N(this,null,function*(){let i=H(n),o=he(),s=an();for(let c of t){let d=e.As(c.metadata.name);c.document&&(o=o.add(d));let f=e.Rs(c);f.setReadTime(e.Vs(c.metadata.readTime)),s=s.insert(d,f)}let a=i.hs.newChangeBuffer({trackRemovals:!0}),l=yield fl(i,function(d){return Jt(Il(Se.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>f1(c,a,s).next(d=>(a.apply(c),d)).next(d=>i.Gr.removeMatchingKeysForTargetId(c,l.targetId).next(()=>i.Gr.addMatchingKeys(c,o,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,d.Is,d.ds)).next(()=>d.Is)))})}function M9(r,i){return N(this,arguments,function*(n,e,t=he()){let o=yield fl(n,Jt(tT(e.bundledQuery))),s=H(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{let l=at(e.readTime);if(o.snapshotVersion.compareTo(l)>=0)return s.jr.saveNamedQuery(a,e);let c=o.withResumeToken(lt.EMPTY_BYTE_STRING,l);return s.us=s.us.insert(c.targetId,c),s.Gr.updateTargetData(a,c).next(()=>s.Gr.removeMatchingKeysForTargetId(a,o.targetId)).next(()=>s.Gr.addMatchingKeys(a,t,o.targetId)).next(()=>s.jr.saveNamedQuery(a,e))})})}function qk(n,e){return`firestore_clients_${n}_${e}`}function Gk(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function GI(n,e){return`firestore_targets_${n}_${e}`}var Wg=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static fs(e,t,r){let i=JSON.parse(r),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new P(i.error.code,i.error.message))),s?new n(e,t,i.state,o):(ot("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}gs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},td=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static fs(e,t){let r=JSON.parse(t),i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new P(r.error.code,r.error.message))),o?new n(e,r.state,i):(ot("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}gs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Kg=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static fs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=JD();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=dO(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new n(e,o):(ot("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},sD=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static fs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ot("SharedClientState",`Failed to parse online state: ${e}`),null)}},vd=class{constructor(){this.activeTargetIds=JD()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},nd=class{constructor(e,t,r,i,o){this.window=e,this.li=t,this.persistenceKey=r,this.ws=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ss=this.bs.bind(this),this.Ds=new ze(le),this.started=!1,this.vs=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Cs=qk(this.persistenceKey,this.ws),this.Fs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ds=this.Ds.insert(this.ws,new vd),this.Ms=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.xs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Os=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.Ns=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Bs=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ss)}static p(e){return!(!e||!e.localStorage)}start(){return N(this,null,function*(){let e=yield this.syncEngine.$i();for(let r of e){if(r===this.ws)continue;let i=this.getItem(qk(this.persistenceKey,r));if(i){let o=Kg.fs(r,i);o&&(this.Ds=this.Ds.insert(o.clientId,o))}}this.Ls();let t=this.storage.getItem(this.Ns);if(t){let r=this.ks(t);r&&this.qs(r)}for(let r of this.vs)this.bs(r);this.vs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Fs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Qs(this.Ds)}isActiveQueryTarget(e){let t=!1;return this.Ds.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ks(e,"pending")}updateMutationState(e,t,r){this.Ks(e,t,r),this.$s(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(GI(this.persistenceKey,e));if(i){let o=td.fs(e,i);o&&(r=o.state)}}return t&&this.Us.ps(e),this.Ls(),r}removeLocalQueryTarget(e){this.Us.ys(e),this.Ls()}isLocalQueryTarget(e){return this.Us.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(GI(this.persistenceKey,e))}updateQueryState(e,t,r){this.Ws(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.$s(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Gs(e)}notifyBundleLoaded(e){this.zs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ss),this.removeItem(this.Cs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return k("SharedClientState","READ",e,t),t}setItem(e,t){k("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){k("SharedClientState","REMOVE",e),this.storage.removeItem(e)}bs(e){let t=e;if(t.storageArea===this.storage){if(k("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Cs)return void ot("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.li.enqueueRetryable(()=>N(this,null,function*(){if(this.started){if(t.key!==null){if(this.Ms.test(t.key)){if(t.newValue==null){let r=this.js(t.key);return this.Hs(r,null)}{let r=this.Js(t.key,t.newValue);if(r)return this.Hs(r.clientId,r)}}else if(this.xs.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(this.Os.test(t.key)){if(t.newValue!==null){let r=this.Xs(t.key,t.newValue);if(r)return this.eo(r)}}else if(t.key===this.Ns){if(t.newValue!==null){let r=this.ks(t.newValue);if(r)return this.qs(r)}}else if(t.key===this.Fs){let r=function(o){let s=In.oe;if(o!=null)try{let a=JSON.parse(o);K(typeof a=="number"),s=a}catch(a){ot("SharedClientState","Failed to read sequence number from WebStorage",a)}return s}(t.newValue);r!==In.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Bs){let r=this.no(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.ro(i)))}}}else this.vs.push(t)}))}}get Us(){return this.Ds.get(this.ws)}Ls(){this.setItem(this.Cs,this.Us.gs())}Ks(e,t,r){let i=new Wg(this.currentUser,e,t,r),o=Gk(this.persistenceKey,this.currentUser,e);this.setItem(o,i.gs())}$s(e){let t=Gk(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Gs(e){let t={clientId:this.ws,onlineState:e};this.storage.setItem(this.Ns,JSON.stringify(t))}Ws(e,t,r){let i=GI(this.persistenceKey,e),o=new td(e,t,r);this.setItem(i,o.gs())}zs(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Bs,t)}js(e){let t=this.Ms.exec(e);return t?t[1]:null}Js(e,t){let r=this.js(e);return Kg.fs(r,t)}Ys(e,t){let r=this.xs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Wg.fs(new ht(o),i,t)}Xs(e,t){let r=this.Os.exec(e),i=Number(r[1]);return td.fs(i,t)}ks(e){return sD.fs(e)}no(e){return JSON.parse(e)}Zs(e){return N(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.io(e.batchId,e.state,e.error);k("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}eo(e){return this.syncEngine.so(e.targetId,e.state,e.error)}Hs(e,t){let r=t?this.Ds.insert(e,t):this.Ds.remove(e),i=this.Qs(this.Ds),o=this.Qs(r),s=[],a=[];return o.forEach(l=>{i.has(l)||s.push(l)}),i.forEach(l=>{o.has(l)||a.push(l)}),this.syncEngine.oo(s,a).then(()=>{this.Ds=r})}qs(e){this.Ds.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Qs(e){let t=JD();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Qg=class{constructor(){this._o=new vd,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,t,r){this.ao[e]=t}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new vd,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var aD=class{uo(e){}shutdown(){}};var Yg=class{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){k("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.To)e(0)}Po(){k("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var dg=null;function zI(){return dg===null?dg=function(){return 268435456+Math.round(2147483648*Math.random())}():dg++,"0x"+dg.toString(16)}var R9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var lD=class{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}};var Bt="WebChannelConnection",uD=class extends class{get Co(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Fo=r+"://"+t.host,this.Mo=`projects/${i}/databases/${o}`,this.xo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Oo(t,r,i,o,s){let a=zI(),l=this.No(t,r.toUriEncodedString());k("RestConnection",`Sending RPC '${t}' ${a}:`,l,i);let c={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Bo(c,o,s),this.Lo(t,l,c,i).then(d=>(k("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Zn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}ko(t,r,i,o,s,a){return this.Oo(t,r,i,o,s)}Bo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+El}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}No(t,r){let i=R9[t];return`${this.Fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Lo(e,t,r,i){let o=zI();return new Promise((s,a)=>{let l=new LI;l.setWithCredentials(!0),l.listenOnce(jI.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Gc.NO_ERROR:let d=l.getResponseJson();k(Bt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),s(d);break;case Gc.TIMEOUT:k(Bt,`RPC '${e}' ${o} timed out`),a(new P(x.DEADLINE_EXCEEDED,"Request time out"));break;case Gc.HTTP_ERROR:let f=l.getStatus();if(k(Bt,`RPC '${e}' ${o} failed with status:`,f,"response text:",l.getResponseText()),f>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);let m=g?.error;if(m&&m.status&&m.message){let v=function(S){let O=S.toLowerCase().replace(/_/g,"-");return Object.values(x).indexOf(O)>=0?O:x.UNKNOWN}(m.status);a(new P(v,m.message))}else a(new P(x.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new P(x.UNAVAILABLE,"Connection failed."));break;default:G()}}finally{k(Bt,`RPC '${e}' ${o} completed.`)}});let c=JSON.stringify(i);k(Bt,`RPC '${e}' ${o} sending request:`,i),l.send(t,"POST",c,r,15)})}qo(e,t,r){let i=zI(),o=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=$I(),a=UI(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Bo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let d=o.join("");k(Bt,`Creating RPC '${e}' stream ${i}: ${d}`,l);let f=s.createWebChannel(d,l),g=!1,m=!1,v=new lD({Eo:S=>{m?k(Bt,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(g||(k(Bt,`Opening RPC '${e}' stream ${i} transport.`),f.open(),g=!0),k(Bt,`RPC '${e}' stream ${i} sending:`,S),f.send(S))},Ao:()=>f.close()}),T=(S,O,B)=>{S.listen(O,F=>{try{B(F)}catch(W){setTimeout(()=>{throw W},0)}})};return T(f,qa.EventType.OPEN,()=>{m||(k(Bt,`RPC '${e}' stream ${i} transport opened.`),v.So())}),T(f,qa.EventType.CLOSE,()=>{m||(m=!0,k(Bt,`RPC '${e}' stream ${i} transport closed`),v.Do())}),T(f,qa.EventType.ERROR,S=>{m||(m=!0,Zn(Bt,`RPC '${e}' stream ${i} transport errored:`,S),v.Do(new P(x.UNAVAILABLE,"The operation could not be completed")))}),T(f,qa.EventType.MESSAGE,S=>{var O;if(!m){let B=S.data[0];K(!!B);let F=B,W=F?.error||((O=F[0])===null||O===void 0?void 0:O.error);if(W){k(Bt,`RPC '${e}' stream ${i} received error:`,W);let oe=W.status,X=function(E){let C=ct[E];if(C!==void 0)return $O(C)}(oe),I=W.message;X===void 0&&(X=x.INTERNAL,I="Unknown error status: "+oe+" with message "+W.message),m=!0,v.Do(new P(X,I)),f.close()}else k(Bt,`RPC '${e}' stream ${i} received:`,B),v.vo(B)}}),T(a,BI.STAT_EVENT,S=>{S.stat===sg.PROXY?k(Bt,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===sg.NOPROXY&&k(Bt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.bo()},0),v}};function y1(){return typeof window<"u"?window:null}function yg(){return typeof document<"u"?document:null}function Md(n){return new TC(n,!0)}var wd=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.li=e,this.timerId=t,this.Qo=r,this.Ko=i,this.$o=o,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();let t=Math.floor(this.Uo+this.Ho()),r=Math.max(0,Date.now()-this.Go),i=Math.max(0,t-r);i>0&&k("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Uo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,i,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}};var Zg=class{constructor(e,t,r,i,o,s,a,l){this.li=e,this.Yo=r,this.Zo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new wd(e,t)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}stop(){return N(this,null,function*(){this.i_()&&(yield this.close(0))})}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}u_(){return N(this,null,function*(){if(this.s_())return this.close(0)})}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}close(e,t){return N(this,null,function*(){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():t&&t.code===x.RESOURCE_EXHAUSTED?(ot(t.toString()),ot("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):t&&t.code===x.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.po(t)})}P_(){}auth(){this.state=1;let e=this.T_(this.Xo),t=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Xo===t&&this.I_(r,i)},r=>{e(()=>{let i=new P(x.UNKNOWN,"Fetching auth token failed: "+r.message);return this.d_(i)})})}I_(e,t){let r=this.T_(this.Xo);this.stream=this.E_(e,t),this.stream.Ro(()=>{r(()=>this.listener.Ro())}),this.stream.mo(()=>{r(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(i=>{r(()=>this.d_(i))}),this.stream.onMessage(i=>{r(()=>++this.n_==1?this.A_(i):this.onNext(i))})}o_(){this.state=5,this.r_.jo(()=>N(this,null,function*(){this.state=0,this.start()}))}d_(e){return k("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return t=>{this.li.enqueueAndForget(()=>this.Xo===e?t():(k("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},cD=class extends Zg{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}E_(e,t){return this.connection.qo("Listen",e,t)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();let t=g9(this.serializer,e),r=function(o){if(!("targetChange"in o))return J.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?J.min():s.readTime?at(s.readTime):J.min()}(e);return this.listener.R_(t,r)}V_(e){let t={};t.database=AC(this.serializer),t.addTarget=function(o,s){let a,l=s.target;if(a=Sg(l)?{documents:YO(o,l)}:{query:ZO(o,l).ct},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=qO(o,s.resumeToken);let c=bC(o,s.expectedCount);c!==null&&(a.expectedCount=c)}else if(s.snapshotVersion.compareTo(J.min())>0){a.readTime=cl(o,s.snapshotVersion.toTimestamp());let c=bC(o,s.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=y9(this.serializer,e);r&&(t.labels=r),this.c_(t)}m_(e){let t={};t.database=AC(this.serializer),t.removeTarget=e,this.c_(t)}},dD=class extends Zg{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}E_(e,t){return this.connection.qo("Write",e,t)}A_(e){return K(!!e.streamToken),this.lastStreamToken=e.streamToken,K(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){K(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();let t=m9(e.writeResults,e.commitTime),r=at(e.commitTime);return this.listener.y_(r,t)}w_(){let e={};e.database=AC(this.serializer),this.c_(e)}g_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>gd(this.serializer,r))};this.c_(t)}};var hD=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.S_=!1}b_(){if(this.S_)throw new P(x.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,t,r,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Oo(e,SC(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new P(x.UNKNOWN,o.toString())})}ko(e,t,r,i,o){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.ko(e,SC(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new P(x.UNKNOWN,s.toString())})}terminate(){this.S_=!0,this.connection.terminate()}},fD=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(ot(t),this.C_=!1):k("OnlineStateTracker",t)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}};var pD=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.B_=[],this.L_=new Map,this.k_=new Set,this.q_=[],this.Q_=o,this.Q_.uo(s=>{r.enqueueAndForget(()=>N(this,null,function*(){uo(this)&&(k("RemoteStore","Restarting streams for network reachability change."),yield function(l){return N(this,null,function*(){let c=H(l);c.k_.add(4),yield Cl(c),c.K_.set("Unknown"),c.k_.delete(4),yield Rd(c)})}(this))}))}),this.K_=new fD(r,i)}};function Rd(n){return N(this,null,function*(){if(uo(n))for(let e of n.q_)yield e(!0)})}function Cl(n){return N(this,null,function*(){for(let e of n.q_)yield e(!1)})}function vm(n,e){let t=H(n);t.L_.has(e.targetId)||(t.L_.set(e.targetId,e),sT(t)?oT(t):Tl(t).s_()&&iT(t,e))}function gl(n,e){let t=H(n),r=Tl(t);t.L_.delete(e),r.s_()&&_1(t,e),t.L_.size===0&&(r.s_()?r.a_():uo(t)&&t.K_.set("Unknown"))}function iT(n,e){if(n.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(J.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Tl(n).V_(e)}function _1(n,e){n.U_.xe(e),Tl(n).m_(e)}function oT(n){n.U_=new DC({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>n.L_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),Tl(n).start(),n.K_.F_()}function sT(n){return uo(n)&&!Tl(n).i_()&&n.L_.size>0}function uo(n){return H(n).k_.size===0}function v1(n){n.U_=void 0}function N9(n){return N(this,null,function*(){n.K_.set("Online")})}function x9(n){return N(this,null,function*(){n.L_.forEach((e,t)=>{iT(n,e)})})}function P9(n,e){return N(this,null,function*(){v1(n),sT(n)?(n.K_.O_(e),oT(n)):n.K_.set("Unknown")})}function k9(n,e,t){return N(this,null,function*(){if(n.K_.set("Online"),e instanceof Ng&&e.state===2&&e.cause)try{yield function(i,o){return N(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.L_.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.L_.delete(a),i.U_.removeTarget(a))})}(n,e)}catch(r){k("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Jg(n,r)}else if(e instanceof rl?n.U_.$e(e):e instanceof Rg?n.U_.Je(e):n.U_.Ge(e),!t.isEqual(J.min()))try{let r=yield h1(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.U_.it(s);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){let d=o.L_.get(c);d&&o.L_.set(c,d.withResumeToken(l.resumeToken,s))}}),a.targetMismatches.forEach((l,c)=>{let d=o.L_.get(l);if(!d)return;o.L_.set(l,d.withResumeToken(lt.EMPTY_BYTE_STRING,d.snapshotVersion)),_1(o,l);let f=new dl(d.target,l,c,d.sequenceNumber);iT(o,f)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){k("RemoteStore","Failed to raise snapshot:",r),yield Jg(n,r)}})}function Jg(n,e,t){return N(this,null,function*(){if(!ao(e))throw e;n.k_.add(1),yield Cl(n),n.K_.set("Offline"),t||(t=()=>h1(n.localStore)),n.asyncQueue.enqueueRetryable(()=>N(this,null,function*(){k("RemoteStore","Retrying IndexedDB access"),yield t(),n.k_.delete(1),yield Rd(n)}))})}function w1(n,e){return e().catch(t=>Jg(n,t,e))}function Dl(n){return N(this,null,function*(){let e=H(n),t=oo(e),r=e.B_.length>0?e.B_[e.B_.length-1].batchId:-1;for(;O9(e);)try{let i=yield S9(e.localStore,r);if(i===null){e.B_.length===0&&t.a_();break}r=i.batchId,F9(e,i)}catch(i){yield Jg(e,i)}E1(e)&&I1(e)})}function O9(n){return uo(n)&&n.B_.length<10}function F9(n,e){n.B_.push(e);let t=oo(n);t.s_()&&t.f_&&t.g_(e.mutations)}function E1(n){return uo(n)&&!oo(n).i_()&&n.B_.length>0}function I1(n){oo(n).start()}function V9(n){return N(this,null,function*(){oo(n).w_()})}function L9(n){return N(this,null,function*(){let e=oo(n);for(let t of n.B_)e.g_(t.mutations)})}function j9(n,e,t){return N(this,null,function*(){let r=n.B_.shift(),i=EC.from(r,e,t);yield w1(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Dl(n)})}function B9(n,e){return N(this,null,function*(){e&&oo(n).f_&&(yield function(r,i){return N(this,null,function*(){if(function(s){return UO(s)&&s!==x.ABORTED}(i.code)){let o=r.B_.shift();oo(r).__(),yield w1(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Dl(r)}})}(n,e)),E1(n)&&I1(n)})}function zk(n,e){return N(this,null,function*(){let t=H(n);t.asyncQueue.verifyOperationInProgress(),k("RemoteStore","RemoteStore received new credentials");let r=uo(t);t.k_.add(3),yield Cl(t),r&&t.K_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.k_.delete(3),yield Rd(t)})}function gD(n,e){return N(this,null,function*(){let t=H(n);e?(t.k_.delete(2),yield Rd(t)):e||(t.k_.add(2),yield Cl(t),t.K_.set("Unknown"))})}function Tl(n){return n.W_||(n.W_=function(t,r,i){let o=H(t);return o.b_(),new cD(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Ro:N9.bind(null,n),mo:x9.bind(null,n),po:P9.bind(null,n),R_:k9.bind(null,n)}),n.q_.push(e=>N(this,null,function*(){e?(n.W_.__(),sT(n)?oT(n):n.K_.set("Unknown")):(yield n.W_.stop(),v1(n))}))),n.W_}function oo(n){return n.G_||(n.G_=function(t,r,i){let o=H(t);return o.b_(),new dD(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Ro:()=>Promise.resolve(),mo:V9.bind(null,n),po:B9.bind(null,n),p_:L9.bind(null,n),y_:j9.bind(null,n)}),n.q_.push(e=>N(this,null,function*(){e?(n.G_.__(),yield Dl(n)):(yield n.G_.stop(),n.B_.length>0&&(k("RemoteStore",`Stopping write stream with ${n.B_.length} pending writes`),n.B_=[]))}))),n.G_}var mD=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new _t,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(x.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function bl(n,e){if(ot("AsyncQueue",`${e}: ${n}`),ao(n))return new P(x.UNAVAILABLE,`${e}: ${n}`);throw n}var Xg=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||q.comparator(t.key,r.key):(t,r)=>q.comparator(t.key,r.key),this.keyedMap=Yc(),this.sortedSet=new ze(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var em=class{constructor(){this.z_=new ze(q.comparator)}track(e){let t=e.doc.key,r=this.z_.get(t);r?e.type!==0&&r.type===3?this.z_=this.z_.insert(t,e):e.type===3&&r.type!==1?this.z_=this.z_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.z_=this.z_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.z_=this.z_.remove(t):e.type===1&&r.type===2?this.z_=this.z_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):G():this.z_=this.z_.insert(t,e)}j_(){let e=[];return this.z_.inorderTraversal((t,r)=>{e.push(r)}),e}},ml=class n{constructor(e,t,r,i,o,s,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Xg.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Sd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var yD=class{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}},_D=class{constructor(){this.queries=Wk(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(t,r){let i=H(t),o=i.queries;i.queries=Wk(),o.forEach((s,a)=>{for(let l of a.J_)l.onError(r)})})(this,new P(x.ABORTED,"Firestore shutting down"))}};function Wk(){return new Xn(n=>SO(n),Sd)}function aT(n,e){return N(this,null,function*(){let t=H(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Y_()&&e.Z_()&&(r=2):(o=new yD,r=e.Z_()?0:1);try{switch(r){case 0:o.H_=yield t.onListen(i,!0);break;case 1:o.H_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=bl(s,`Initialization of query '${Ya(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.J_.push(e),e.ea(t.onlineState),o.H_&&e.ta(o.H_)&&uT(t)})}function lT(n,e){return N(this,null,function*(){let t=H(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.J_.indexOf(e);s>=0&&(o.J_.splice(s,1),o.J_.length===0?i=e.Z_()?0:1:!o.Y_()&&e.Z_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function U9(n,e){let t=H(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.J_)a.ta(i)&&(r=!0);s.H_=i}}r&&uT(t)}function $9(n,e,t){let r=H(n),i=r.queries.get(e);if(i)for(let o of i.J_)o.onError(t);r.queries.delete(e)}function uT(n){n.X_.forEach(e=>{e.next()})}var vD,Kk;(Kk=vD||(vD={})).na="default",Kk.Cache="cache";var Ed=class{constructor(e,t,r){this.query=e,this.ra=t,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=r||{}}ta(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ml(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ia?this.oa(e)&&(this.ra.next(e),t=!0):this._a(e,this.onlineState)&&(this.aa(e),t=!0),this.sa=e,t}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let t=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),t=!0),t}_a(e,t){if(!e.fromCache||!this.Z_())return!0;let r=t!=="Offline";return(!this.options.ua||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}oa(e){if(e.docChanges.length>0)return!0;let t=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}aa(e){e=ml.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==vD.Cache}};var wD=class{constructor(e,t){this.ca=e,this.byteLength=t}la(){return"metadata"in this.ca}};var tm=class{constructor(e){this.serializer=e}As(e){return Ir(this.serializer,e)}Rs(e){return e.metadata.exists?QO(this.serializer,e.document,!1):ft.newNoDocument(this.As(e.metadata.name),this.Vs(e.metadata.readTime))}Vs(e){return at(e)}},ED=class{constructor(e,t,r){this.ha=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=C1(e)}Pa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ca.namedQuery)this.queries.push(e.ca.namedQuery);else if(e.ca.documentMetadata){this.documents.push({metadata:e.ca.documentMetadata}),e.ca.documentMetadata.exists||++t;let r=Se.fromString(e.ca.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ca.document&&(this.documents[this.documents.length-1].document=e.ca.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ta(e){let t=new Map,r=new tm(this.serializer);for(let i of e)if(i.metadata.queries){let o=r.As(i.metadata.name);for(let s of i.metadata.queries){let a=(t.get(s)||he()).add(o);t.set(s,a)}}return t}complete(){return N(this,null,function*(){let e=yield A9(this.localStore,new tm(this.serializer),this.documents,this.ha.id),t=this.Ta(this.documents);for(let r of this.queries)yield M9(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Ia:this.collectionGroups,da:e}})}};function C1(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var nm=class{constructor(e){this.key=e}},rm=class{constructor(e){this.key=e}},im=class{constructor(e,t){this.query=e,this.Ea=t,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=he(),this.mutatedKeys=he(),this.Va=MO(e),this.ma=new Xg(this.Va)}get fa(){return this.Ea}ga(e,t){let r=t?t.pa:new em,i=t?t.ma:this.ma,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{let g=i.get(d),m=Ad(this.query,f)?f:null,v=!!g&&this.mutatedKeys.has(g.key),T=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations),S=!1;g&&m?g.data.isEqual(m.data)?v!==T&&(r.track({type:3,doc:m}),S=!0):this.ya(g,m)||(r.track({type:2,doc:m}),S=!0,(l&&this.Va(m,l)>0||c&&this.Va(m,c)<0)&&(a=!0)):!g&&m?(r.track({type:0,doc:m}),S=!0):g&&!m&&(r.track({type:1,doc:g}),S=!0,(l||c)&&(a=!0)),S&&(m?(s=s.add(m),o=T?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),r.track({type:1,doc:d})}return{ma:s,pa:r,ss:a,mutatedKeys:o}}ya(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;let s=e.pa.j_();s.sort((d,f)=>function(m,v){let T=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return G()}};return T(m)-T(v)}(d.type,f.type)||this.Va(d.doc,f.doc)),this.wa(r),i=i!=null&&i;let a=t&&!i?this.Sa():[],l=this.Ra.size===0&&this.current&&!i?1:0,c=l!==this.Aa;return this.Aa=l,s.length!==0||c?{snapshot:new ml(this.query,e.ma,o,s,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),ba:a}:{ba:a}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new em,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.Ea.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(t=>this.Ea=this.Ea.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ea=this.Ea.delete(t)),this.current=e.current)}Sa(){if(!this.current)return[];let e=this.Ra;this.Ra=he(),this.ma.forEach(r=>{this.Da(r.key)&&(this.Ra=this.Ra.add(r.key))});let t=[];return e.forEach(r=>{this.Ra.has(r)||t.push(new rm(r))}),this.Ra.forEach(r=>{e.has(r)||t.push(new nm(r))}),t}va(e){this.Ea=e.Es,this.Ra=he();let t=this.ga(e.documents);return this.applyChanges(t,!0)}Ca(){return ml.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}},ID=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},CD=class{constructor(e){this.key=e,this.Fa=!1}},DD=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ma={},this.xa=new Xn(a=>SO(a),Sd),this.Oa=new Map,this.Na=new Set,this.Ba=new ze(q.comparator),this.La=new Map,this.ka=new yd,this.qa={},this.Qa=new Map,this.Ka=hl.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}};function H9(n,e,t=!0){return N(this,null,function*(){let r=wm(n),i,o=r.xa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Ca()):i=yield D1(r,e,t,!0),i})}function q9(n,e){return N(this,null,function*(){let t=wm(n);yield D1(t,e,!0,!1)})}function D1(n,e,t,r){return N(this,null,function*(){let i=yield fl(n.localStore,Jt(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield cT(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&vm(n.remoteStore,i),a})}function cT(n,e,t,r,i){return N(this,null,function*(){n.Ua=(f,g,m)=>function(T,S,O,B){return N(this,null,function*(){let F=S.view.ga(O);F.ss&&(F=yield zg(T.localStore,S.query,!1).then(({documents:I})=>S.view.ga(I,F)));let W=B&&B.targetChanges.get(S.targetId),oe=B&&B.targetMismatches.get(S.targetId)!=null,X=S.view.applyChanges(F,T.isPrimaryClient,W,oe);return TD(T,S.targetId,X.ba),X.snapshot})}(n,f,g,m);let o=yield zg(n.localStore,e,!0),s=new im(e,o.Es),a=s.ga(o.documents),l=fd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=s.applyChanges(a,n.isPrimaryClient,l);TD(n,t,c.ba);let d=new ID(e,t,s);return n.xa.set(e,d),n.Oa.has(t)?n.Oa.get(t).push(e):n.Oa.set(t,[e]),c.snapshot})}function G9(n,e,t){return N(this,null,function*(){let r=H(n),i=r.xa.get(e),o=r.Oa.get(i.targetId);if(o.length>1)return r.Oa.set(i.targetId,o.filter(s=>!Sd(s,e))),void r.xa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield pl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&gl(r.remoteStore,i.targetId),yl(r,i.targetId)}).catch(so))):(yl(r,i.targetId),yield pl(r.localStore,i.targetId,!0))})}function z9(n,e){return N(this,null,function*(){let t=H(n),r=t.xa.get(e),i=t.Oa.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),gl(t.remoteStore,r.targetId))})}function W9(n,e,t){return N(this,null,function*(){let r=pT(n);try{let i=yield function(s,a){let l=H(s),c=Je.now(),d=a.reduce((m,v)=>m.add(v.key),he()),f,g;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let v=an(),T=he();return l.hs.getEntries(m,d).next(S=>{v=S,v.forEach((O,B)=>{B.isValidDocument()||(T=T.add(O))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,v)).next(S=>{f=S;let O=[];for(let B of a){let F=l9(B,f.get(B.key).overlayedDocument);F!=null&&O.push(new er(B.key,F,wO(F.value.mapValue),rt.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,O,a)}).next(S=>{g=S;let O=S.applyToLocalDocumentSet(f,T);return l.documentOverlayCache.saveOverlays(m,S.batchId,O)})}).then(()=>({batchId:g.batchId,changes:NO(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,l){let c=s.qa[s.currentUser.toKey()];c||(c=new ze(le)),c=c.insert(a,l),s.qa[s.currentUser.toKey()]=c}(r,i.batchId,t),yield oi(r,i.changes),yield Dl(r.remoteStore)}catch(i){let o=bl(i,"Failed to persist write");t.reject(o)}})}function T1(n,e){return N(this,null,function*(){let t=H(n);try{let r=yield b9(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.La.get(o);s&&(K(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.Fa=!0:i.modifiedDocuments.size>0?K(s.Fa):i.removedDocuments.size>0&&(K(s.Fa),s.Fa=!1))}),yield oi(t,r,e)}catch(r){yield so(r)}})}function Qk(n,e,t){let r=H(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.xa.forEach((o,s)=>{let a=s.view.ea(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let l=H(s);l.onlineState=a;let c=!1;l.queries.forEach((d,f)=>{for(let g of f.J_)g.ea(a)&&(c=!0)}),c&&uT(l)}(r.eventManager,e),i.length&&r.Ma.R_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function K9(n,e,t){return N(this,null,function*(){let r=H(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.La.get(e),o=i&&i.key;if(o){let s=new ze(q.comparator);s=s.insert(o,ft.newNoDocument(o,J.min()));let a=he().add(o),l=new hd(J.min(),new Map,new ze(le),s,a);yield T1(r,l),r.Ba=r.Ba.remove(o),r.La.delete(e),fT(r)}else yield pl(r.localStore,e,!1).then(()=>yl(r,e,t)).catch(so)})}function Q9(n,e){return N(this,null,function*(){let t=H(n),r=e.batch.batchId;try{let i=yield T9(t.localStore,e);hT(t,r,null),dT(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield oi(t,i)}catch(i){yield so(i)}})}function Y9(n,e,t){return N(this,null,function*(){let r=H(n);try{let i=yield function(s,a){let l=H(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(f=>(K(f!==null),d=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);hT(r,e,t),dT(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield oi(r,i)}catch(i){yield so(i)}})}function Z9(n,e){return N(this,null,function*(){let t=H(n);uo(t.remoteStore)||k("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(s){let a=H(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Qa.get(r)||[];i.push(e),t.Qa.set(r,i)}catch(r){let i=bl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function dT(n,e){(n.Qa.get(e)||[]).forEach(t=>{t.resolve()}),n.Qa.delete(e)}function hT(n,e,t){let r=H(n),i=r.qa[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.qa[r.currentUser.toKey()]=i}}function yl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Oa.get(e))n.xa.delete(r),t&&n.Ma.Wa(r,t);n.Oa.delete(e),n.isPrimaryClient&&n.ka.yr(e).forEach(r=>{n.ka.containsKey(r)||b1(n,r)})}function b1(n,e){n.Na.delete(e.path.canonicalString());let t=n.Ba.get(e);t!==null&&(gl(n.remoteStore,t),n.Ba=n.Ba.remove(e),n.La.delete(t),fT(n))}function TD(n,e,t){for(let r of t)r instanceof nm?(n.ka.addReference(r.key,e),J9(n,r)):r instanceof rm?(k("SyncEngine","Document no longer in limbo: "+r.key),n.ka.removeReference(r.key,e),n.ka.containsKey(r.key)||b1(n,r.key)):G()}function J9(n,e){let t=e.key,r=t.path.canonicalString();n.Ba.get(t)||n.Na.has(r)||(k("SyncEngine","New document in limbo: "+t),n.Na.add(r),fT(n))}function fT(n){for(;n.Na.size>0&&n.Ba.size<n.maxConcurrentLimboResolutions;){let e=n.Na.values().next().value;n.Na.delete(e);let t=new q(Se.fromString(e)),r=n.Ka.next();n.La.set(r,new CD(t)),n.Ba=n.Ba.insert(t,r),vm(n.remoteStore,new dl(Jt(Il(t.path)),r,"TargetPurposeLimboResolution",In.oe))}}function oi(n,e,t){return N(this,null,function*(){let r=H(n),i=[],o=[],s=[];r.xa.isEmpty()||(r.xa.forEach((a,l)=>{s.push(r.Ua(l,e,t).then(c=>{var d;if((c||t)&&r.isPrimaryClient){let f=c?!c.fromCache:(d=t?.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){i.push(c);let f=rD.zi(l.targetId,c);o.push(f)}}))}),yield Promise.all(s),r.Ma.R_(i),yield function(l,c){return N(this,null,function*(){let d=H(l);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>M.forEach(c,g=>M.forEach(g.Wi,m=>d.persistence.referenceDelegate.addReference(f,g.targetId,m)).next(()=>M.forEach(g.Gi,m=>d.persistence.referenceDelegate.removeReference(f,g.targetId,m)))))}catch(f){if(!ao(f))throw f;k("LocalStore","Failed to update sequence numbers: "+f)}for(let f of c){let g=f.targetId;if(!f.fromCache){let m=d.us.get(g),v=m.snapshotVersion,T=m.withLastLimboFreeSnapshotVersion(v);d.us=d.us.insert(g,T)}}})}(r.localStore,o))})}function X9(n,e){return N(this,null,function*(){let t=H(n);if(!t.currentUser.isEqual(e)){k("SyncEngine","User change. New user:",e.toKey());let r=yield d1(t.localStore,e);t.currentUser=e,function(o,s){o.Qa.forEach(a=>{a.forEach(l=>{l.reject(new P(x.CANCELLED,s))})}),o.Qa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield oi(t,r.Ts)}})}function e3(n,e){let t=H(n),r=t.La.get(e);if(r&&r.Fa)return he().add(r.key);{let i=he(),o=t.Oa.get(e);if(!o)return i;for(let s of o){let a=t.xa.get(s);i=i.unionWith(a.view.fa)}return i}}function t3(n,e){return N(this,null,function*(){let t=H(n),r=yield zg(t.localStore,e.query,!0),i=e.view.va(r);return t.isPrimaryClient&&TD(t,e.targetId,i.ba),i})}function n3(n,e){return N(this,null,function*(){let t=H(n);return g1(t.localStore,e).then(r=>oi(t,r))})}function r3(n,e,t,r){return N(this,null,function*(){let i=H(n),o=yield function(a,l){let c=H(a),d=H(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.On(f,l).next(g=>g?c.localDocuments.getDocuments(f,g):M.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?yield Dl(i.remoteStore):t==="acknowledged"||t==="rejected"?(hT(i,e,r||null),dT(i,e),function(a,l){H(H(a).mutationQueue).Bn(l)}(i.localStore,e)):G(),yield oi(i,o)):k("SyncEngine","Cannot apply mutation batch with id: "+e)})}function i3(n,e){return N(this,null,function*(){let t=H(n);if(wm(t),pT(t),e===!0&&t.$a!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield Yk(t,r.toArray());t.$a=!0,yield gD(t.remoteStore,!0);for(let o of i)vm(t.remoteStore,o)}else if(e===!1&&t.$a!==!1){let r=[],i=Promise.resolve();t.Oa.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then(()=>(yl(t,s),pl(t.localStore,s,!0))),gl(t.remoteStore,s)}),yield i,yield Yk(t,r),function(s){let a=H(s);a.La.forEach((l,c)=>{gl(a.remoteStore,c)}),a.ka.wr(),a.La=new Map,a.Ba=new ze(q.comparator)}(t),t.$a=!1,yield gD(t.remoteStore,!1)}})}function Yk(n,e,t){return N(this,null,function*(){let r=H(n),i=[],o=[];for(let s of e){let a,l=r.Oa.get(s);if(l&&l.length!==0){a=yield fl(r.localStore,Jt(l[0]));for(let c of l){let d=r.xa.get(c),f=yield t3(r,d);f.snapshot&&o.push(f.snapshot)}}else{let c=yield p1(r.localStore,s);a=yield fl(r.localStore,c),yield cT(r,S1(c),s,!1,a.resumeToken)}i.push(a)}return r.Ma.R_(o),i})}function S1(n){return bO(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function o3(n){return function(t){return H(H(t).persistence).$i()}(H(n).localStore)}function s3(n,e,t,r){return N(this,null,function*(){let i=H(n);if(i.$a)return void k("SyncEngine","Ignoring unexpected query state notification.");let o=i.Oa.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield g1(i.localStore,AO(o[0])),a=hd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",lt.EMPTY_BYTE_STRING);yield oi(i,s,a);break}case"rejected":yield pl(i.localStore,e,!0),yl(i,e,r);break;default:G()}})}function a3(n,e,t){return N(this,null,function*(){let r=wm(n);if(r.$a){for(let i of e){if(r.Oa.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){k("SyncEngine","Adding an already active target "+i);continue}let o=yield p1(r.localStore,i),s=yield fl(r.localStore,o);yield cT(r,S1(o),s.targetId,!1,s.resumeToken),vm(r.remoteStore,s)}for(let i of t)r.Oa.has(i)&&(yield pl(r.localStore,i,!1).then(()=>{gl(r.remoteStore,i),yl(r,i)}).catch(so))}})}function wm(n){let e=H(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=T1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=e3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=K9.bind(null,e),e.Ma.R_=U9.bind(null,e.eventManager),e.Ma.Wa=$9.bind(null,e.eventManager),e}function pT(n){let e=H(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Q9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Y9.bind(null,e),e}function l3(n,e,t){let r=H(n);(function(o,s,a){return N(this,null,function*(){try{let l=yield s.getMetadata();if(yield function(m,v){let T=H(m),S=at(v.createTime);return T.persistence.runTransaction("hasNewerBundle","readonly",O=>T.jr.getBundleMetadata(O,v.id)).then(O=>!!O&&O.createTime.compareTo(S)>=0)}(o.localStore,l))return yield s.close(),a._completeWith(function(m){return{taskState:"Success",documentsLoaded:m.totalDocuments,bytesLoaded:m.totalBytes,totalDocuments:m.totalDocuments,totalBytes:m.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(C1(l));let c=new ED(l,o.localStore,s.serializer),d=yield s.Ga();for(;d;){let g=yield c.Pa(d);g&&a._updateProgress(g),d=yield s.Ga()}let f=yield c.complete();return yield oi(o,f.da,void 0),yield function(m,v){let T=H(m);return T.persistence.runTransaction("Save bundle","readwrite",S=>T.jr.saveBundleMetadata(S,v))}(o.localStore,l),a._completeWith(f.progress),Promise.resolve(f.Ia)}catch(l){return Zn("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var gT=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return N(this,null,function*(){this.serializer=Md(t.databaseInfo.databaseId),this.sharedClientState=this.za(t),this.persistence=this.ja(t),yield this.persistence.start(),this.localStore=this.Ha(t),this.gcScheduler=this.Ja(t,this.localStore),this.indexBackfillerScheduler=this.Ya(t,this.localStore)})}Ja(t,r){return null}Ya(t,r){return null}Ha(t){return c1(this.persistence,new Gg,t.initialUser,this.serializer)}ja(t){return new _d(Hg.ei,this.serializer)}za(t){return new Qg}terminate(){return N(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),bD=class extends gT{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,t){K(this.persistence.referenceDelegate instanceof qg);let r=this.persistence.referenceDelegate.garbageCollector;return new Bg(r,e.asyncQueue,t)}ja(e){let t=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new _d(r=>qg.ei(r,t),this.serializer)}},om=class n extends gT{constructor(e,t,r){super(),this.Za=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return N(this,null,function*(){yield iy(n.prototype,this,"initialize").call(this,e),yield this.Za.initialize(this,e),yield pT(this.Za.syncEngine),yield Dl(this.Za.remoteStore),yield this.persistence.Si(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}Ha(e){return c1(this.persistence,new Gg,e.initialUser,this.serializer)}Ja(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new Bg(r,e.asyncQueue,t)}Ya(e,t){let r=new oC(t,this.persistence);return new iC(e.asyncQueue,r)}ja(e){let t=rT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new nD(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,y1(),yg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}za(e){return new Qg}},SD=class n extends om{constructor(e,t){super(e,t,!1),this.Za=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return N(this,null,function*(){yield iy(n.prototype,this,"initialize").call(this,e);let t=this.Za.syncEngine;this.sharedClientState instanceof nd&&(this.sharedClientState.syncEngine={io:r3.bind(null,t),so:s3.bind(null,t),oo:a3.bind(null,t),$i:o3.bind(null,t),ro:n3.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.Si(r=>N(this,null,function*(){yield i3(this.Za.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}za(e){let t=y1();if(!nd.p(t))throw new P(x.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=rT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new nd(t,e.asyncQueue,r,e.clientId,e.initialUser)}},mT=(()=>{class n{initialize(t,r){return N(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Qk(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=X9.bind(null,this.syncEngine),yield gD(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new _D}()}createDatastore(t){let r=Md(t.databaseInfo.databaseId),i=function(s){return new uD(s)}(t.databaseInfo);return function(s,a,l,c){return new hD(s,a,l,c)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,s,a,l){return new pD(i,o,s,a,l)}(this.localStore,this.datastore,t.asyncQueue,r=>Qk(this.syncEngine,r,0),function(){return Yg.p()?new Yg:new aD}())}createSyncEngine(t,r){return function(o,s,a,l,c,d,f){let g=new DD(o,s,a,l,c,d);return f&&(g.$a=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return N(this,null,function*(){var t,r;yield function(o){return N(this,null,function*(){let s=H(o);k("RemoteStore","RemoteStore shutting down."),s.k_.add(5),yield Cl(s),s.Q_.shutdown(),s.K_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function Zk(n,e=10240){let t=0;return{read(){return N(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return N(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var _l=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):ot("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var AD=class{constructor(e,t){this.tu=e,this.serializer=t,this.metadata=new _t,this.buffer=new Uint8Array,this.nu=function(){return new TextDecoder("utf-8")}(),this.ru().then(r=>{r&&r.la()?this.metadata.resolve(r.ca.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ca)}`))},r=>this.metadata.reject(r))}close(){return this.tu.cancel()}getMetadata(){return N(this,null,function*(){return this.metadata.promise})}Ga(){return N(this,null,function*(){return yield this.getMetadata(),this.ru()})}ru(){return N(this,null,function*(){let e=yield this.iu();if(e===null)return null;let t=this.nu.decode(e),r=Number(t);isNaN(r)&&this.su(`length string (${t}) is not valid number`);let i=yield this.ou(r);return new wD(JSON.parse(i),e.length+r)})}_u(){return this.buffer.findIndex(e=>e===123)}iu(){return N(this,null,function*(){for(;this._u()<0&&!(yield this.au()););if(this.buffer.length===0)return null;let e=this._u();e<0&&this.su("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}ou(e){return N(this,null,function*(){for(;this.buffer.length<e;)(yield this.au())&&this.su("Reached the end of bundle when more is expected.");let t=this.nu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}su(e){throw this.tu.cancel(),new Error(`Invalid bundle format: ${e}`)}au(){return N(this,null,function*(){let e=yield this.tu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var MD=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return N(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new P(x.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,o){return N(this,null,function*(){let s=H(i),a={documents:o.map(f=>pd(s.serializer,f))},l=yield s.ko("BatchGetDocuments",s.serializer.databaseId,Se.emptyPath(),a,o.length),c=new Map;l.forEach(f=>{let g=p9(s.serializer,f);c.set(g.key.toString(),g)});let d=[];return o.forEach(f=>{let g=c.get(f.toString());K(!!g),d.push(g)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new io(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return N(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=q.fromPath(r);this.mutations.push(new ud(i,this.precondition(i)))}),yield function(r,i){return N(this,null,function*(){let o=H(r),s={writes:i.map(a=>gd(o.serializer,a))};yield o.Oo("Commit",o.serializer.databaseId,Se.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw G();t=J.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new P(x.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(J.min())?rt.exists(!1):rt.updateTime(t):rt.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(J.min()))throw new P(x.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rt.updateTime(t)}return rt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var RD=class{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this.uu=r.maxAttempts,this.r_=new wd(this.asyncQueue,"transaction_retry")}cu(){this.uu-=1,this.lu()}lu(){this.r_.jo(()=>N(this,null,function*(){let e=new MD(this.datastore),t=this.hu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Pu(i)}))}).catch(r=>{this.Pu(r)})}))}hu(e){try{let t=this.updateFunction(e);return!Td(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Pu(e){this.uu>0&&this.Tu(e)?(this.uu-=1,this.asyncQueue.enqueueAndForget(()=>(this.lu(),Promise.resolve()))):this.deferred.reject(e)}Tu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!UO(t)}return!1}};var ND=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ht.UNAUTHENTICATED,this.clientId=vg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>N(this,null,function*(){k("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(k("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new _t;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>N(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=bl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function WI(n,e){return N(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),k("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>N(this,null,function*(){r.isEqual(i)||(yield d1(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Jk(n,e){return N(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield yT(n);k("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>zk(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>zk(e.remoteStore,i)),n._onlineComponents=e})}function yT(n){return N(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k("FirestoreClient","Using user provided OfflineComponentProvider");try{yield WI(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===x.FAILED_PRECONDITION||i.code===x.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Zn("Error using user provided cache. Falling back to memory cache: "+t),yield WI(n,new gT)}}else k("FirestoreClient","Using default OfflineComponentProvider"),yield WI(n,new bD(void 0));return n._offlineComponents})}function Em(n){return N(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(k("FirestoreClient","Using user provided OnlineComponentProvider"),yield Jk(n,n._uninitializedComponentsProvider._online)):(k("FirestoreClient","Using default OnlineComponentProvider"),yield Jk(n,new mT))),n._onlineComponents})}function A1(n){return yT(n).then(e=>e.persistence)}function _T(n){return yT(n).then(e=>e.localStore)}function M1(n){return Em(n).then(e=>e.remoteStore)}function vT(n){return Em(n).then(e=>e.syncEngine)}function u3(n){return Em(n).then(e=>e.datastore)}function vl(n){return N(this,null,function*(){let e=yield Em(n),t=e.eventManager;return t.onListen=H9.bind(null,e.syncEngine),t.onUnlisten=G9.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=q9.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=z9.bind(null,e.syncEngine),t})}function c3(n){return n.asyncQueue.enqueue(()=>N(this,null,function*(){let e=yield A1(n),t=yield M1(n);return e.setNetworkEnabled(!0),function(i){let o=H(i);return o.k_.delete(0),Rd(o)}(t)}))}function d3(n){return n.asyncQueue.enqueue(()=>N(this,null,function*(){let e=yield A1(n),t=yield M1(n);return e.setNetworkEnabled(!1),function(i){return N(this,null,function*(){let o=H(i);o.k_.add(0),yield Cl(o),o.K_.set("Offline")})}(t)}))}function h3(n,e){let t=new _t;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,o,s){return N(this,null,function*(){try{let a=yield function(c,d){let f=H(c);return f.persistence.runTransaction("read document","readonly",g=>f.localDocuments.getDocument(g,d))}(i,o);a.isFoundDocument()?s.resolve(a):a.isNoDocument()?s.resolve(null):s.reject(new P(x.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let l=bl(a,`Failed to get document '${o} from cache`);s.reject(l)}})}(yield _T(n),e,t)})),t.promise}function R1(n,e,t={}){let r=new _t;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(o,s,a,l,c){let d=new _l({next:g=>{d.eu(),s.enqueueAndForget(()=>lT(o,f));let m=g.docs.has(a);!m&&g.fromCache?c.reject(new P(x.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&l&&l.source==="server"?c.reject(new P(x.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(g)},error:g=>c.reject(g)}),f=new Ed(Il(a.path),d,{includeMetadataChanges:!0,ua:!0});return aT(o,f)}(yield vl(n),n.asyncQueue,e,t,r)})),r.promise}function f3(n,e){let t=new _t;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,o,s){return N(this,null,function*(){try{let a=yield zg(i,o,!0),l=new im(o,a.Es),c=l.ga(a.documents),d=l.applyChanges(c,!1);s.resolve(d.snapshot)}catch(a){let l=bl(a,`Failed to execute query '${o} against cache`);s.reject(l)}})}(yield _T(n),e,t)})),t.promise}function N1(n,e,t={}){let r=new _t;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(o,s,a,l,c){let d=new _l({next:g=>{d.eu(),s.enqueueAndForget(()=>lT(o,f)),g.fromCache&&l.source==="server"?c.reject(new P(x.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(g)},error:g=>c.reject(g)}),f=new Ed(a,d,{includeMetadataChanges:!0,ua:!0});return aT(o,f)}(yield vl(n),n.asyncQueue,e,t,r)})),r.promise}function p3(n,e){let t=new _l(e);return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,o){H(i).X_.add(o),o.next()}(yield vl(n),t)})),()=>{t.eu(),n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,o){H(i).X_.delete(o)}(yield vl(n),t)}))}}function g3(n,e,t,r){let i=function(s,a){let l;return l=typeof s=="string"?HO().encode(s):s,function(d,f){return new AD(d,f)}(function(d,f){if(d instanceof Uint8Array)return Zk(d,f);if(d instanceof ArrayBuffer)return Zk(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(t,Md(e));n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){l3(yield vT(n),i,r)}))}function m3(n,e){return n.asyncQueue.enqueue(()=>N(this,null,function*(){return function(r,i){let o=H(r);return o.persistence.runTransaction("Get named query","readonly",s=>o.jr.getNamedQuery(s,i))}(yield _T(n),e)}))}function x1(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Xk=new Map;function wT(n,e,t){if(!t)throw new P(x.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function ET(n,e,t,r){if(e===!0&&r===!0)throw new P(x.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function eO(n){if(!q.isDocumentKey(n))throw new P(x.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function tO(n){if(q.isDocumentKey(n))throw new P(x.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Im(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":G()}function Ae(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new P(x.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Im(n);throw new P(x.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function P1(n,e){if(e<=0)throw new P(x.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var sm=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(x.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new P(x.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ET("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=x1((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new P(x.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new P(x.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new P(x.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ps=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sm({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new P(x.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new P(x.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new KI;switch(r.type){case"firstParty":return new JI(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new P(x.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return N(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=Xk.get(t);r&&(k("ComponentProvider","Removing Datastore"),Xk.delete(t),r.terminate())}(this),Promise.resolve()}};function k1(n,e,t,r={}){var i;let o=(n=Ae(n,ps))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&Zn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=ht.MOCK_USER;else{a=Jd(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new P(x.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ht(c)}n._authCredentials=new QI(new _g(a,l))}}var Nt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},He=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Cr=class n extends Nt{constructor(e,t,r){super(e,t,Il(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new He(this.firestore,null,new q(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function IT(n,e,...t){if(n=we(n),wT("collection","path",e),n instanceof ps){let r=Se.fromString(e,...t);return tO(r),new Cr(n,null,r)}{if(!(n instanceof He||n instanceof Cr))throw new P(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Se.fromString(e,...t));return tO(r),new Cr(n.firestore,null,r)}}function O1(n,e){if(n=Ae(n,ps),wT("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(x.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Nt(n,null,function(r){return new Jn(Se.emptyPath(),r)}(e))}function Nd(n,e,...t){if(n=we(n),arguments.length===1&&(e=vg.newId()),wT("doc","path",e),n instanceof ps){let r=Se.fromString(e,...t);return eO(r),new He(n,null,new q(r))}{if(!(n instanceof He||n instanceof Cr))throw new P(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Se.fromString(e,...t));return eO(r),new He(n.firestore,n instanceof Cr?n.converter:null,new q(r))}}function CT(n,e){return n=we(n),e=we(e),(n instanceof He||n instanceof Cr)&&(e instanceof He||e instanceof Cr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function DT(n,e){return n=we(n),e=we(e),n instanceof Nt&&e instanceof Nt&&n.firestore===e.firestore&&Sd(n._query,e._query)&&n.converter===e.converter}var am=class{constructor(e=Promise.resolve()){this.Iu=[],this.du=!1,this.Eu=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new wd(this,"async_queue_retry"),this.fu=()=>{let r=yg();r&&k("AsyncQueue","Visibility state changed to "+r.visibilityState),this.r_.Jo()},this.gu=e;let t=yg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.du}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.du){this.du=!0,this.Vu=e||!1;let t=yg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.du)return new Promise(()=>{});let t=new _t;return this.yu(()=>this.du&&this.Vu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}wu(){return N(this,null,function*(){if(this.Iu.length!==0){try{yield this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!ao(e))throw e;k("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}})}yu(e){let t=this.gu.then(()=>(this.Ru=!0,e().catch(r=>{this.Au=r,this.Ru=!1;let i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw ot("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Ru=!1,r))));return this.gu=t,t}enqueueAfterDelay(e,t,r){this.pu(),this.mu.indexOf(e)>-1&&(t=0);let i=mD.createAndSchedule(this,e,t,r,o=>this.Su(o));return this.Eu.push(i),i}pu(){this.Au&&G()}verifyOperationInProgress(){}bu(){return N(this,null,function*(){let e;do e=this.gu,yield e;while(e!==this.gu)})}Du(e){for(let t of this.Eu)if(t.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.Eu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Eu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){let t=this.Eu.indexOf(e);this.Eu.splice(t,1)}};function xD(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var PD=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new _t,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var F1=-1,Xe=class extends ps{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new am,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return N(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new am(e),this._firestoreClient=void 0,yield e}})}};function xt(n){if(n._terminated)throw new P(x.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||V1(n),n._firestoreClient}function V1(n){var e,t,r;let i=n._freezeSettings(),o=function(a,l,c,d){return new sC(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,x1(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new ND(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){let l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}}(n._componentsProvider))}function L1(n,e){Zn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return B1(n,mT.provider,{build:r=>new om(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function j1(n){return N(this,null,function*(){Zn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();B1(n,mT.provider,{build:t=>new SD(t,e.cacheSizeBytes)})})}function B1(n,e,t){if((n=Ae(n,Xe))._firestoreClient||n._terminated)throw new P(x.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new P(x.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},V1(n)}function U1(n){if(n._initialized&&!n._terminated)throw new P(x.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new _t;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>N(this,null,function*(){try{yield function(r){return N(this,null,function*(){if(!Zi.p())return Promise.resolve();let i=r+"main";yield Zi.delete(i)})}(rT(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function $1(n){return function(t){let r=new _t;return t.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return Z9(yield vT(t),r)})),r.promise}(xt(n=Ae(n,Xe)))}function H1(n){return c3(xt(n=Ae(n,Xe)))}function q1(n){return d3(xt(n=Ae(n,Xe)))}function G1(n,e){let t=xt(n=Ae(n,Xe)),r=new PD;return g3(t,n._databaseId,e,r),r}function z1(n,e){return m3(xt(n=Ae(n,Xe)),e).then(t=>t?new Nt(n,null,t.query):null)}var br=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(lt.fromBase64String(e))}catch(t){throw new P(x.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(lt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var tr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new P(x.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new st(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ri=class{constructor(e){this._methodName=e}};var gs=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new P(x.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new P(x.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return le(this._lat,e._lat)||le(this._long,e._long)}};var Id=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var y3=/^__.*__$/,kD=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new er(e,this.data,this.fieldMask,t,this.fieldTransforms):new ro(e,this.data,t,this.fieldTransforms)}},lm=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new er(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function W1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw G()}}var um=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Fu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.xu({path:r,Nu:!1});return i.Bu(e),i}Lu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.xu({path:r,Nu:!1});return i.Fu(),i}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return cm(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Bu(this.path.get(e))}Bu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(W1(this.Mu)&&y3.test(e))throw this.qu('Document fields cannot begin and end with "__"')}},OD=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Md(e)}$u(e,t,r,i=!1){return new um({Mu:e,methodName:t,Ku:r,path:st.emptyPath(),Nu:!1,Qu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function _s(n){let e=n._freezeSettings(),t=Md(n._databaseId);return new OD(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Cm(n,e,t,r,i,o={}){let s=n.$u(o.merge||o.mergeFields?2:0,e,t,i);ST("Data must be an object, but it was:",s,r);let a=Y1(r,s),l,c;if(o.merge)l=new Cn(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let f of o.mergeFields){let g=BD(e,f,t);if(!s.contains(g))throw new P(x.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);J1(d,g)||d.push(g)}l=new Cn(d),c=s.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=s.fieldTransforms;return new kD(new Ut(a),l,c)}var Cd=class n extends ri{_toFieldTransform(e){if(e.Mu!==2)throw e.Mu===1?e.qu(`${this._methodName}() can only appear at the top level of your update data`):e.qu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function K1(n,e,t){return new um({Mu:3,Ku:e.settings.Ku,methodName:n._methodName,Nu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var FD=class n extends ri{_toFieldTransform(e){return new ds(e.path,new to)}isEqual(e){return e instanceof n}},VD=class n extends ri{constructor(e,t){super(e),this.Uu=t}_toFieldTransform(e){let t=K1(this,e,!0),r=this.Uu.map(o=>vs(o,t)),i=new ti(r);return new ds(e.path,i)}isEqual(e){return e instanceof n&&ay(this.Uu,e.Uu)}},LD=class n extends ri{constructor(e,t){super(e),this.Uu=t}_toFieldTransform(e){let t=K1(this,e,!0),r=this.Uu.map(o=>vs(o,t)),i=new ni(r);return new ds(e.path,i)}isEqual(e){return e instanceof n&&ay(this.Uu,e.Uu)}},jD=class n extends ri{constructor(e,t){super(e),this.Wu=t}_toFieldTransform(e){let t=new no(e.serializer,kO(e.serializer,this.Wu));return new ds(e.path,t)}isEqual(e){return e instanceof n&&this.Wu===e.Wu}};function TT(n,e,t,r){let i=n.$u(1,e,t);ST("Data must be an object, but it was:",i,r);let o=[],s=Ut.empty();lo(r,(l,c)=>{let d=AT(e,l,t);c=we(c);let f=i.Lu(d);if(c instanceof Cd)o.push(d);else{let g=vs(c,f);g!=null&&(o.push(d),s.set(d,g))}});let a=new Cn(o);return new lm(s,a,i.fieldTransforms)}function bT(n,e,t,r,i,o){let s=n.$u(1,e,t),a=[BD(e,r,t)],l=[i];if(o.length%2!=0)throw new P(x.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)a.push(BD(e,o[g])),l.push(o[g+1]);let c=[],d=Ut.empty();for(let g=a.length-1;g>=0;--g)if(!J1(c,a[g])){let m=a[g],v=l[g];v=we(v);let T=s.Lu(m);if(v instanceof Cd)c.push(m);else{let S=vs(v,T);S!=null&&(c.push(m),d.set(m,S))}}let f=new Cn(c);return new lm(d,f,s.fieldTransforms)}function Q1(n,e,t,r=!1){return vs(t,n.$u(r?4:3,e))}function vs(n,e){if(Z1(n=we(n)))return ST("Unsupported field value:",e,n),Y1(n,e);if(n instanceof ri)return function(r,i){if(!W1(i.Mu))throw i.qu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.qu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let l=vs(a,i.ku(s));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=we(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return kO(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Je.fromDate(r);return{timestampValue:cl(i.serializer,o)}}if(r instanceof Je){let o=new Je(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:cl(i.serializer,o)}}if(r instanceof gs)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof br)return{bytesValue:qO(i.serializer,r._byteString)};if(r instanceof He){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.qu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:eT(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Id)return function(s,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(l=>{if(typeof l!="number")throw a.qu("VectorValues must only contain numeric values.");return XD(a.serializer,l)})}}}}}}(r,i);throw i.qu(`Unsupported field value: ${Im(r)}`)}(n,e)}function Y1(n,e){let t={};return mO(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(n,(r,i)=>{let o=vs(i,e.Ou(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function Z1(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Je||n instanceof gs||n instanceof br||n instanceof He||n instanceof ri||n instanceof Id)}function ST(n,e,t){if(!Z1(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Im(t);throw r==="an object"?e.qu(n+" a custom object"):e.qu(n+" "+r)}}function BD(n,e,t){if((e=we(e))instanceof tr)return e._internalPath;if(typeof e=="string")return AT(n,e);throw cm("Field path arguments must be of type string or ",n,!1,void 0,t)}var _3=new RegExp("[~\\*/\\[\\]]");function AT(n,e,t){if(e.search(_3)>=0)throw cm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new tr(...e.split("."))._internalPath}catch{throw cm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function cm(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${r}`),s&&(l+=` in document ${i}`),l+=")"),new P(x.INVALID_ARGUMENT,a+n+l)}function J1(n,e){return n.some(t=>t.isEqual(e))}var ms=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new He(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new UD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Dm("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},UD=class extends ms{data(){return super.data()}};function Dm(n,e){return typeof e=="string"?AT(n,e):e instanceof tr?e._internalPath:e._delegate._internalPath}function X1(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new P(x.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Dd=class{},ys=class extends Dd{};function si(n,e,...t){let r=[];e instanceof Dd&&r.push(e),r=r.concat(t),function(o){let s=o.filter(l=>l instanceof $D).length,a=o.filter(l=>l instanceof dm).length;if(s>1||s>0&&a>0)throw new P(x.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var dm=class n extends ys{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return uF(e._query,t),new Nt(e.firestore,e.converter,vC(e._query,t))}_parse(e){let t=_s(e.firestore);return function(o,s,a,l,c,d,f){let g;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new P(x.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){rO(f,d);let m=[];for(let v of f)m.push(nO(l,o,v));g={arrayValue:{values:m}}}else g=nO(l,o,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||rO(f,d),g=Q1(a,s,f,d==="in"||d==="not-in");return Ee.create(c,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function eF(n,e,t){let r=e,i=Dm("where",n);return dm._create(i,r,t)}var $D=class n extends Dd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Fe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let l of a)uF(s,l),s=vC(s,l)}(e._query,t),new Nt(e.firestore,e.converter,vC(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var HD=class n extends ys{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new P(x.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new P(x.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new us(o,s)}(e._query,this._field,this._direction);return new Nt(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new Jn(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function tF(n,e="asc"){let t=e,r=Dm("orderBy",n);return HD._create(r,t)}var hm=class n extends ys{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Nt(e.firestore,e.converter,Mg(e._query,this._limit,this._limitType))}};function nF(n){return P1("limit",n),hm._create("limit",n,"F")}function rF(n){return P1("limitToLast",n),hm._create("limitToLast",n,"L")}var fm=class n extends ys{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=lF(e,this.type,this._docOrFields,this._inclusive);return new Nt(e.firestore,e.converter,function(i,o){return new Jn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}};function iF(...n){return fm._create("startAt",n,!0)}function oF(...n){return fm._create("startAfter",n,!1)}var pm=class n extends ys{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=lF(e,this.type,this._docOrFields,this._inclusive);return new Nt(e.firestore,e.converter,function(i,o){return new Jn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}};function sF(...n){return pm._create("endBefore",n,!1)}function aF(...n){return pm._create("endAt",n,!0)}function lF(n,e,t,r){if(t[0]=we(t[0]),t[0]instanceof ms)return function(o,s,a,l,c){if(!l)throw new P(x.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let f of nl(o))if(f.field.isKeyField())d.push(ls(s,l.key));else{let g=l.data.field(f.field);if(mm(g))throw new P(x.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let m=f.field.canonicalString();throw new P(x.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}d.push(g)}return new Tr(d,c)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=_s(n.firestore);return function(s,a,l,c,d,f){let g=s.explicitOrderBy;if(d.length>g.length)throw new P(x.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let m=[];for(let v=0;v<d.length;v++){let T=d[v];if(g[v].field.isKeyField()){if(typeof T!="string")throw new P(x.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof T}`);if(!ZD(s)&&T.indexOf("/")!==-1)throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${T}' contains a slash.`);let S=s.path.child(Se.fromString(T));if(!q.isDocumentKey(S))throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${S}' is not because it contains an odd number of segments.`);let O=new q(S);m.push(ls(a,O))}else{let S=Q1(l,c,T);m.push(S)}}return new Tr(m,f)}(n._query,n.firestore._databaseId,i,e,t,r)}}function nO(n,e,t){if(typeof(t=we(t))=="string"){if(t==="")throw new P(x.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ZD(e)&&t.indexOf("/")!==-1)throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Se.fromString(t));if(!q.isDocumentKey(r))throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ls(n,new q(r))}if(t instanceof He)return ls(n,t._key);throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Im(t)}.`)}function rO(n,e){if(!Array.isArray(n)||n.length===0)throw new P(x.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function uF(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new P(x.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(x.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var wl=class{convertValue(e,t="none"){switch(Xi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ke(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ei(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw G()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return lo(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>Ke(s.doubleValue));return new Id(o)}convertGeoPoint(e){return new gs(Ke(e.latitude),Ke(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=ym(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(sd(e));default:return null}}convertTimestamp(e){let t=Xr(e);return new Je(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Se.fromString(e);K(t1(r));let i=new Ji(r.get(1),r.get(3)),o=new q(r.popFirst(5));return i.isEqual(t)||ot(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function Tm(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var qD=class extends wl{constructor(e){super(),this.firestore=e}convertBytes(e){return new br(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new He(this.firestore,null,t)}};var Jr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ln=class extends ms{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Qi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Dm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Qi=class extends Ln{data(e={}){return super.data(e)}},nr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Jr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Qi(this._firestore,this._userDataWriter,r.key,r,new Jr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new P(x.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let l=new Qi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Jr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let l=new Qi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Jr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,d=-1;return a.type!==0&&(c=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:v3(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function v3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return G()}}function MT(n,e){return n instanceof Ln&&e instanceof Ln?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof nr&&e instanceof nr&&n._firestore===e._firestore&&DT(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function cF(n){n=Ae(n,He);let e=Ae(n.firestore,Xe);return R1(xt(e),n._key).then(t=>PT(e,n,t))}var ii=class extends wl{constructor(e){super(),this.firestore=e}convertBytes(e){return new br(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new He(this.firestore,null,t)}};function dF(n){n=Ae(n,He);let e=Ae(n.firestore,Xe),t=xt(e),r=new ii(e);return h3(t,n._key).then(i=>new Ln(e,r,n._key,i,new Jr(i!==null&&i.hasLocalMutations,!0),n.converter))}function hF(n){n=Ae(n,He);let e=Ae(n.firestore,Xe);return R1(xt(e),n._key,{source:"server"}).then(t=>PT(e,n,t))}function fF(n){n=Ae(n,Nt);let e=Ae(n.firestore,Xe),t=xt(e),r=new ii(e);return X1(n._query),N1(t,n._query).then(i=>new nr(e,r,n,i))}function pF(n){n=Ae(n,Nt);let e=Ae(n.firestore,Xe),t=xt(e),r=new ii(e);return f3(t,n._query).then(i=>new nr(e,r,n,i))}function gF(n){n=Ae(n,Nt);let e=Ae(n.firestore,Xe),t=xt(e),r=new ii(e);return N1(t,n._query,{source:"server"}).then(i=>new nr(e,r,n,i))}function RT(n,e,t){n=Ae(n,He);let r=Ae(n.firestore,Xe),i=Tm(n.converter,e,t);return Sl(r,[Cm(_s(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,rt.none())])}function NT(n,e,t,...r){n=Ae(n,He);let i=Ae(n.firestore,Xe),o=_s(i),s;return s=typeof(e=we(e))=="string"||e instanceof tr?bT(o,"updateDoc",n._key,e,t,r):TT(o,"updateDoc",n._key,e),Sl(i,[s.toMutation(n._key,rt.exists(!0))])}function mF(n){return Sl(Ae(n.firestore,Xe),[new io(n._key,rt.none())])}function yF(n,e){let t=Ae(n.firestore,Xe),r=Nd(n),i=Tm(n.converter,e);return Sl(t,[Cm(_s(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,rt.exists(!1))]).then(()=>r)}function xT(n,...e){var t,r,i;n=we(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||xD(e[s])||(o=e[s],s++);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(xD(e[s])){let f=e[s];e[s]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[s+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[s+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let l,c,d;if(n instanceof He)c=Ae(n.firestore,Xe),d=Il(n._key.path),l={next:f=>{e[s]&&e[s](PT(c,n,f))},error:e[s+1],complete:e[s+2]};else{let f=Ae(n,Nt);c=Ae(f.firestore,Xe),d=f._query;let g=new ii(c);l={next:m=>{e[s]&&e[s](new nr(c,g,f,m))},error:e[s+1],complete:e[s+2]},X1(n._query)}return function(g,m,v,T){let S=new _l(T),O=new Ed(m,S,v);return g.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return aT(yield vl(g),O)})),()=>{S.eu(),g.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return lT(yield vl(g),O)}))}}(xt(c),d,a,l)}function _F(n,e){return p3(xt(n=Ae(n,Xe)),xD(e)?e:{next:e})}function Sl(n,e){return function(r,i){let o=new _t;return r.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return W9(yield vT(r),i,o)})),o.promise}(xt(n),e)}function PT(n,e,t){let r=t.docs.get(e._key),i=new ii(n);return new Ln(n,i,e._key,r,new Jr(t.hasPendingWrites,t.fromCache),e.converter)}var w3={maxAttempts:5};var gm=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=_s(e)}set(e,t,r){this._verifyNotCommitted();let i=Wi(e,this._firestore),o=Tm(i.converter,t,r),s=Cm(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,rt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let o=Wi(e,this._firestore),s;return s=typeof(t=we(t))=="string"||t instanceof tr?bT(this._dataReader,"WriteBatch.update",o._key,t,r,i):TT(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,rt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Wi(e,this._firestore);return this._mutations=this._mutations.concat(new io(t._key,rt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new P(x.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Wi(n,e){if((n=we(n)).firestore!==e)throw new P(x.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var GD=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=_s(t)}get(t){let r=Wi(t,this._firestore),i=new qD(this._firestore);return this._transaction.lookup([r._key]).then(o=>{if(!o||o.length!==1)return G();let s=o[0];if(s.isFoundDocument())return new ms(this._firestore,i,s.key,s,r.converter);if(s.isNoDocument())return new ms(this._firestore,i,r._key,null,r.converter);throw G()})}set(t,r,i){let o=Wi(t,this._firestore),s=Tm(o.converter,r,i),a=Cm(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,i);return this._transaction.set(o._key,a),this}update(t,r,i,...o){let s=Wi(t,this._firestore),a;return a=typeof(r=we(r))=="string"||r instanceof tr?bT(this._dataReader,"Transaction.update",s._key,r,i,o):TT(this._dataReader,"Transaction.update",s._key,r),this._transaction.update(s._key,a),this}delete(t){let r=Wi(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Wi(e,this._firestore),r=new ii(this._firestore);return super.get(e).then(i=>new Ln(this._firestore,r,t._key,i._document,new Jr(!1,!1),t.converter))}};function vF(n,e,t){n=Ae(n,Xe);let r=Object.assign(Object.assign({},w3),t);return function(o){if(o.maxAttempts<1)throw new P(x.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,s,a){let l=new _t;return o.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){let c=yield u3(o);new RD(o.asyncQueue,c,a,s,l).cu()})),l.promise}(xt(n),i=>e(new GD(n,i)),r)}function wF(){return new Cd("deleteField")}function EF(){return new FD("serverTimestamp")}function IF(...n){return new VD("arrayUnion",n)}function CF(...n){return new LD("arrayRemove",n)}function DF(n){return new jD("increment",n)}(function(e,t=!0){(function(i){El=i})(rh),go(new un("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new Xe(new YI(r.getProvider("auth-internal")),new eC(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new P(x.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ji(c.options.projectId,d)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),Bn(nk,"4.7.6",e),Bn(nk,"4.7.6","esm2017")})();var E3="@firebase/firestore-compat",I3="0.3.41";function jT(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function TF(){if(typeof Uint8Array>"u")throw new P("unimplemented","Uint8Arrays are not available in this environment.")}function bF(){if(!yO())throw new P("unimplemented","Blobs are unavailable in Firestore in this environment.")}var bm=class n{constructor(e){this._delegate=e}static fromBase64String(e){return bF(),new n(br.fromBase64String(e))}static fromUint8Array(e){return TF(),new n(br.fromUint8Array(e))}toBase64(){return bF(),this._delegate.toBase64()}toUint8Array(){return TF(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function kT(n){return C3(n,["next","error","complete"])}function C3(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var OT=class{enableIndexedDbPersistence(e,t){return L1(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return j1(e._delegate)}clearIndexedDbPersistence(e){return U1(e._delegate)}},Sm=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ji||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Zn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){k1(this._delegate,e,t,r)}enableNetwork(){return H1(this._delegate)}disableNetwork(){return q1(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,ET("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return $1(this._delegate)}onSnapshotsInSync(e){return _F(this._delegate,e)}get app(){if(!this._appCompat)throw new P("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Rl(this,IT(this._delegate,e))}catch(t){throw Xt(t,"collection()","Firestore.collection()")}}doc(e){try{return new Sr(this,Nd(this._delegate,e))}catch(t){throw Xt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Cs(this,O1(this._delegate,e))}catch(t){throw Xt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return vF(this._delegate,t=>e(new Am(this,t)))}batch(){return xt(this._delegate),new Mm(new gm(this._delegate,e=>Sl(this._delegate,e)))}loadBundle(e){return G1(this._delegate,e)}namedQuery(e){return z1(this._delegate,e).then(t=>t?new Cs(this,t):null)}},Al=class extends wl{constructor(e){super(),this.firestore=e}convertBytes(e){return new bm(new br(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Sr.forKey(t,this.firestore,null)}};function D3(n){iO(n)}var Am=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Al(e)}get(e){let t=ws(e);return this._delegate.get(t).then(r=>new Es(this._firestore,new Ln(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=ws(e);return r?(jT("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=ws(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=ws(e);return this._delegate.delete(t),this}},Mm=class{constructor(e){this._delegate=e}set(e,t,r){let i=ws(e);return r?(jT("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=ws(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=ws(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Ml=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Qi(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Is(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let o=i.get(t);return o||(o=new n(e,new Al(e),t),i.set(t,o)),o}};Ml.INSTANCES=new WeakMap;var Sr=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Al(e)}static forPath(e,t,r){if(e.length%2!==0)throw new P("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new He(t._delegate,r,new q(e)))}static forKey(e,t,r){return new n(t,new He(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Rl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Rl(this.firestore,IT(this._delegate,e))}catch(t){throw Xt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=we(e),e instanceof He?CT(this._delegate,e):!1}set(e,t){t=jT("DocumentReference.set",t);try{return t?RT(this._delegate,e,t):RT(this._delegate,e)}catch(r){throw Xt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?NT(this._delegate,e):NT(this._delegate,e,t,...r)}catch(i){throw Xt(i,"updateDoc()","DocumentReference.update()")}}delete(){return mF(this._delegate)}onSnapshot(...e){let t=SF(e),r=AF(e,i=>new Es(this.firestore,new Ln(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return xT(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=dF(this._delegate):e?.source==="server"?t=hF(this._delegate):t=cF(this._delegate),t.then(r=>new Es(this.firestore,new Ln(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ml.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Xt(n,e,t){return n.message=n.message.replace(e,t),n}function SF(n){for(let e of n)if(typeof e=="object"&&!kT(e))return e;return{}}function AF(n,e){var t,r;let i;return kT(n[0])?i=n[0]:kT(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:o=>{i.next&&i.next(e(o))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Es=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Sr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return MT(this._delegate,e._delegate)}},Is=class extends Es{data(e){let t=this._delegate.data(e);return this._delegate._converter||oO(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Cs=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Al(e)}where(e,t,r){try{return new n(this.firestore,si(this._delegate,eF(e,t,r)))}catch(i){throw Xt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,si(this._delegate,tF(e,t)))}catch(r){throw Xt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,si(this._delegate,nF(e)))}catch(t){throw Xt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,si(this._delegate,rF(e)))}catch(t){throw Xt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,si(this._delegate,iF(...e)))}catch(t){throw Xt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,si(this._delegate,oF(...e)))}catch(t){throw Xt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,si(this._delegate,sF(...e)))}catch(t){throw Xt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,si(this._delegate,aF(...e)))}catch(t){throw Xt(t,"endAt()","Query.endAt()")}}isEqual(e){return DT(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=pF(this._delegate):e?.source==="server"?t=gF(this._delegate):t=fF(this._delegate),t.then(r=>new xd(this.firestore,new nr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=SF(e),r=AF(e,i=>new xd(this.firestore,new nr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return xT(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ml.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},FT=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Is(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},xd=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Cs(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Is(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new FT(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Is(this._firestore,r))})}isEqual(e){return MT(this._delegate,e._delegate)}},Rl=class n extends Cs{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Sr(this.firestore,e):null}doc(e){try{return e===void 0?new Sr(this.firestore,Nd(this._delegate)):new Sr(this.firestore,Nd(this._delegate,e))}catch(t){throw Xt(t,"doc()","CollectionReference.doc()")}}add(e){return yF(this._delegate,e).then(t=>new Sr(this.firestore,t))}isEqual(e){return CT(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ml.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ws(n){return Ae(n,He)}var VT=class n{constructor(...e){this._delegate=new tr(...e)}static documentId(){return new n(st.keyField().canonicalString())}isEqual(e){return e=we(e),e instanceof tr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var LT=class n{static serverTimestamp(){let e=EF();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=wF();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=IF(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=CF(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=DF(e);return t._methodName="FieldValue.increment",new n(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}};var T3={Firestore:Sm,GeoPoint:gs,Timestamp:Je,Blob:bm,Transaction:Am,WriteBatch:Mm,DocumentReference:Sr,DocumentSnapshot:Es,Query:Cs,QueryDocumentSnapshot:Is,QuerySnapshot:xd,CollectionReference:Rl,FieldPath:VT,FieldValue:LT,setLogLevel:D3,CACHE_SIZE_UNLIMITED:F1};function b3(n,e){n.INTERNAL.registerComponent(new un("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},T3)))}function S3(n){b3(n,(e,t)=>new Sm(e,t,new OT)),n.registerVersion(E3,I3)}S3(Dt);function A3(n,e=wo){return new pe(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function MF(n,e){return A3(n,e)}function M3(n,e){return MF(n,e).pipe(Eo(void 0),au(),Z(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function $T(n,e){return MF(n,e).pipe(Z(t=>({payload:t,type:"query"})))}var Rm=class{ref;afs;injector=V(it);constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:o}=xF(r,t);return new xm(i,o,this.afs)}snapshotChanges(){return M3(this.ref,this.afs.schedulers.outsideAngular).pipe(nt(this.injector))}valueChanges(e={}){return this.snapshotChanges().pipe(Z(({payload:t})=>e.idField?fe($({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Pe(this.ref.get(e)).pipe(nt(this.injector))}};function Nm(n,e){return $T(n,e).pipe(Eo(void 0),au(),Z(t=>{let[r,i]=t,o=i.payload.docChanges(),s=o.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,l)=>{let c=o.find(f=>f.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(f=>f.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||s.push({type:"modified",payload:{oldIndex:l,newIndex:l,type:"modified",doc:a}})}),s}))}function RF(n,e,t){return Nm(n,t).pipe(sr((r,i)=>R3(r,i.map(o=>o.payload),e),[]),ou(),Z(r=>r.map(i=>({type:i.type,payload:i}))))}function R3(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=N3(n,r))}),n}function BT(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function N3(n,e){switch(e.type){case"added":if(!n[e.newIndex]?.doc.ref.isEqual(e.doc.ref))return BT(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return BT(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]?.doc.ref.isEqual(e.doc.ref))return BT(n,e.oldIndex,1);break}return n}function NF(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var xm=class{ref;query;afs;injector=V(it);constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=Nm(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Z(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Eo(void 0),au(),Vt(([r,i])=>i.length>0||!r),Z(([,r])=>r),nt(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(sr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=NF(e);return RF(this.query,t,this.afs.schedulers.outsideAngular).pipe(nt(this.injector))}valueChanges(e={}){return $T(this.query,this.afs.schedulers.outsideAngular).pipe(Z(t=>t.payload.docs.map(r=>e.idField?fe($({},r.data()),{[e.idField]:r.id}):r.data())),nt(this.injector))}get(e){return Pe(this.query.get(e)).pipe(nt(this.injector))}add(e){return this.ref.add(e)}doc(e){return new Rm(this.ref.doc(e),this.afs)}},UT=class{query;afs;injector=V(it);constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Nm(this.query,this.afs.schedulers.outsideAngular).pipe(nt(this.injector)):Nm(this.query,this.afs.schedulers.outsideAngular).pipe(Z(t=>t.filter(r=>e.indexOf(r.type)>-1)),Vt(t=>t.length>0),nt(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(sr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=NF(e);return RF(this.query,t,this.afs.schedulers.outsideAngular).pipe(nt(this.injector))}valueChanges(e={}){return $T(this.query,this.afs.schedulers.outsideAngular).pipe(Z(r=>r.payload.docs.map(i=>e.idField?$({[e.idField]:i.id},i.data()):i.data())),nt(this.injector))}get(e){return Pe(this.query.get(e)).pipe(nt(this.injector))}},x3=new z("angularfire2.enableFirestorePersistence"),P3=new z("angularfire2.firestore.persistenceSettings"),k3=new z("angularfire2.firestore.settings"),O3=new z("angularfire2.firestore.use-emulator");function xF(n,e=t=>t){return{query:e(n),ref:n}}var PF=(()=>{class n{schedulers;firestore;persistenceEnabled$;ngZone=V(De);constructor(t,r,i,o,s,a,l,c,d,f,g,m,v,T,S,O,B){this.schedulers=l;let F=qo(t,a,r),W=d;f&&cc(F,a,g,v,T,S,m,O),[this.firestore,this.persistenceEnabled$]=ba(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let oe=a.runOutsideAngular(()=>F.firestore());if(o&&oe.settings(o),W&&oe.useEmulator(...W),i&&!Lo(s)){let X=()=>{try{return Pe(oe.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),ne(!1)}};return[oe,a.runOutsideAngular(X)]}else return[oe,ne(!1)]},[o,W,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:o,query:s}=xF(i,r),a=this.ngZone.run(()=>o);return new xm(a,s,this)}collectionGroup(t,r){let i=r||(s=>s),o=this.firestore.collectionGroup(t);return new UT(i(o),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.ngZone.run(()=>r);return new Rm(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(j(Pi),j(ki,8),j(x3,8),j(k3,8),j(on),j(De),j(Ho),j(P3,8),j(O3,8),j(dc,8),j(ic,8),j(oc,8),j(sc,8),j(ac,8),j(lc,8),j(uc,8),j(xi,8))};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var kF={apiKey:"AIzaSyAgzLE6J3CGJM-PgSRFhp5hFsvnY8mymug",authDomain:"iot-multiparameter.firebaseapp.com",databaseURL:"https://iot-multiparameter-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"iot-multiparameter",storageBucket:"iot-multiparameter.appspot.com",messagingSenderId:"773940000383",appId:"1:773940000383:web:0be13598bc82c0d522f14a",measurementId:"G-DSZ9883T5H"};var OF={providers:[jR(XP),q_([bN.initializeApp(kF),SN,ig,PF])]};var FF=(()=>{class n{constructor(){this.title="electrical-load-Monitoring"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=ca({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(r,i){r&1&&ko(0,"router-outlet")},dependencies:[Mu,Ew],encapsulation:2})}}return n})();tR(FF,OF).catch(n=>console.error(n));
